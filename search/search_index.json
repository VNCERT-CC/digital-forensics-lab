{"config":{"lang":["vi"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Gi\u1edbi thi\u1ec7u v\u1ec1 DFLab","text":"<p>N\u1ec1n t\u1ea3ng h\u1ed7 tr\u1ee3 \u0111i\u1ec1u tra s\u1ed1 - Digital Forensics Lab (DFLab) n\u01a1i t\u1eadp h\u1ee3p tri th\u1ee9c v\u00e0 h\u1ec7 th\u1ed1ng, c\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch, \u0111i\u1ec1u tra t\u1ea5n c\u00f4ng m\u1ea1ng.</p> <p>DFLab \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi Trung t\u00e2m VNCERT/CC, l\u00e0 m\u1ed9t th\u00e0nh ph\u1ea7n n\u1eb1m trong h\u1ec7 sinh th\u00e1i c\u1ee7a IRLab - N\u1ec1n t\u1ea3ng \u0111i\u1ec1u ph\u1ed1i, x\u1eed l\u00fd s\u1ef1 c\u1ed1 an to\u00e0n th\u00f4ng tin m\u1ea1ng qu\u1ed1c gia. Th\u00f4ng qua DFLab \u0111\u1ed9i ng\u0169 chuy\u00ean tr\u00e1ch an to\u00e0n th\u00f4ng tin t\u1ea1i c\u00e1c c\u01a1 quan, t\u1ed5 ch\u1ee9c, doanh nghi\u1ec7p v\u00e0 c\u1ed9ng \u0111\u1ed3ng an to\u00e0n th\u00f4ng tin \u0111\u01b0\u1ee3c hu\u1ea5n luy\u1ec7n c\u00e1c k\u1ef9 n\u0103ng, \u0111i\u1ec1u tra v\u1edbi c\u00e1c t\u00ecnh hu\u1ed1ng t\u1ea5n c\u00f4ng m\u1ea1ng trong th\u1ef1c t\u1ebf \u0111\u01b0\u1ee3c t\u00e1i hi\u1ec7n l\u1ea1i m\u1ed9t c\u00e1ch khoa h\u1ecdc. \u0110\u1ed3ng th\u1eddi n\u1ec1n t\u1ea3ng c\u0169ng cung c\u1ea5p h\u1ec7 th\u1ed1ng nghi\u1ec7p v\u1ee5 v\u00e0 chuy\u00ean bi\u1ec7t \u0111\u1ec3 h\u1ed7 tr\u1ee3 c\u00e1c t\u1ed5 ch\u1ee9c ph\u00e2n t\u00edch, \u0111i\u1ec1u tra v\u00e0 x\u1eed l\u00fd ph\u1ea3n h\u1ed3i nhanh s\u1ef1 c\u1ed1 b\u1ea3o m\u1eadt tr\u00ean di\u1ec7n r\u1ed9ng m\u00e0 kh\u00f4ng ph\u1ee5 thu\u1ed9c kho\u1ea3ng c\u00e1ch \u0111\u1ecba l\u00fd.</p>"},{"location":"#cac-thanh-phan-cua-dflab","title":"C\u00e1c th\u00e0nh ph\u1ea7n c\u1ee7a DFLab","text":"<ul> <li>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1</li> <li>B\u1ed9 c\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch</li> <li>H\u1ec7 th\u1ed1ng h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch</li> <li>T\u00ecnh hu\u1ed1ng gi\u1ea3 \u0111\u1ecbnh</li> <li>T\u00e0i nguy\u00ean tham kh\u1ea3o</li> </ul>"},{"location":"resources/","title":"T\u00e0i nguy\u00ean tham kh\u1ea3o","text":"<ol> <li> <p>No Logs? No Problem! Incident Response without Windows Event Logs</p> </li> <li> <p>Running Once, Running Twice, Pwned! Windows Registry Run Keys</p> </li> <li> <p>The Honeynet Project</p> </li> <li> <p>Purp1eW0lf/Blue-Team-Notes</p> </li> <li> <p>Meerkat artifact gathering</p> </li> <li> <p>Digital Forensics Artifacts Repository</p> </li> </ol>"},{"location":"platform/","title":"H\u1ec7 th\u1ed1ng h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch","text":"<p>H\u1ec7 th\u1ed1ng h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch, \u0111i\u1ec1u tra s\u1ef1 c\u1ed1 bao g\u1ed3m m\u1ed9t h\u1ec7 \u0111i\u1ec1u h\u00e0nh (\u0111\u01b0\u1ee3c \u1ea3o h\u00f3a v\u00e0 cung c\u1ea5p qua t\u1ec7p ova, zip) \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng s\u1eb5n c\u00e1c c\u00f4ng c\u1ee5 \u0111i\u1ec1u tra, \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 (built-in).</p> <p>B\u00ean c\u1ea1nh b\u1ed9 c\u00f4ng c\u1ee5, h\u1ec7 th\u1ed1ng cung c\u1ea5p s\u1eb5n Quy tr\u00ecnh, s\u1ed5 tay, shell interface v\u00e0 h\u01b0\u1edbng d\u1eabn c\u1ea7n thi\u1ebft cho chuy\u00ean gia th\u1ef1c hi\u1ec7n ph\u00e2n t\u00edch s\u1ef1 c\u1ed1 trong th\u1ef1c t\u1ebf.</p> <p>Ngo\u00e0i ra, ch\u00fang t\u00f4i cung c\u1ea5p s\u1eb5n c\u00e1c c\u00f4ng c\u1ee5 online s\u1eed d\u1ee5ng \u0111\u1ec3 ph\u00e2n t\u00edch v\u00e0 tra c\u1ee9u nh\u1eadt k\u00fd, ph\u00e2n t\u00edch h\u00e0nh vi m\u00e3 \u0111\u1ed9c, ph\u00e2n t\u00edch nh\u1eadt k\u00fd theo th\u1eddi gian,... \u0111\u1ec3 tr\u1ee3 gi\u00fap v\u00e0 r\u00fat ng\u1eafn th\u1eddi gian \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1</p> <p>M\u1ed9t s\u1ed1 c\u00f4ng c\u1ee5 online \u0111\u01b0\u1ee3c cung c\u1ea5p nh\u01b0:</p> <ul> <li>C\u00f4ng c\u1ee5 ph\u00e2n t\u00edch v\u00e0 tra c\u1ee9u nh\u1eadt k\u00fd</li> <li>C\u00f4ng c\u1ee5 ph\u00e2n t\u00edch h\u00e0nh vi m\u00e3 \u0111\u1ed9c</li> <li>C\u00f4ng c\u1ee5 ph\u00e2n t\u00edch nh\u1eadt k\u00fd theo th\u1eddi gian</li> <li>C\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 t\u1eadp trung</li> </ul> <p>Vui l\u00f2ng li\u00ean h\u1ec7 \u0111\u1ec3 truy c\u1eadp v\u00e0 s\u1eed d\u1ee5ng c\u00e1c c\u00f4ng c\u1ee5 n\u00e0y.</p>"},{"location":"playbooks/","title":"S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1","text":""},{"location":"playbooks/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 h\u01b0\u1edbng d\u1eabn, \u0111\u01b0a ra c\u00e1c b\u01b0\u1edbc gi\u1ea3i quy\u1ebft c\u00e1c s\u1ef1 c\u1ed1 trong c\u00f4ng vi\u1ec7c ho\u1eb7c t\u00ecnh hu\u1ed1ng kh\u1ea9n c\u1ea5p. S\u1ed5 tay bao g\u1ed3m c\u00e1c th\u00f4ng tin, c\u00e1ch th\u1ef1c hi\u1ec7n c\u00e1c b\u01b0\u1edbc, c\u00e1c quy tr\u00ecnh x\u1eed l\u00fd s\u1ef1 c\u1ed1, c\u00e1c th\u00f4ng tin li\u00ean quan \u0111\u1ebfn c\u00e1c ngu\u1ed3n l\u1ef1c v\u00e0 thi\u1ebft b\u1ecb \u1ee9ng c\u1ee9u.</p> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 gi\u00fap chuy\u00ean gia, c\u00e1n b\u1ed9 k\u1ef9 thu\u1eadt c\u00f3 th\u1ec3 nhanh ch\u00f3ng \u0111\u01b0a ra c\u00e1c quy\u1ebft \u0111\u1ecbnh, h\u00e0nh \u0111\u1ed9ng \u0111\u00fang c\u00e1ch, gi\u1ea3m thi\u1ec3u thi\u1ec7t h\u1ea1i v\u00e0 \u0111\u1ea3m b\u1ea3o an to\u00e0n trong t\u00ecnh hu\u1ed1ng kh\u1ea9n c\u1ea5p.</p> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 m\u00f4 t\u1ea3 qu\u00e1 tr\u00ecnh c\u1ea7n thi\u1ebft \u0111\u1ec3 qu\u1ea3n l\u00fd c\u00e1c s\u1ef1 c\u1ed1 tr\u00ean kh\u00f4ng gian m\u1ea1ng, c\u00f9ng v\u1edbi c\u00e1c ph\u1ea3n h\u1ed3i v\u00e0 c\u00e1ch gi\u1ea3i quy\u1ebft \u0111\u1ec3 ng\u0103n ch\u1eb7n ho\u1eb7c h\u1ea1n ch\u1ebf thi\u1ec7t h\u1ea1i c\u00f3 th\u1ec3 g\u00e2y ra. Vi\u1ec7c \u00e1p d\u1ee5ng s\u1ed5 tay s\u1ebd gi\u00fap gi\u1ea3m ph\u1ea1m vi, t\u00e1c \u0111\u1ed9ng v\u00e0 m\u1ee9c \u0111\u1ed9 \u1ea3nh h\u01b0\u1edfng c\u1ee7a s\u1ef1 c\u1ed1 t\u1edbi h\u1ec7 th\u1ed1ng CNTT v\u00e0 t\u1ed5 ch\u1ee9c.</p>"},{"location":"playbooks/#danh-sach-cac-so-tay","title":"Danh s\u00e1ch c\u00e1c s\u1ed5 tay","text":"<ol> <li> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 gi\u1ea3 m\u1ea1o (Phishing)</p> </li> <li> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 m\u00e3 \u0111\u1ed9c (Malware)</p> </li> </ol>"},{"location":"playbooks/malware/","title":"S\u1ed5 tay malware","text":"<p>M\u00e3 \u0111\u1ed9c (malware) l\u00e0 ph\u1ea7n m\u1ec1m \u0111\u1ed9c h\u1ea1i \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 x\u00e2m nh\u1eadp v\u00e0o h\u1ec7 th\u1ed1ng c\u1ee7a ng\u01b0\u1eddi d\u00f9ng v\u00e0 th\u1ef1c hi\u1ec7n c\u00e1c t\u00e1c v\u1ee5 kh\u00f4ng \u0111\u01b0\u1ee3c s\u1ef1 cho ph\u00e9p nh\u01b0 thu th\u1eadp th\u00f4ng tin nh\u1ea1y c\u1ea3m (m\u1eadt kh\u1ea9u, kh\u00f3a b\u00ed m\u1eadt, s\u1ed1 th\u1ebb t\u00edn d\u1ee5ng), l\u1ee3i d\u1ee5ng t\u00e0i nguy\u00ean c\u1ee7a h\u1ec7 th\u1ed1ng \u0111\u1ec3 \u0111\u00e0o ti\u1ec1n \u1ea3o, m\u00e3 h\u00f3a h\u1ec7 th\u1ed1ng \u0111\u1ec3 \u0111\u00f2i ti\u1ec1n chu\u1ed9c, ph\u00e1 ho\u1ea1i h\u1ec7 th\u1ed1ng,...</p> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 malware cung c\u1ea5p c\u00e1c th\u00f4ng tin c\u01a1 b\u1ea3n v\u1ec1 malware, ph\u01b0\u01a1ng ph\u00e1p ph\u00e1t hi\u1ec7n, ph\u00f2ng ng\u1eeba c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng malware, c\u00e1ch ki\u1ec3m tra, lo\u1ea1i b\u1ecf c\u00e1c t\u1ec7p tin \u0111\u1ed9c h\u1ea1i, c\u1eadp nh\u1eadt ph\u1ea7n m\u1ec1m \u0111\u1ec3 tr\u00e1nh m\u1ea5t d\u1eef li\u1ec7u do c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng malware.</p> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 malware \u0111\u01b0a ra 6 giai \u0111o\u1ea1n \u0111\u1ec3 th\u1ef1c hi\u1ec7n: Chu\u1ea9n b\u1ecb, Nh\u1eadn di\u1ec7n, Ph\u00e2n t\u00edch, X\u1eed l\u00fd, Kh\u00f4i ph\u1ee5c, H\u1eadu s\u1ef1 c\u1ed1. T\u1eebng giai \u0111o\u1ea1n c\u00f3 c\u00e1c b\u01b0\u1edbc, x\u00e1c \u0111\u1ecbnh h\u00e0nh \u0111\u1ed9ng c\u1ee5 th\u1ec3 cho chuy\u00ean vi\u00ean th\u1ef1c hi\u1ec7n \u0111i\u1ec1u tra, \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1.</p> S\u1ed5 tay S\u1ef1 c\u1ed1 m\u00e3 \u0111\u1ed9c (Malware)"},{"location":"playbooks/phishing/","title":"S\u1ed5 tay phishing\u200b","text":"<p>Phishing l\u00e0 m\u1ed9t k\u1ef9 thu\u1eadt t\u1ea5n c\u00f4ng gi\u1ea3 m\u1ea1o m\u1ed9t trang web ho\u1eb7c m\u1ed9t email \u0111\u1ec3 l\u1eeba \u0111\u1ea3o ng\u01b0\u1eddi d\u00f9ng ti\u1ebft l\u1ed9 th\u00f4ng tin c\u00e1 nh\u00e2n nh\u01b0 t\u00ean \u0111\u0103ng nh\u1eadp, m\u1eadt kh\u1ea9u, s\u1ed1 th\u1ebb t\u00edn d\u1ee5ng ho\u1eb7c t\u1ea3i v\u1ec1 m\u1ed9t ph\u1ea7n m\u1ec1m \u0111\u1ed9c h\u1ea1i.</p> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 phishing cung c\u1ea5p c\u00e1c th\u00f4ng tin c\u01a1 b\u1ea3n v\u1ec1 phishing, c\u00e1ch ph\u00e1t hi\u1ec7n v\u00e0 \u1ee9ng ph\u00f3 v\u1edbi c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng phishing.</p> <p>S\u1ed5 tay \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1 phishing \u0111\u01b0a ra 6 giai \u0111o\u1ea1n \u0111\u1ec3 th\u1ef1c hi\u1ec7n: Chu\u1ea9n b\u1ecb, Nh\u1eadn di\u1ec7n, Ph\u00e2n t\u00edch, X\u1eed l\u00fd, Kh\u00f4i ph\u1ee5c, H\u1eadu s\u1ef1 c\u1ed1. T\u1eebng giai \u0111o\u1ea1n c\u00f3 c\u00e1c b\u01b0\u1edbc, x\u00e1c \u0111\u1ecbnh h\u00e0nh \u0111\u1ed9ng c\u1ee5 th\u1ec3 cho chuy\u00ean vi\u00ean th\u1ef1c hi\u1ec7n \u0111i\u1ec1u tra, \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1.</p> S\u1ed5 tay S\u1ef1 c\u1ed1 gi\u1ea3 m\u1ea1o (Phishing)"},{"location":"scenarios/","title":"T\u00ecnh hu\u1ed1ng gi\u1ea3 \u0111\u1ecbnh","text":""},{"location":"scenarios/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>DFLab \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng tr\u00ean m\u00f4 h\u00ecnh m\u1ea1ng m\u00f4 ph\u1ecfng m\u1ed9t doanh nghi\u1ec7p v\u1eeba v\u00e0 nh\u1ecf, \u0111\u1ea7y \u0111\u1ee7 c\u00e1c th\u00e0nh ph\u1ea7n c\u01a1 b\u1ea3n, bao g\u1ed3m: V\u00f9ng m\u1ea1ng server, V\u00f9ng m\u1ea1ng ng\u01b0\u1eddi d\u00f9ng, V\u00f9ng m\u1ea1ng t\u1ea5n c\u00f4ng,...</p> <p>C\u00e1c t\u00ecnh hu\u1ed1ng c\u1ee7a DFLab \u0111\u01b0\u1ee3c x\u00e2y d\u1ef1ng d\u1ef1a tr\u00ean vi\u1ec7c m\u00f4 ph\u1ecfng c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng m\u1ea1ng nh\u1eafm v\u00e0o nhi\u1ec1u th\u00e0nh ph\u1ea7n kh\u00e1c nhau trong h\u1ec7 th\u1ed1ng m\u1ea1ng, thu th\u1eadp c\u00e1c nh\u1eadt k\u00fd, b\u1eb1ng ch\u1ee9ng \u0111\u1ec3 ng\u01b0\u1eddi ph\u00e2n t\u00edch r\u00e0 so\u00e1t, t\u00ecm ki\u1ebfm c\u00e1c d\u1ea5u hi\u1ec7u, h\u00e0nh \u0111\u1ed9ng c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng.</p> <p>M\u1ed7i t\u00ecnh hu\u1ed1ng bao g\u1ed3m c\u00e1c m\u1ee5c sau: B\u1ed1i c\u1ea3nh, C\u00e2u h\u1ecfi, T\u1ec7p \u0111\u00ednh k\u00e8m.</p> <p>\u0110\u1ed9i ng\u0169 \u1ee9ng c\u1ee9u, \u0111i\u1ec1u tra s\u1ef1 c\u1ed1, c\u00e1c chuy\u00ean gia, h\u1ecdc vi\u00ean, sinh vi\u00ean l\u00e0 ng\u01b0\u1eddi ch\u01a1i (ho\u1eb7c \u0111\u1ed9i ch\u01a1i) truy c\u1eadp v\u00e0o t\u1eebng t\u00ecnh hu\u1ed1ng ch\u00fang t\u00f4i \u0111\u00e3 x\u00e2y d\u1ef1ng. D\u1ef1a v\u00e0o b\u1ed1i c\u1ea3nh v\u00e0 c\u00e1c t\u1ec7p \u0111\u00ednh k\u00e8m, c\u00e1c chuy\u00ean gia th\u1ef1c hi\u1ec7n ph\u00e2n t\u00edch, t\u00ecm ki\u1ebfm d\u1ea5u hi\u1ec7u, b\u1eb1ng ch\u1ee9ng c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng \u0111\u1ec3 l\u1ea1i tr\u00ean nh\u1eadt k\u00fd, qua \u0111\u00f3 tr\u1ea3 l\u1eddi \u0111\u01b0\u1ee3c c\u00e1c c\u00e2u h\u1ecfi ch\u00fang t\u00f4i \u0111\u1eb7t ra.</p> <p>Sau khi tr\u1ea3 l\u1eddi \u0111\u01b0\u1ee3c c\u00e1c c\u00e2u h\u1ecfi, ng\u01b0\u1eddi ch\u01a1i s\u1ebd vi\u1ebft 01 b\u00e1o c\u00e1o s\u1ef1 c\u1ed1 (t\u1ec7p pdf ho\u1eb7c docx, pptx,...) g\u1eedi cho ch\u00fang t\u00f4i, ch\u00fang t\u00f4i s\u1ebd xem x\u00e9t t\u1ed5ng th\u1ec3 qu\u00e1 tr\u00ecnh \u1ee9ng c\u1ee9u, \u0111i\u1ec1u tra s\u1ef1 c\u1ed1, t\u1eeb \u0111\u00f3 \u0111\u01b0a ra \u0111i\u1ec3m s\u1ed1 ph\u00f9 h\u1ee3p.</p> <p>C\u00e1c \u0111\u1ed9i ch\u01a1i c\u00f3 th\u00e0nh t\u00edch \u0111i\u1ec3m s\u1ed1 cao s\u1ebd \u0111\u01b0\u1ee3c vinh danh tr\u00ean h\u1ec7 th\u1ed1ng x\u1ebfp h\u1ea1ng c\u1ee7a ch\u00fang t\u00f4i v\u00e0 top 3 s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c c\u00e1c ph\u1ea7n qu\u00e0 \u0111\u1ebfn t\u1eeb VNCERT/CC.</p>"},{"location":"scenarios/#mo-hinh-mang","title":"M\u00f4 h\u00ecnh m\u1ea1ng","text":"<p>DFLab x\u00e2y d\u1ef1ng m\u1ed9t chu\u1ed7i k\u1ecbch b\u1ea3n t\u1ea5n c\u00f4ng s\u00e1t v\u1edbi th\u1ef1c t\u1ebf v\u00e0 \u0111\u01b0a ra c\u00e1c m\u1eabu b\u1eb1ng ch\u1ee9ng, t\u1ec7p nh\u1eadt k\u00fd,... cho c\u00e1c chuy\u00ean gia \u1ee9ng c\u1ee9u, \u0111i\u1ec1u tra, ph\u00e2n t\u00edch s\u1ef1 c\u1ed1 gi\u1ea3 \u0111\u1ecbnh.</p> <p>S\u1ef1 c\u1ed1 \u0111\u01b0\u1ee3c gi\u1ea3 \u0111\u1ecbnh t\u1ea1i m\u1ed9t C\u00f4ng ty c\u00f3 t\u00ean DFCorp c\u00f3 tr\u1ee5 s\u1edf t\u1ea1i Vi\u1ec7t Nam. C\u00f4ng ty c\u00f3 t\u00ean mi\u1ec1n dfcorp.com v\u00e0 s\u1eed d\u1ee5ng c\u00e1c m\u00e1y ch\u1ee7, \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf v\u00e0 l\u1eafp \u0111\u1eb7t, k\u1ebft n\u1ed1i theo s\u01a1 \u0111\u1ed3 sau:</p> <p></p> <p>Danh s\u00e1ch c\u00e1c d\u1ea3i m\u1ea1ng:</p> <ul> <li>DMZ: 10.0.9.0/24</li> <li>WZ: 10.0.8.0/24</li> <li>USERLAN: 10.0.10.0/24</li> </ul> <p>Danh s\u00e1ch c\u00e1c thi\u1ebft b\u1ecb tham gia h\u1ec7 th\u1ed1ng m\u1ea1ng:</p> <ul> <li>M\u00e1y ch\u1ee7 ADDS (WZ): 10.0.8.2 c\u00e0i \u0111\u1eb7t Windows Server 2019</li> <li>M\u00e1y ch\u1ee7 Database (WZ): 10.0.8.5 c\u00e0i \u0111\u1eb7t</li> <li>M\u00e1y ch\u1ee7 MS Exchange (DMZ): 10.0.9.3 c\u00e0i \u0111\u1eb7t Window Server 2019 v\u00e0 MS Exchange 2019</li> <li>M\u00e1y ch\u1ee7 IIS (DMZ): 10.0.9.4 c\u00e0i \u0111\u1eb7t Windows Server 2019</li> <li>M\u00e1y ch\u1ee7 Firewall: 10.10.2.136 c\u00e0i \u0111\u1eb7t pfSense</li> <li>C\u00e1c nh\u00e2n vi\u00ean tham gia v\u1edbi d\u1ea3i m\u1ea1ng USERLAN</li> <li>M\u00e1y ch\u1ee7 IDS tham gia d\u1ea3i m\u1ea1ng USERLAN</li> </ul> <p>C\u00e1c m\u00e1y ch\u1ee7 MS Exchange v\u00e0 IIS \u0111\u01b0\u1ee3c NAT ra ngo\u00e0i m\u1ea1ng internet v\u00e0 \u0111\u01b0\u1ee3c proxy th\u00f4ng qua haproxy \u0111\u00e3 \u0111\u01b0\u1ee3c b\u1eadt header x-forwarded-for.</p>"},{"location":"scenarios/#danh-sach-cac-tinh-huong","title":"Danh s\u00e1ch c\u00e1c t\u00ecnh h\u01b0\u1edbng","text":"<ol> <li> <p>T\u00ecnh hu\u1ed1ng 1: T\u1ea5n c\u00f4ng \u0111\u00e0o ti\u1ec1n \u1ea3o</p> </li> <li> <p>T\u00ecnh hu\u1ed1ng 2: T\u1ea5n c\u00f4ng m\u00e3 h\u00f3a m\u00e1y \u1ea3o</p> </li> <li> <p>T\u00ecnh hu\u1ed1ng 3: T\u1ea5n c\u00f4ng v\u00e0o m\u00e1y ch\u1ee7 web</p> </li> <li> <p>T\u00ecnh hu\u1ed1ng 4: T\u1ea5n c\u00f4ng chi\u1ebfm quy\u1ec1n trong m\u00f4i tr\u01b0\u1eddng domain</p> </li> <li> <p>T\u00ecnh hu\u1ed1ng 5: T\u00ecnh hu\u1ed1ng \u0111i\u1ec1u tra ph\u00e2n t\u00edch s\u1ef1 c\u1ed1 mail outlook</p> </li> <li> <p>T\u00ecnh hu\u1ed1ng 6: T\u00ecnh hu\u1ed1ng \u0111i\u1ec1u tra t\u1ea5n c\u00f4ng chuy\u1ec3n h\u01b0\u1edbng website</p> </li> </ol>"},{"location":"scenarios/challenge1/","title":"T\u00ecnh hu\u1ed1ng 1: T\u1ea5n c\u00f4ng \u0111\u00e0o ti\u1ec1n \u1ea3o","text":"<p>C\u1ea5p \u0111\u1ed9: Chuy\u00ean gia</p>"},{"location":"scenarios/challenge1/#tong-quan","title":"T\u1ed5ng quan","text":"<p>Qua h\u1ec7 th\u1ed1ng gi\u00e1m s\u00e1t IDS, \u0111\u1ed9i ng\u0169 qu\u1ea3n tr\u1ecb, v\u1eadn h\u00e0nh h\u1ec7 th\u1ed1ng ph\u00e1t hi\u1ec7n m\u1ed9t cu\u1ed9c t\u1ea5n c\u00f4ng t\u1edbi h\u1ec7 th\u1ed1ng m\u1ea1ng, m\u00e1y ch\u1ee7 c\u1ee7a DFCorp. Qu\u1ea3n tr\u1ecb vi\u00ean nhanh ch\u00f3ng th\u1ef1c hi\u1ec7n c\u00e1c c\u00f4ng vi\u1ec7c sau:</p> <ol> <li>Ti\u1ebfp t\u1ee5c ki\u1ec3m tra, theo d\u00f5i cu\u1ed9c t\u1ea5n c\u00f4ng</li> <li>B\u1eadt tcpdump v\u00e0 b\u1eaft c\u00e1c g\u00f3i tin, l\u01b0u l\u01b0\u1ee3ng truy c\u1eadp trong m\u1ea1ng</li> </ol> <p>Tuy nhi\u00ean, do n\u0103ng l\u1ef1c h\u1ea1n ch\u1ebf, \u0111\u1ed9i ng\u0169 qu\u1ea3n tr\u1ecb \u0111\u00e3 kh\u00f4ng th\u1ec3 ph\u00e1t hi\u1ec7n s\u00e2u h\u01a1n c\u00e1c h\u00e0nh vi c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng. V\u00e0i ng\u00e0y sau \u0111\u00f3, \u0111\u1ed9i ng\u0169 qu\u1ea3n tr\u1ecb nh\u1eadn \u0111\u01b0\u1ee3c b\u00e1o c\u00e1o t\u1eeb ng\u01b0\u1eddi d\u00f9ng r\u1eb1ng m\u00e1y t\u00ednh c\u1ee7a h\u1ecd c\u1eb7p tr\u1ee5c tr\u1eb7c, hay b\u1ecb \u0111\u01a1, kh\u00f4ng l\u00e0m vi\u1ec7c \u0111\u01b0\u1ee3c. C\u00f9ng th\u1eddi gian \u0111\u00f3, m\u00e1y ch\u1ee7 Email c\u1ee7a h\u1ec7 th\u1ed1ng ho\u1ea1t \u0111\u1ed9ng ch\u1eadp ch\u1eddn, CPU lu\u00f4n \u1edf m\u1ee9c 99%.</p> <p>B\u1ea1n, v\u1edbi vai tr\u00f2 l\u00e0 chuy\u00ean vi\u00ean \u0111i\u1ec1u tra, \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1, h\u00e3y gi\u00fap c\u00f4ng ty DFCorp \u0111i\u1ec1u tra s\u1ef1 c\u1ed1 n\u00e0y.</p> <p>H\u00ecnh \u1ea3nh M\u00e1y ch\u1ee7 Email:</p> <p></p> <p>H\u00ecnh \u1ea3nh M\u00e1y ch\u1ee7 ADDS:</p> <p></p> <p>H\u00ecnh \u1ea3nh do ng\u01b0\u1eddi d\u00f9ng cung c\u1ea5p:</p> <p></p>"},{"location":"scenarios/challenge1/#cau-hoi","title":"C\u00e2u h\u1ecfi","text":"<ol> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 s\u1eed d\u1ee5ng c\u00f4ng c\u1ee5 g\u00ec \u0111\u1ec3 r\u00e0 qu\u00e9t h\u1ec7 th\u1ed1ng c\u1ee7a DFCorp? IP c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng s\u1eed d\u1ee5ng \u0111\u1ec3 r\u00e0 qu\u00e9t l\u00e0 g\u00ec?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 ph\u00e1t hi\u1ec7n \u0111\u01b0\u1ee3c l\u1ed7 h\u1ed5ng g\u00ec trong \u0111\u1ee3t r\u00e0 qu\u00e9t \u0111\u00f3 kh\u00f4ng? N\u1ebfu c\u00f3 h\u00e3y ch\u1ec9 ra l\u1ed7 h\u1ed5ng.</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 t\u1ea5n c\u00f4ng qua email n\u00e0o c\u1ee7a h\u1ec7 th\u1ed1ng? C\u00f3 th\u00e0nh c\u00f4ng hay kh\u00f4ng?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 l\u1ea5y \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u quan tr\u1ecdng n\u00e0o c\u1ee7a DFCorp kh\u00f4ng?</li> <li>\u0110\u01b0\u1eddng d\u1eabn k\u1ebb t\u1ea5n c\u00f4ng th\u1ef1c hi\u1ec7n \u0111\u1ec3 khai th\u00e1c l\u1ed7 h\u1ed5ng v\u00e0 s\u1eed d\u1ee5ng shell? K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 s\u1eed d\u1ee5ng shell th\u00e0nh c\u00f4ng hay kh\u00f4ng?</li> <li>CnC server c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng l\u00e0 g\u00ec?</li> <li>Qu\u00e1 tr\u00ecnh m\u00e0 k\u1ebb t\u1ea5n c\u00f4ng th\u1ef1c hi\u1ec7n g\u00e2y ra h\u1eadu qu\u1ea3 nh\u01b0 c\u00e1c h\u00ecnh \u1ea3nh tr\u00ean.</li> </ol>"},{"location":"scenarios/challenge1/#tep-inh-kem","title":"T\u1ec7p \u0111\u00ednh k\u00e8m","text":"<ol> <li>T\u1ec7p pcap khi ph\u00e1t hi\u1ec7n d\u1ea5u hi\u1ec7u t\u1ea5n c\u00f4ng (part 1)</li> <li>T\u1ec7p pcap khi ph\u00e1t hi\u1ec7n d\u1ea5u hi\u1ec7u t\u1ea5n c\u00f4ng (part 2)</li> <li>T\u1ec7p pcap (ti\u1ebfp)</li> <li>T\u1ec7p logs ADDS</li> <li>T\u1ec7p logs User</li> <li>T\u1ec7p logs Exchange</li> </ol>"},{"location":"scenarios/challenge2/","title":"T\u00ecnh hu\u1ed1ng 2: T\u1ea5n c\u00f4ng m\u00e3 h\u00f3a m\u00e1y \u1ea3o","text":"<p>C\u1ea5p \u0111\u1ed9: Chuy\u00ean vi\u00ean</p>"},{"location":"scenarios/challenge2/#tong-quan","title":"T\u1ed5ng quan","text":"<p>M\u1ed9t m\u00e1y ch\u1ee7 VMWare ESXi c\u1ee7a C\u00f4ng ty \u0111\u00e3 b\u1ecb t\u1ea5n c\u00f4ng, \u0111\u1ed9i ng\u0169 qu\u1ea3n tr\u1ecb vi\u00ean c\u0169ng kh\u00f4ng bi\u1ebft r\u00f5 cho t\u1edbi khi k\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 \u0111\u1ec3 l\u1ea1i l\u1eddi nh\u1eafn cho C\u00f4ng ty, khi qu\u1ea3n tr\u1ecb vi\u00ean v\u00e0o giao di\u1ec7n web:</p> <p></p> <p>Qu\u1ea3n tr\u1ecb vi\u00ean bi\u1ebft r\u1eb1ng c\u00f3 m\u1ed9t c\u00e1ch kh\u00e1c \u0111\u1ec3 l\u1ea5y l\u1ea1i c\u00e1c m\u00e1y \u1ea3o m\u00e0 kh\u00f4ng qua web, \u0111\u00f3 l\u00e0 SSH:</p> <p></p> <p>Sau m\u1ed9t h\u1ed3i kh\u00e1m ph\u00e1, ch\u00fang t\u00f4i t\u00ecm \u0111\u01b0\u1ee3c giao di\u1ec7n c\u0169 c\u1ee7a ESXi qua \u0111\u01b0\u1eddng d\u1eabn <code>/index1.html</code>:</p> <p></p> <p>M\u00e1y \u1ea3o n\u00e0y r\u1ea5t quan tr\u1ecdng v\u1edbi C\u00f4ng ty ch\u00fang t\u00f4i, h\u00e3y gi\u00fap ch\u00fang t\u00f4i kh\u00f4i ph\u1ee5c l\u1ea1i d\u1eef li\u1ec7u v\u00e0 t\u00ecm ra nguy\u00ean nh\u00e2n.</p>"},{"location":"scenarios/challenge2/#cau-hoi","title":"C\u00e2u h\u1ecfi","text":"<ol> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 t\u1ea5n c\u00f4ng v\u00e0o h\u1ec7 th\u1ed1ng c\u1ee7a ch\u00fang t\u00f4i nh\u01b0 th\u1ebf n\u00e0o?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 l\u1ea5y \u0111\u01b0\u1ee3c d\u1eef li\u1ec7u g\u00ec quan tr\u1ecdng c\u1ee7a C\u00f4ng ty kh\u00f4ng.</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 l\u00e0m g\u00ec khi\u1ebfn m\u00e1y ch\u1ee7 \u1ea3o c\u1ee7a ch\u00fang t\u00f4i kh\u00f4ng th\u1ec3 truy c\u1eadp?</li> <li>B\u1ea1n c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c l\u1ea1i m\u00e1y \u1ea3o gi\u00fap ch\u00fang t\u00f4i kh\u00f4ng?</li> </ol>"},{"location":"scenarios/challenge2/#tep-inh-kem","title":"T\u1ec7p \u0111\u00ednh k\u00e8m","text":"<ol> <li>T\u1ec7p pcap</li> <li>T\u1ec7p m\u00e1y \u1ea3o ESXi (part 1)</li> <li>T\u1ec7p m\u00e1y \u1ea3o ESXi (part 2)</li> </ol>"},{"location":"scenarios/challenge3/","title":"T\u00ecnh hu\u1ed1ng 3: T\u1ea5n c\u00f4ng v\u00e0o m\u00e1y ch\u1ee7 web","text":"<p>C\u1ea5p \u0111\u1ed9: Chuy\u00ean vi\u00ean</p>"},{"location":"scenarios/challenge3/#tong-quan","title":"T\u1ed5ng quan","text":"<p>M\u00e1y ch\u1ee7 website c\u1ee7a ch\u00fang t\u00f4i \u0111\u1ed9t nhi\u00ean b\u1ecb l\u1ed7i, c\u00e1c d\u1eef li\u1ec7u quan tr\u1ecdng l\u01b0u tr\u00ean database b\u1ea5t ng\u1edd b\u1ecb x\u00f3a, ch\u00fang t\u00f4i kh\u00f4ng th\u1ec3 truy c\u1eadp v\u00e0o website c\u1ee7a m\u00ecnh \u0111\u01b0\u1ee3c. H\u00e3y gi\u00fap ch\u00fang t\u00f4i t\u00ecm ra nguy\u00ean nh\u00e2n v\u00e0 kh\u00f4i ph\u1ee5c l\u1ea1i website n\u00e0y.</p> <p></p>"},{"location":"scenarios/challenge3/#cau-hoi","title":"C\u00e2u h\u1ecfi","text":"<ol> <li>Th\u1eddi gian xu\u1ea5t hi\u1ec7n t\u1ea5n c\u00f4ng nhi\u1ec1u nh\u1ea5t?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 t\u00ecm th\u1ea5y bao nhi\u00eau \u0111i\u1ec3m y\u1ebfu tr\u00ean website?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng d\u00f9ng c\u00e1ch g\u00ec \u0111\u1ec3 c\u00f3 th\u1ec3 th\u1ef1c thi \u0111\u01b0\u1ee3c command tr\u00ean server? Server n\u00e0o \u0111\u00e3 b\u1ecb k\u1ebb t\u1ea5n c\u00f4ng ki\u1ec3m so\u00e1t?</li> <li>Cho bi\u1ebft payload th\u1ef1c hi\u1ec7n c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng d\u00f9ng l\u1ec7nh g\u00ec \u0111\u1ec3 th\u1ef1c hi\u1ec7n GET shell v\u1ec1 h\u1ec7 th\u1ed1ng nh\u01b0ng kh\u00f4ng th\u00e0nh c\u00f4ng?</li> <li>B\u1eb1ng ch\u1ee9ng n\u00e0o cho th\u1ea5y d\u1eef li\u1ec7u quan tr\u1ecdng tr\u00ean website \u0111\u00e3 b\u1ecb xo\u00e1? K\u1ebb t\u1ea5n c\u00f4ng c\u00f3 x\u00f3a th\u00eam d\u1eef li\u1ec7u n\u00e0o kh\u00e1c kh\u00f4ng?</li> <li>L\u00e0m th\u1ebf n\u00e0o \u0111\u1ec3 ch\u00fang t\u00f4i c\u00f3 th\u1ec3 kh\u00f4i ph\u1ee5c \u0111\u01b0\u1ee3c d\u1ecbch v\u1ee5?</li> </ol>"},{"location":"scenarios/challenge3/#tep-inh-kem","title":"T\u1ec7p \u0111\u00ednh k\u00e8m","text":"<ol> <li>T\u1ec7p access log</li> <li>T\u1ec7p SQL Log</li> <li>T\u1ec7p bak</li> </ol>"},{"location":"scenarios/challenge4/","title":"T\u00ecnh hu\u1ed1ng 4: T\u1ea5n c\u00f4ng chi\u1ebfm quy\u1ec1n trong m\u00f4i tr\u01b0\u1eddng domain","text":"<p>C\u1ea5p \u0111\u1ed9: Chuy\u00ean vi\u00ean</p>"},{"location":"scenarios/challenge4/#tong-quan","title":"T\u1ed5ng quan","text":"<p>Qu\u1ea3n tr\u1ecb vi\u00ean h\u1ec7 th\u1ed1ng ghi nh\u1eadn c\u00f3 nh\u1eefng d\u1ea5u hi\u1ec7u truy c\u1eadp b\u1ea5t th\u01b0\u1eddng v\u00e0o Domain Controller v\u1edbi \u0111\u1eb7c quy\u1ec1n cao nh\u01b0ng ch\u01b0a r\u00f5 nguy\u00ean nh\u00e2n. \u0110\u01a1n v\u1ecb ph\u1ea3n \u1ee9ng t\u1ea1i ch\u1ed7 \u0111\u00e3 nhanh ch\u00f3ng ti\u1ebfp c\u1eadn hi\u1ec7n tr\u01b0\u1eddng v\u00e0 thu th\u1eadp nh\u1eefng d\u1eef li\u1ec7u c\u1ea7n thi\u1ebft ph\u1ee5c v\u1ee5 cho qu\u00e1 tr\u00ecnh \u0111i\u1ec1u tra. </p> <p>H\u00e3y v\u00e0o vai nh\u00e0 ph\u00e2n t\u00edch s\u1ef1 c\u1ed1 v\u00e0 t\u00ecm hi\u1ec3u xem k\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 truy c\u1eadp \u0111\u01b0\u1ee3c v\u00e0o h\u1ec7 th\u1ed1ng th\u00f4ng qua nh\u1eefng con \u0111\u01b0\u1eddng n\u00e0o, v\u00e0 nhi\u1ec7m v\u1ee5 c\u1ee7a b\u1ea1n l\u00e0 t\u00ecm b\u1eb1ng ch\u1ee9ng ho\u1eb7c d\u1ea5u hi\u1ec7u c\u1ee7a c\u00e1c IoC. </p> <p>V\u00ec v\u1eady, c\u00e2u h\u1ecfi ti\u1ebfp theo s\u1ebd l\u00e0 b\u1ea1n n\u00ean t\u00ecm ki\u1ebfm nh\u1eefng ch\u1ec9 s\u1ed1 n\u00e0o \u0111\u1ec3 ph\u00e1t hi\u1ec7n cu\u1ed9c t\u1ea5n c\u00f4ng?</p>"},{"location":"scenarios/challenge4/#cau-hoi","title":"C\u00e2u h\u1ecfi","text":"<ol> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 t\u1ea5n c\u00f4ng v\u00e0o h\u1ec7 th\u1ed1ng Domain Controller th\u00f4ng qua con \u0111\u01b0\u1eddng g\u00ec?</li> <li>Ph\u00e2n t\u00edch, t\u00ecm ki\u1ebfm nh\u1eefng ti\u1ebfn tr\u00ecnh c\u00f3 li\u00ean quan \u0111\u1ebfn cu\u1ed9c t\u1ea5n c\u00f4ng?</li> <li>X\u00e1c \u0111\u1ecbnh d\u1ecbch v\u1ee5 b\u1ecb l\u1ea1m d\u1ee5ng \u0111\u1ec3 ti\u1ebfn h\u00e0nh t\u1ea5n c\u00f4ng RCE v\u00e0o Domain Controller?</li> <li>X\u00e1c \u0111\u1ecbnh hostname v\u00e0 local domain b\u1ecb t\u1ea5n c\u00f4ng ?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 s\u1eed d\u1ee5ng giao th\u1ee9c g\u00ec \u0111\u1ec3 ph\u00e1t t\u00e1n m\u00e3 th\u1ef1c thi v\u00e0o h\u1ec7 th\u1ed1ng?</li> <li>S\u1ef1 ki\u1ec7n FileCreated \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o v\u00e0 ghi l\u1ea1i. Cung c\u1ea5p \u0111\u01b0\u1eddng d\u1eabn \u0111\u1ea7y \u0111\u1ee7 \u0111\u1ebfn t\u1ec7p \u0111\u1ecdc h\u1ea1i v\u00e0 th\u1eddi gian t\u1ea1o file th\u1ef1c thi \u0111\u00f3?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 th\u1ef1c hi\u1ec7n nh\u1eefng l\u1ec7nh khai th\u00e1c v\u1edbi \u0111\u1eb7c quy\u1ec1n g\u00ec trong h\u1ec7 th\u1ed1ng? C\u1ed1 g\u1eafng thu th\u1eadp th\u00f4ng tin, b\u1eb1ng ch\u1ee9ng nh\u1eefng l\u1ec7nh m\u00e0 k\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 th\u1ef1c thi?</li> <li>T\u00ecm ki\u1ebfm \u0111\u1ecba ch\u1ec9 IP c\u1ee7a m\u00e1y b\u1ecb l\u1ea1m d\u1ee5ng \u0111\u1ec3 t\u1ea5n c\u00f4ng v\u00e0o Domain Controller?</li> <li>B\u1ea1n c\u00f3 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c t\u00ean l\u1ed7 h\u1ed5ng m\u00e0 k\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 l\u1ea1m d\u1ee5ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n cu\u1ed9c t\u1ea5n c\u00f4ng n\u00e0y hay kh\u00f4ng?</li> <li>\u0110\u01b0a ra c\u00e1c bi\u1ec7n ph\u00e1p kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1.</li> </ol>"},{"location":"scenarios/challenge4/#tep-inh-kem","title":"T\u1ec7p \u0111\u00ednh k\u00e8m","text":"<ol> <li>T\u1ec7p logfile gi\u00e1m s\u00e1t</li> <li>T\u1ec7p pcap gi\u00e1m s\u00e1t</li> <li>T\u1ec7p Sysmon log</li> <li>T\u1ec7p System log</li> <li>T\u1ec7p System Idle Process</li> </ol>"},{"location":"scenarios/challenge5/","title":"T\u00ecnh hu\u1ed1ng 5: T\u00ecnh hu\u1ed1ng \u0111i\u1ec1u tra ph\u00e2n t\u00edch s\u1ef1 c\u1ed1 mail outlook","text":"<p>C\u1ea5p \u0111\u1ed9: Chuy\u00ean vi\u00ean</p>"},{"location":"scenarios/challenge5/#tong-quan","title":"T\u1ed5ng quan","text":"<p>Qu\u1ea3n tr\u1ecb vi\u00ean h\u1ec7 th\u1ed1ng nh\u1eadn th\u1ea5y c\u00f3 nhi\u1ec1u truy c\u1eadp x\u00e1c th\u1ef1c b\u1ea5t th\u01b0\u1eddng v\u00e0o h\u1ec7 th\u1ed1ng, sau khi quan s\u00e1t nh\u1eadn th\u1ea5y c\u00f3 nhi\u1ec1u d\u1ea5u hi\u1ec7u li\u00ean quan \u0111\u1ebfn r\u00f2 r\u1ec9 th\u00f4ng tin x\u00e1c th\u1ef1c th\u00f4ng qua giao th\u1ee9c NTLM. </p> <p>Qu\u1ea3n tr\u1ecb vi\u00ean nghi ng\u1edd c\u00f3 d\u1ea5u hi\u1ec7u leo thang \u0111\u1eb7c quy\u1ec1n trong h\u1ec7 th\u1ed1ng. V\u1edbi vai tr\u00f2 l\u00e0 chuy\u00ean vi\u00ean \u0111i\u1ec1u tra s\u1ef1 c\u1ed1, h\u00e3y ti\u1ebfn h\u00e0nh t\u00ecm hi\u1ec3u nguy\u00ean nh\u00e2n, c\u00e1ch th\u1ee9c m\u00e0 k\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 truy c\u1eadp v\u00e0o h\u1ec7 th\u1ed1ng.</p>"},{"location":"scenarios/challenge5/#cau-hoi","title":"C\u00e2u h\u1ecfi","text":"<ol> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 t\u1eadn d\u1ee5ng giao th\u1ee9c n\u00e0o \u0111\u1ec3 khai th\u00e1c?</li> <li>X\u00e1c \u0111\u1ecbnh ip c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng v\u00e0 m\u00e1y b\u1ecb t\u1ea5n c\u00f4ng?</li> <li>X\u00e1c \u0111\u1ecbnh user/password c\u1ee7a m\u00e1y b\u1ecb k\u1ebb t\u1ea5n c\u00f4ng khai th\u00e1c?</li> <li>B\u1ea1n c\u00f3 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c t\u00ean l\u1ed7 h\u1ed5ng m\u00e0 k\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 l\u1ea1m d\u1ee5ng \u0111\u1ec3 th\u1ef1c hi\u1ec7n cu\u1ed9c t\u1ea5n c\u00f4ng n\u00e0y hay kh\u00f4ng?</li> <li>\u0110\u01b0a ra c\u00e1c bi\u1ec7n ph\u00e1p kh\u1eafc ph\u1ee5c s\u1ef1 c\u1ed1?</li> </ol>"},{"location":"scenarios/challenge5/#tep-inh-kem","title":"T\u1ec7p \u0111\u00ednh k\u00e8m","text":"<ol> <li>Event log</li> <li>T\u1ec7p pcap</li> </ol>"},{"location":"scenarios/challenge6/","title":"T\u00ecnh hu\u1ed1ng 6: T\u00ecnh hu\u1ed1ng \u0111i\u1ec1u tra t\u1ea5n c\u00f4ng chuy\u1ec3n h\u01b0\u1edbng website","text":"<p>C\u1ea5p \u0111\u1ed9: Chuy\u00ean vi\u00ean</p> <p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p>"},{"location":"scenarios/challenge6/#tong-quan","title":"T\u1ed5ng quan","text":"<p>H\u1ec7 th\u1ed1ng gi\u00e1m s\u00e1t IDS ghi nh\u1eadn c\u00f3 1 l\u01b0\u1ee3ng l\u1edbn n\u1ed7 l\u1ef1c t\u1ea5n c\u00f4ng v\u00e0o website trangchu.habinh.gov. Sau khi ghi nh\u1eadn th\u00f4ng b\u00e1o t\u1eeb SOC, qu\u1ea3n tr\u1ecb vi\u00ean th\u1ef1c hi\u1ec7n b\u1eadt Wireshark v\u00e0 b\u1eaft c\u00e1c g\u00f3i tin, l\u01b0u l\u01b0\u1ee3ng truy c\u1eadp trong m\u1ea1ng.</p> <p>Tuy nhi\u00ean do n\u0103ng l\u1ef1c h\u1ea1n ch\u1ebf \u0111\u1ed9i ng\u0169 qu\u1ea3n tr\u1ecb \u0111\u00e3 kh\u00f4ng th\u1ec3 ph\u00e1t hi\u1ec7n s\u00e2u h\u01a1n c\u00e1c h\u00e0nh vi c\u1ee7a k\u1ebb t\u1ea5n c\u00f4ng. M\u1ed9t kho\u1ea3ng th\u1eddi gian sau \u0111\u00f3, qu\u1ea3n tr\u1ecb vi\u00ean nh\u1eadn \u0111\u01b0\u1ee3c th\u00f4ng b\u00e1o t\u1eeb ng\u01b0\u1eddi d\u00f9ng r\u1eb1ng website chuy\u1ec3n th\u00e0nh trang c\u1edd b\u1ea1c online. </p> <p>Qu\u1ea3n tr\u1ecb vi\u00ean sau \u0111\u00f3 \u0111\u00e3 th\u1ef1c hi\u1ec7n stop d\u1ecbch v\u1ee5, ng\u1eaft k\u1ebft n\u1ed1i m\u1ea1ng v\u00e0 chuy\u1ec3n m\u00e3 ngu\u1ed3n sang 1 server kh\u00e1c. Sau khi chuy\u1ec3n th\u00ec kh\u00f4ng c\u00f2n ghi nh\u1eadn hi\u1ec7n t\u01b0\u1ee3ng tr\u00ean. </p> <p>Qu\u1ea3n tr\u1ecb vi\u00ean sau \u0111\u00f3 c\u0169ng th\u1ef1c hi\u1ec7n n\u00e9n c\u00e1c th\u01b0 m\u1ee5c quan tr\u1ecdng li\u00ean quan \u0111\u1ebfn website v\u00e0 file l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng ghi nh\u1eadn \u0111\u01b0\u1ee3c cho \u0111\u1ed9i \u0111i\u1ec1u tra. </p> <p>B\u1ea1n, v\u1edbi vai tr\u00f2 l\u00e0 chuy\u00ean vi\u00ean \u0111i\u1ec1u tra, \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1, h\u00e3y gi\u00fap \u0111\u01a1n v\u1ecb \u0111i\u1ec1u tra s\u1ef1 c\u1ed1 n\u00e0y.</p>"},{"location":"scenarios/challenge6/#mo-ta-hien-truong","title":"M\u00f4 t\u1ea3 hi\u1ec7n tr\u01b0\u1eddng","text":""},{"location":"scenarios/challenge6/#cau-hoi","title":"C\u00e2u h\u1ecfi","text":"<ol> <li>\u0110i\u1ec1u g\u00ec khi\u1ebfn h\u1ec7 th\u1ed1ng b\u1ecb thay \u0111\u1ed5i giao di\u1ec7n th\u00e0nh trang c\u1edd b\u1ea1c online?</li> <li>URL c\u1ee7a Website c\u1edd b\u1ea1c online n\u00e0y l\u00e0 g\u00ec?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 khai th\u00e1c l\u1ed7 h\u1ed5ng c\u00f3 \u0111\u1ecbnh danh n\u00e0o v\u00e0o server? (Format: CVE-XXXX-XXXXX)</li> <li>Th\u01b0 m\u1ee5c m\u00e0 K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 t\u1ea3i nh\u1eefng file \u0111\u1ed9c h\u1ea1i l\u00ean server?</li> <li>File \u0111\u1ea7u ti\u1ec1n gi\u00fap K\u1ebb t\u1ea5n c\u00f4ng d\u00e0nh quy\u1ec1n truy c\u1eadp l\u1ea7n \u0111\u1ea7u v\u00e0o h\u1ec7 th\u1ed1ng?</li> <li>T\u00ean c\u1ee7a file g\u00e2y ra hi\u1ec7n t\u01b0\u1ee3ng n\u00e0y thay \u0111\u1ed5i giao di\u1ec7n n\u00e0y?</li> <li>K\u1ebb t\u1ea5n c\u00f4ng \u0111\u00e3 \u0111\u1ea1t \u0111\u01b0\u1ee3c quy\u1ec1n SYSTEM hay ch\u01b0a?</li> </ol>"},{"location":"scenarios/challenge6/#tep-inh-kem","title":"T\u1ec7p \u0111\u00ednh k\u00e8m","text":"<ol> <li>T\u1ec7p image (part 1)</li> <li>T\u1ec7p image (part 2)</li> <li>T\u1ec7p image (part 3)</li> <li>T\u1ec7p image (part 4)</li> <li>T\u1ec7p image (part 5)</li> <li>T\u1ec7p image (part 6)</li> <li>T\u1ec7p image (part 7)</li> <li>T\u1ec7p image (part 8)</li> <li>T\u1ec7p pcap</li> </ol>"},{"location":"tools/","title":"B\u1ed9 c\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch","text":""},{"location":"tools/#gioi-thieu","title":"Gi\u1edbi thi\u1ec7u","text":"<p>Ch\u00fang t\u00f4i gi\u1edbi thi\u1ec7u, h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng c\u00e1c c\u00f4ng c\u1ee5 open source, mi\u1ec5n ph\u00ed v\u00e0 c\u00e1c c\u00f4ng c\u1ee5 do ch\u00fang t\u00f4i t\u1ef1 ph\u00e1t tri\u1ec3n, h\u1ed7 tr\u1ee3 vi\u1ec7c \u1ee9ng c\u1ee9u, \u0111i\u1ec1u tra s\u1ef1 c\u1ed1. M\u1ed7i c\u00f4ng c\u1ee5 \u0111\u01b0\u1ee3c h\u01b0\u1edbng d\u1eabn v\u1edbi c\u00e1c m\u1ee5c sau: Gi\u1edbi thi\u1ec7u c\u00f4ng c\u1ee5, c\u00e1c ch\u1ee9c n\u0103ng ch\u00ednh v\u00e0 h\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng c\u00f4ng c\u1ee5.</p> <p>B\u1ed9 c\u00f4ng c\u1ee5 n\u00e0y gi\u00fap c\u00e1c chuy\u00ean gia ph\u00e1t hi\u1ec7n c\u00e1c b\u1eb1ng ch\u1ee9ng, d\u1ea5u hi\u1ec7u c\u1ee7a s\u1ef1 c\u1ed1, l\u1ed7 h\u1ed5ng b\u1ea3o m\u1eadt, x\u00e1c \u0111\u1ecbnh nguy\u00ean nh\u00e2n c\u1ee7a c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng, gi\u00fap \u1ee9ng ph\u00f3 v\u00e0 gi\u1ea3i quy\u1ebft c\u00e1c s\u1ef1 c\u1ed1 nhanh ch\u00f3ng v\u00e0 hi\u1ec7u qu\u1ea3.</p> <p>M\u1ed9t s\u1ed1 c\u00f4ng c\u1ee5 \u0111i\u1ec3n h\u00ecnh: </p> <ul> <li>Thor Lite (Nextron Systems)</li> <li>Hayabusa (Yamato-Security)</li> <li>Autospy (The Sleuth Kit\u00ae)</li> <li>Timeline Explorer (Eric Zimmerman)</li> </ul>"},{"location":"tools/#danh-sach-cac-cong-cu","title":"Danh s\u00e1ch c\u00e1c c\u00f4ng c\u1ee5","text":"<ul> <li>C\u00f4ng c\u1ee5 do VNCERT ph\u00e1t tri\u1ec3n</li> <li>C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra nh\u1eadt k\u00fd s\u1ef1 ki\u1ec7n</li> <li>C\u00f4ng c\u1ee5 s\u0103n t\u00ecm m\u1ed1i \u0111e do\u1ea1</li> <li>C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra ph\u01b0\u01a1ng ti\u1ec7n l\u01b0u tr\u1eef</li> <li>C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra thi\u1ebft b\u1ecb di \u0111\u1ed9ng</li> <li>C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra d\u1eef li\u1ec7u b\u1ed9 nh\u1edb</li> <li>C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra m\u1ea1ng</li> </ul>"},{"location":"tools/disk/","title":"C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra ph\u01b0\u01a1ng ti\u1ec7n l\u01b0u tr\u1eef","text":""},{"location":"tools/disk/#accessdata-ftk-imager","title":"AccessData FTK Imager","text":"<p>FTK Imager l\u00e0 \u1ee9ng d\u1ee5ng \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi c\u00f4ng ty AccessData. \u0110\u00e2y l\u00e0 m\u1ed9t trong nh\u1eefng c\u00f4ng ty cung c\u1ea5p nh\u1eefng c\u00f4ng c\u1ee5 ph\u1ee5c v\u1ee5 c\u00f4ng t\u00e1c Computer Forensics t\u1ed1t nh\u1ea5t hi\u1ec7n n\u00e0y.</p> <p>FTK Imager \u0111\u01b0\u1ee3c g\u1eafn li\u1ec1n v\u1edbi s\u1ef1 ph\u00e1t tri\u1ec3n c\u1ee7a FTK (Forensic Toolkits) c\u0169ng \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi AccessData. Hi\u1ec3u \u0111\u01a1n gi\u1ea3n, FTK Imager c\u00f3 nhi\u1ec7m v\u1ee5 t\u1ea1o t\u1ec7p tin \u1ea3nh \u0111\u1ec3 ph\u1ee5c v\u1ee5 cho FTK ph\u00e2n t\u00edch \u0111\u01b0\u1ee3c hi\u1ec7u qu\u1ea3 v\u00e0 nhanh ch\u00f3ng (Hi\u1ec7n nay FTK Imager \u0111\u00e3 b\u1ed5 sung nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng t\u1ec7p tin ph\u1ed5 bi\u1ebfn \u0111\u1ec3 t\u1ec7p tin \u1ea3nh c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng tr\u00ean nhi\u1ec1u \u1ee9ng d\u1ee5ng Forensic kh\u00e1c).</p> <p>FTK Imager c\u00f3 nhi\u1ec7m v\u1ee5 ch\u00ednh l\u00e0 t\u1ea1o t\u1ec7p tin \u1ea3nh, hay hi\u1ec3u l\u00e0 t\u1ea1o m\u1ed9t t\u1ec7p tin ph\u1ea3n \u00e1nh ch\u00ednh x\u00e1c t\u1eebng bit (bit by bit) m\u1ed9t ph\u1ea7n ho\u1eb7c to\u00e0n b\u1ed9 b\u1ed9 nh\u1edb. Nguy\u00ean do ph\u1ea3i t\u1ea1o file \u1ea3nh l\u00e0 \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o t\u00ednh nguy\u00ean v\u1eb9n c\u1ee7a ch\u1ee9ng c\u1ee9 \u0111\u01b0\u1ee3c thu th\u1eadp theo th\u1ee7 t\u1ee5c t\u1ed1 t\u1ee5ng h\u00ecnh s\u1ef1. Kh\u00f4ng ch\u1ec9 v\u1eady, \u1ee9ng d\u1ee5ng n\u00e0y c\u00f2n c\u00f3 kh\u1ea3 n\u0103ng tr\u00edch xu\u1ea5t d\u1eef li\u1ec7u tr\u1ef1c ti\u1ebfp t\u1eeb RAM tr\u00ean c\u00e1c h\u1ec7 th\u1ed1ng \u0111ang ho\u1ea1t \u0111\u1ed9ng (Live)</p> <p></p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng AccessData FTK Imager <p>Ch\u1ecdn File \u2013 Add Evidence Item \u0111\u1ec3 l\u1ef1a ch\u1ecdn ngu\u1ed3n t\u1ea1o t\u1ec7p tin \u1ea3nh:</p> <p></p> <p>Select Source</p> <p></p> <p>T\u00f9y v\u00e0o ngu\u1ed3n mu\u1ed1n t\u1ea1o \u1ea3nh:</p> <ul> <li> <p>Physical Drive (\u1ed5 \u0111\u0129a v\u1eadt l\u00fd): L\u00e0 c\u00e1c thi\u1ebft b\u1ecb l\u01b0u tr\u1eef d\u1eef li\u1ec7u \u0111i\u1ec7n t\u1eed nh\u01b0: \u1ed4 c\u1ee9ng m\u00e1y t\u00ednh, \u1ed5 c\u1ee9ng th\u1ec3 r\u0103n, th\u1ebb nh\u1edb v.v\u2026).</p> </li> <li> <p>Logical Drive (\u1ed5 \u0111\u0129a logic):L\u00e0 c\u00e1c ph\u00e2n v\u00f9ng d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c t\u1ea1o ra t\u1eeb c\u00e1c \u1ed5 \u0111\u0129a v\u1eadt l\u00fd</p> </li> <li> <p>Image File (File \u1ea3nh): L\u00e0 file \u1ea3nh \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o s\u1eb5n th\u01b0\u1eddng \u0111\u01b0\u1ee3c \u0111\u1ecbnh d\u1ea1ng d\u01b0\u1edbi d\u1ea1ng \u201c.dd\u201d, \u201c.SMART\u201d, \u201c.E01\u201d\u2026</p> </li> <li> <p>Contents of a Folder (n\u1ed9i dung trong Folder): \u0110\u00e2y l\u00e0 tr\u01b0\u1eddng h\u1ee3p ta l\u1ef1a ch\u1ecdn khi ta bi\u1ebft ch\u00ednh x\u00e1c \u0111\u1ecba \u0111i\u1ec3m ta c\u1ea7n ph\u00e2n t\u00edch, khi s\u1eed d\u1ee5ng l\u1ef1a ch\u1ecdn n\u00e0y, FTK Imager y\u00eau c\u1ea7u ta \u0111i\u1ec1u h\u01b0\u1edbng ch\u1ecdn v\u00f9ng c\u1ea7n ph\u00e2n t\u00edch sau \u0111\u00f3 n\u00f3 s\u1ebd t\u1ef1 khoanh v\u00f9ng \u0111\u1ec3 ti\u1ebfn h\u00e0nh t\u1ea1o t\u1ec7p tin \u1ea3nh v\u00f9ng \u0111\u00f3.</p> </li> </ul> <p>Trong ph\u1ea7n n\u00e0y, ta ch\u1ecdn Physical Drive \u0111\u1ec3 ti\u1ebfn h\u00e0nh t\u1ea1o t\u1ec7p tin \u1ea3nh thi\u1ebft b\u1ecb l\u01b0u tr\u1eef:</p> <p></p> <p>Ch\u1ecdn Finish, FTK Imager s\u1ebd \u0111\u1ecdc v\u00e0 hi\u1ec3n th\u1ecb n\u1ed9i dung c\u1ee7a thi\u1ebft b\u1ecb l\u01b0u tr\u1eef:</p> <p></p> <p>Ch\u1ecdn Export Logical image (AD1) nh\u01b0 h\u00ecnh:</p> <p></p> <p>Ch\u1ecdn Add v\u00e0 \u0111i\u1ec1n c\u00e1c th\u00f4ng tin c\u1ea7n thi\u1ebft.</p> <p></p> <p>Ch\u1ecdn Next v\u00e0 thi\u1ebft l\u1eadp t\u00ean c\u0169ng nh\u01b0 n\u01a1i l\u1eefu tr\u1eef t\u1ec7p tin \u1ea3nh.</p> <p></p> <p>C\u00f3 th\u1ec3 s\u1eed d\u1ee5ng ch\u1ee9c n\u0103ng n\u00e9n ho\u1eb7c m\u00e3 h\u00f3a d\u1eef li\u1ec7u n\u1ebfu c\u1ea7n. Ch\u1ecdn Finish v\u00e0 Start \u0111\u1ec3 b\u1eaft \u0111\u1ea7u ti\u1ebfn h\u00e0nh t\u1ea1o t\u1ec7p tin \u1ea3nh.</p> <p>Sau khi t\u1ec7p tin \u1ea3nh \u0111\u01b0\u1ee3c t\u1ea1o xong, c\u1ea7n ki\u1ec3m tra l\u1ea1i c\u00e1c th\u00f4ng tin trong h\u1ed9p tho\u1ea1i Drive/Image Verify Results. N\u1ebfu m\u00e3 MD5 v\u00e0 SHA1 cho k\u1ebft qu\u1ea3 Match. T\u1ec7p tin \u1ea3nh \u0111\u00e3 \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh c\u00f4ng.</p>"},{"location":"tools/disk/#bitscout","title":"Bitscout","text":"<p>Bitscout l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 x\u00e2y d\u1ef1ng Live OS c\u00f3 th\u1ec3 t\u00f9y ch\u1ec9nh \u0111\u01b0\u1ee3c vi\u1ebft b\u1eb1ng Bash. M\u1ee5c \u0111\u00edch ch\u00ednh c\u1ee7a c\u00f4ng c\u1ee5 l\u00e0 gi\u00fap c\u00e1c chuy\u00ean gia b\u1ea3o m\u1eadt nhanh ch\u00f3ng t\u1ea1o t\u1eadp tin \u1ea3nh h\u1ed7 tr\u1ee3 \u0111i\u1ec1u tra t\u1eeb xa c\u1ee7a ri\u00eang m\u00ecnh.  Bitscout l\u00e0 c\u00f4ng c\u1ee5 m\u00e3 ngu\u1ed3n m\u1edf v\u00e0 mi\u1ec5n ph\u00ed.</p> <p></p> <p>Trong h\u1ea7u h\u1ebft c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng m\u1ea1ng, ch\u1ee7 s\u1edf h\u1eefu h\u1ee3p ph\u00e1p c\u1ee7a c\u00e1c h\u1ec7 th\u1ed1ng b\u1ecb x\u00e2m nh\u1eadp l\u00e0 n\u1ea1n nh\u00e2n c\u1ee7a nh\u1eefng th\u1ee7 ph\u1ea1m kh\u00f4ng x\u00e1c \u0111\u1ecbnh. N\u1ea1n nh\u00e2n th\u01b0\u1eddng \u0111\u1ed3ng \u00fd h\u1ee3p t\u00e1c v\u00e0 gi\u00fap c\u00e1c nh\u00e0 nghi\u00ean c\u1ee9u b\u1ea3o m\u1eadt t\u00ecm ra c\u00e1ch th\u1ee9c l\u00e2y nhi\u1ec5m ho\u1eb7c c\u00e1c chi ti\u1ebft kh\u00e1c v\u1ec1 k\u1ebb t\u1ea5n c\u00f4ng. Tuy nhi\u00ean, c\u00e1c nh\u00e0 nghi\u00ean c\u1ee9u cho r\u1eb1ng vi\u1ec7c di chuy\u1ec3n kho\u1ea3ng c\u00e1ch xa \u0111\u1ec3 thu th\u1eadp c\u00e1c b\u1eb1ng ch\u1ee9ng quan tr\u1ecdng nh\u01b0 c\u00e1c m\u1eabu ph\u1ea7n m\u1ec1m \u0111\u1ed9c h\u1ea1i t\u1eeb c\u00e1c m\u00e1y t\u00ednh b\u1ecb nhi\u1ec5m c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn c\u00e1c cu\u1ed9c \u0111i\u1ec1u tra t\u1ed1n k\u00e9m v\u00e0 tr\u00ec tr\u1ec7. C\u00e0ng m\u1ea5t nhi\u1ec1u th\u1eddi gian \u0111\u1ec3 t\u00ecm hi\u1ec3u v\u1ec1 m\u1ed9t cu\u1ed9c t\u1ea5n c\u00f4ng th\u00ec c\u00e0ng m\u1ea5t nhi\u1ec1u th\u1eddi gian h\u01a1n tr\u01b0\u1edbc khi ng\u01b0\u1eddi d\u00f9ng \u0111\u01b0\u1ee3c b\u1ea3o v\u1ec7 v\u00e0 x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u1ee3c th\u1ee7 ph\u1ea1m. Tuy nhi\u00ean, c\u00e1c ph\u01b0\u01a1ng \u00e1n thay th\u1ebf \u0111\u1ec1u c\u1ea7n \u0111\u1ebfn c\u00e1c c\u00f4ng c\u1ee5 \u0111\u1eaft ti\u1ec1n v\u00e0 ki\u1ebfn th\u1ee9c v\u1ec1 c\u00e1ch v\u1eadn h\u00e0nh ch\u00fang ho\u1eb7c nguy c\u01a1 l\u00e2y nhi\u1ec5m hay l\u00e0m m\u1ea5t b\u1eb1ng ch\u1ee9ng b\u1eb1ng vi\u1ec7c di chuy\u1ec3n n\u00f3 gi\u1eefa c\u00e1c m\u00e1y t\u00ednh.</p> <p>\u0110\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\u00e0y, \u00f4ng Vitaly Kamluk, Gi\u00e1m \u0111\u1ed1c Nh\u00f3m Nghi\u00ean c\u1ee9u v\u00e0 Ph\u00e2n t\u00edch To\u00e0n c\u1ea7u c\u1ee7a Kaspersky Lab \u1edf Ch\u00e2u \u00c1 Th\u00e1i B\u00ecnh D\u01b0\u01a1ng (APAC) \u0111\u00e3 t\u1ea1o ra m\u1ed9t c\u00f4ng c\u1ee5 k\u0129 thu\u1eadt s\u1ed1 ngu\u1ed3n m\u1edf c\u00f3 th\u1ec3 thu th\u1eadp t\u1eeb xa c\u00e1c t\u00e0i li\u1ec7u ph\u00e1p y quan tr\u1ecdng, thu \u0111\u01b0\u1ee3c h\u00ecnh \u1ea3nh \u0111\u0129a to\u00e0n b\u1ed9 th\u00f4ng qua m\u1ea1ng ho\u1eb7c l\u01b0u tr\u1eef \u0111\u00ednh k\u00e8m c\u1ee5c b\u1ed9, ho\u1eb7c \u0111\u01a1n gi\u1ea3n l\u00e0 h\u1ed7 tr\u1ee3 t\u1eeb xa trong vi\u1ec7c x\u1eed l\u00ed s\u1ef1 c\u1ed1 ph\u1ea7n m\u1ec1m \u0111\u1ed9c h\u1ea1i. D\u1eef li\u1ec7u b\u1eb1ng ch\u1ee9ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c xem x\u00e9t v\u00e0 ph\u00e2n t\u00edch t\u1eeb xa ho\u1eb7c c\u1ee5c b\u1ed9 trong khi l\u01b0u tr\u1eef d\u1eef li\u1ec7u ngu\u1ed3n v\u1eabn c\u00f2n nguy\u00ean v\u1eb9n.</p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Bitscout <ol> <li>X\u00e2y d\u1ef1ng t\u1eadp tin ISO:</li> </ol> <p><pre><code>$ ./automake.sh\n</code></pre> Sau khi ch\u1ea1y l\u1ec7nh n\u00e0y, ta c\u1ea7n tr\u1ea3 l\u1eddi m\u1ed9t s\u1ed1 c\u00e2u h\u1ecfi nh\u01b0 v\u1ecb tr\u00ed c\u1ee7a m\u00e1y ch\u1ee7 VPN, lo\u1ea1i t\u1eadp tin, v.v. Ngo\u00e0i ra, ta c\u00f3 th\u1ec3 t\u1ea3i m\u1ed9t trong nh\u1eefng t\u1eadp tin ISO d\u1ef1ng s\u1eb5n (ch\u1ec9 d\u00e0nh cho vi\u1ec7c th\u1eed nghi\u1ec7m, kh\u00f4ng s\u1eed d\u1ee5ng trong m\u00f4i tr\u01b0\u1eddng th\u1ef1c t\u1ebf ): https://bitscout-forensics.info/quick-try/prebuilt-images 2. Ki\u1ec3m tra t\u1eadp tin ISO v\u1eeba t\u1ea1o:</p> <p><pre><code>$ ./autotest.sh\n</code></pre> L\u1ec7nh n\u00e0y s\u1ebd ch\u1ea1y th\u1eed nghi\u1ec7m \u0111\u1ed1i v\u1edbi t\u1eadp tin ISO m\u1edbi \u0111\u01b0\u1ee3c t\u1ea1o.  N\u00f3 ki\u1ec3m tra c\u1ee7a c\u00e1c th\u00e0nh ph\u1ea7n tr\u00ean t\u1eadp tin ISO v\u00e0 ch\u1ea1y n\u00f3 b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng qemu \u0111\u1ec3 ch\u1eafc ch\u1eafn r\u1eb1ng t\u1ea5t c\u1ea3 c\u00e1c d\u1ecbch v\u1ee5 thi\u1ebft y\u1ebfu \u0111ang ch\u1ea1y.</p>"},{"location":"tools/disk/#fex-imager","title":"FEX Imager","text":"<p>FEX Imager l\u00e0 c\u00f4ng c\u1ee5 thu th\u1eadp ho\u1eb7c b\u0103m t\u1eadp tin \u1ea3nh c\u1ee7a \u1ed5 \u0111\u0129a c\u1ea5p \u0111\u1ed9 bit v\u1edbi x\u00e1c th\u1ef1c h\u00e0m b\u0103m MD5, SHA1, SHA256. FEX Imager l\u00e0m vi\u1ec7c v\u1edbi \u1ed5 \u0111\u0129a v\u1eadt l\u00fd, \u1ed5 \u0111\u0129a logic, th\u01b0 m\u1ee5c v\u00e0 t\u1ec7p, thi\u1ebft b\u1ecb t\u1eeb xa (s\u1eed d\u1ee5ng servlet) ho\u1eb7c l\u1ea5y l\u1ea1i t\u1eadp tin \u1ea3nh. C\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p kh\u00f4ng n\u00e9n, n\u00e9n nhanh, t\u1ed1t ho\u1eb7c t\u1ed1t nh\u1ea5t v\u1edbi c\u00e1c t\u1eadp tin \u1ea3nh:</p> <ul> <li>DD/RAW</li> <li>E01</li> <li>L01</li> </ul> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a FEX Imager:</p> <ul> <li>T\u1ea1o \u1ea3nh t\u1eeb \u1ed5 \u0111\u0129a v\u1eadt l\u00fd, logic, th\u01b0 m\u1ee5c v\u00e0 t\u1eadp tin.</li> <li>L\u1ea5y l\u1ea1i c\u00e1c t\u1eadp tin \u1ea3nh hi\u1ec7n c\u00f3.</li> <li>H\u1ed7 tr\u1ee3 thu th\u1eadp t\u1eeb c\u00e1c thi\u1ebft b\u1ecb t\u1eeb xa b\u1eb1ng servlet GetData Forensics.</li> <li>Chuy\u1ec3n sang \u0111\u1ecbnh d\u1ea1ng .E01 ho\u1eb7c DD v\u1edbi h\u00e0m b\u0103m MD5, SHA1 ho\u1eb7c SHA256.</li> <li>Chuy\u1ec3n c\u00e1c th\u01b0 m\u1ee5c v\u00e0 t\u1ec7p sang \u0111\u1ecbnh d\u1ea1ng L01 v\u1edbi h\u00e0m b\u0103m t\u1ec7p MD5, SHA1 ho\u1eb7c SHA256.</li> <li>T\u1ef1 \u0111\u1ed9ng x\u00e1c minh h\u00e0m b\u0103m sau khi t\u1ea1o.</li> <li>Thu th\u1eadp to\u00e0n b\u1ed9 thi\u1ebft b\u1ecb ho\u1eb7c \u0111\u1eb7t v\u1ecb tr\u00ed sector b\u1eaft \u0111\u1ea7u v\u00e0 k\u1ebft th\u00fac.</li> <li>Chia t\u1eadp tin \u1ea3nh th\u00e0nh c\u00e1c \u0111o\u1ea1n t\u00f9y ch\u1ec9nh kh\u00f4ng gi\u1edbi h\u1ea1n k\u00edch th\u01b0\u1edbc.</li> <li>C\u00f3 th\u1ec3 \u0111i\u1ec1u ch\u1ec9nh sector size \u0111\u1ec3 thu th\u1eadp v\u1edbi 512, 2048 ho\u1eb7c 4096 sector size.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng FEX Imager <p>Ch\u1ecdn thi\u1ebft b\u1ecb ngu\u1ed3n:</p> <p></p> <p>Ch\u1ecdn \u0111\u1ecba ch\u1ec9 l\u01b0u t\u1eadp tin \u1ea3nh v\u00e0 nh\u1eadp th\u00f4ng tin:</p> <p></p> <p>Thu th\u1eadp v\u00e0 x\u00e1c minh:</p> <p></p>"},{"location":"tools/disk/#guymager","title":"Guymager","text":"<p>Guymager l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 t\u1ea1o t\u1eadp tin \u1ea3nh mi\u1ec5n ph\u00ed \u0111\u1ec3 thu th\u1eadp ch\u1ee9ng c\u1ee9.</p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a Guymager:</p> <ul> <li>Giao di\u1ec7n ng\u01b0\u1eddi d\u00f9ng d\u1ec5 s\u1eed d\u1ee5ng b\u1eb1ng nhi\u1ec1u ng\u00f4n ng\u1eef kh\u00e1c nhau</li> <li>Ch\u1ea1y tr\u00ean Linux</li> <li>Th\u1ef1c hi\u1ec7n nhanh v\u00e0 n\u00e9n d\u1eef li\u1ec7u \u0111a lu\u1ed3ng</li> <li>S\u1eed d\u1ee5ng t\u1ea5t c\u1ea3 t\u00e0i nguy\u00ean c\u1ee7a m\u00e1y t\u00ednh.</li> <li>T\u1ea1o t\u1eadp tin dd, EWF (E01) v\u00e0 AFF, h\u1ed7 tr\u1ee3 sao ch\u00e9p \u0111\u0129a</li> <li>Mi\u1ec5n ph\u00ed, m\u00e3 ngu\u1ed3n m\u1edf ho\u00e0n to\u00e0n</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Guymager <p> </p> <ul> <li>C\u00e1c thi\u1ebft b\u1ecb l\u01b0u tr\u1eef \u0111\u00e3 k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c li\u1ec7t k\u00ea \u1edf ph\u1ea7n tr\u00ean. C\u00e1c thi\u1ebft b\u1ecb m\u1edbi c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c k\u1ebft n\u1ed1i b\u1ea5t c\u1ee9 l\u00fac n\u00e0o - nh\u1ea5n n\u00fat Rescan \u0111\u1ec3 hi\u1ec3n th\u1ecb.</li> <li>C\u00e1c thi\u1ebft b\u1ecb \u0111\u01b0\u1ee3c \u0111\u00e1nh d\u1ea5u b\u1eb1ng m\u00e0u \u0111\u1ecf nh\u1ea1t l\u00e0 c\u00e1c \u0111\u0129a c\u1ee9ng c\u1ee5c b\u1ed9. Kh\u00f4ng th\u1ec3 t\u1ea1o \u1ea3nh t\u1eeb c\u00e1c \u1ed5 \u0111\u0129a n\u00e0y \u0111\u1ec3 ng\u0103n ch\u1eb7n vi\u1ec7c ch\u1ecdn nh\u1ea7m \u1ed5 \u0111\u0129a. \u0110\u0129a c\u1ee9ng c\u1ee5c b\u1ed9 \u0111\u01b0\u1ee3c nh\u1eadn d\u1ea1ng b\u1eb1ng s\u1ed1 s\u00ea-ri c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c c\u1ea5u h\u00ecnh.</li> <li>Ph\u1ea7n b\u00ean d\u01b0\u1edbi hi\u1ec3n th\u1ecb th\u00f4ng tin chi ti\u1ebft h\u01a1n v\u1ec1 vi\u1ec7c thu th\u1eadp hi\u1ec7n \u0111\u01b0\u1ee3c ch\u1ecdn.</li> </ul> <p></p>"},{"location":"tools/hunt/","title":"C\u00f4ng c\u1ee5 s\u0103n t\u00ecm m\u1ed1i \u0111e do\u1ea1","text":""},{"location":"tools/hunt/#thor-lite","title":"THOR Lite","text":"<p>THOR Lite l\u00e0 m\u1ed9t IOC v\u00e0 YARA scanner \u0111a n\u1ec1n t\u1ea3ng. THOR Lite l\u00e0 phi\u00ean b\u1ea3n mi\u1ec5n ph\u00ed c\u1ee7a THOR.</p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a THOR Lite:</p> <ul> <li>Scanner d\u00f9ng cho Windows, Linux and macOS</li> <li>B\u1ed9 lu\u1eadt m\u00e3 ngu\u1ed3n m\u1edf \u0111\u01b0\u1ee3c bi\u00ean d\u1ecbch v\u00e0 m\u00e3 ho\u00e1</li> <li>C\u00f4ng c\u1ee5 c\u1eadp nh\u1eadt \u0111\u1ec3 t\u1ea3i xu\u1ed1ng phi\u00ean b\u1ea3n m\u1edbi nh\u1ea5t</li> <li>Qu\u00e9t v\u1edbi lu\u1eadt v\u00e0 IOC t\u1ef1 vi\u1ebft</li> <li>Nhi\u1ec1u lo\u1ea1i k\u1ebft qu\u1ea3 scan: t\u1eadp tin txt, SYSLOG (udp/tcp/tcp+tls), t\u1eadp tin JSON, JSON th\u00f4ng qua Syslog</li> <li>H\u1ea1n ch\u1ebf s\u1eed d\u1ee5ng CPU, kh\u00f4ng g\u00e2y ngh\u1ebdn h\u1ec7 th\u1ed1ng</li> </ul> <p></p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng THOR Lite <ul> <li>https://www.nextron-systems.com/thor-lite/</li> <li>https://www.nextron-systems.com/download-thor-lite/</li> <li>\u0110\u0103ng k\u00fd v\u1edbi email \u0111\u1ec3 t\u1ea3i xu\u1ed1ng THOR Lite v\u00e0 license.</li> <li>Gi\u1ea3i n\u00e9n th\u01b0 m\u1ee5c, di chuy\u1ec3n n\u00f3 t\u1edbi v\u1ecb tr\u00ed c\u1ea7n thi\u1ebft.</li> <li>Di chuy\u1ec3n license v\u00e0o th\u01b0 m\u1ee5c thor10lite-win-pack.</li> <li>Kh\u1edfi \u0111\u1ed9ng THOR b\u1eb1ng ch\u01b0\u01a1ng tr\u00ecnh thor64-lite.exe v\u00e0 thor-lite.exe</li> </ul> <p></p>"},{"location":"tools/hunt/#autoruns","title":"Autoruns","text":"<p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p> <p>Autoruns l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n b\u1edfi Microsoft Sysinternals cho ph\u00e9p xem, qu\u1ea3n l\u00fd ch\u01b0\u01a1ng tr\u00ecnh kh\u1edfi \u0111\u1ed9ng c\u00f9ng Windows. Autoruns l\u00e0 d\u1ea1ng ph\u1ea7n m\u1ec1m lo\u1ea1i portable n\u00ean ng\u01b0\u1eddi s\u1eed d\u1ee5ng kh\u00f4ng c\u1ea7n c\u00e0i \u0111\u1eb7t m\u00e0 c\u00f3 th\u1ec3 ch\u1ea1y v\u00e0 s\u1eed d\u1ee5ng ngay l\u1eadp t\u1ee9c. Autoruns hi\u1ec7n c\u00f3 hai phi\u00ean b\u1ea3n v\u1edbi ch\u1ee9c n\u0103ng t\u01b0\u01a1ng \u0111\u01b0\u01a1ng: Autoruns GUI v\u00e0 Autoruns command-line. Autoruns ho\u1ea1t \u0111\u1ed9ng v\u1edbi Windows XP tr\u1edf l\u00ean.</p> <p></p> <p>Giao di\u1ec7n Autoruns GUI.</p> <p></p> <p>Giao di\u1ec7n Autoruns command-line.</p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Autoruns <p>C\u00e1c t\u00ednh n\u0103ng n\u1ed5i b\u1eadt m\u00e0 Autoruns cung c\u1ea5p:</p> <ul> <li>Hi\u1ec3n th\u1ecb danh s\u00e1ch t\u1ea5t c\u1ea3 c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh t\u1ef1 \u0111\u1ed9ng ch\u1ea1y khi kh\u1edfi \u0111\u1ed9ng Windows theo d\u1ea1ng c\u00e1c m\u1ee5c nh\u01b0 Logon, Explorer, Internet Explorer, Appinit DLLs, Image Hijacks, Winlogon, Windows Service, Winsock Providers, Boot Execute,....</li> </ul> <p></p> <ul> <li>T\u00ecm ki\u1ebfm tr\u1ef1c ti\u1ebfp trong registry v\u00e0 c\u00e1c t\u1eadp tin kh\u1edfi \u0111\u1ed9ng c\u1ee7a Windows \u0111\u1ec3 t\u00ecm ki\u1ebfm c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh t\u1ef1 \u0111\u1ed9ng ch\u1ea1y v\u00e0 cung c\u1ea5p cho ng\u01b0\u1eddi d\u00f9ng m\u1ed9t danh s\u00e1ch chi ti\u1ebft c\u1ee7a ch\u00fang.</li> </ul> <p></p> <ul> <li>M\u1ee5c Options mang t\u1edbi 1 s\u1ed1 l\u1ef1a ch\u1ecdn l\u1ecdc, ch\u1eb3ng h\u1ea1n nh\u01b0 ch\u1ec9 hi\u1ec3n th\u1ecb c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh non-Windows, c\u0169ng nh\u01b0 truy c\u1eadp v\u00e0o h\u1ed9p tho\u1ea1i scan. T\u1eeb \u0111\u00e2y ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 k\u00edch ho\u1ea1t ch\u1ebf \u0111\u1ed9 x\u00e1c minh ch\u1eef k\u00ed hay th\u1ef1c hi\u1ec7n ki\u1ec3m tra v\u1edbi Virus Total.</li> </ul> <p></p> <p></p> <p>-Ng\u01b0\u1eddi s\u1eed d\u1ee5ng c\u00f3 th\u1ec3 click chu\u1ed9t ph\u1ea3i v\u00e0o m\u1ed9t ch\u01b0\u01a1ng tr\u00ecnh r\u1ed3i ch\u1ecdn Propeties trong menu hi\u1ec7n ra \u0111\u1ec3 xem th\u00eam th\u00f4ng tin v\u1ec1 ch\u01b0\u01a1ng tr\u00ecnh. \u0110\u1ec3 v\u00f4 hi\u1ec7u h\u00f3a 1 ch\u01b0\u01a1ng tr\u00ecnh trong danh s\u00e1ch, ch\u1ec9 c\u1ea7n b\u1ecf ch\u1ecdn n\u00f3 trong \u00f4 \u0111\u00e1nh d\u1ea5u. N\u1ebfu mu\u1ed1n x\u00f3a ch\u00fang kh\u1ecfi danh s\u00e1ch, ng\u01b0\u1eddi s\u1eed d\u1ee5ng c\u00f3 th\u1ec3 ch\u1ecdn Delete trong h\u1ed9p tho\u1ea1i hi\u1ec7n ra khi d\u00f9ng chu\u1ed9t ph\u1ea3i.</p> <p></p> <p>Autoruns cung c\u1ea5p c\u00e1c c\u00e1ch ti\u1ec7n l\u1ee3i v\u00e0 an to\u00e0n \u0111\u1ec3 qu\u1ea3n l\u00fd c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh t\u1ef1 \u0111\u1ed9ng ch\u1ea1y tr\u00ean Windows, gi\u00fap ng\u01b0\u1eddi d\u00f9ng t\u1ed1i \u01b0u h\u00f3a hi\u1ec7u su\u1ea5t h\u1ec7 th\u1ed1ng v\u00e0 b\u1ea3o v\u1ec7 m\u00e1y t\u00ednh kh\u1ecfi c\u00e1c ch\u01b0\u01a1ng tr\u00ecnh \u0111\u1ed9c h\u1ea1i.</p>"},{"location":"tools/hunt/#process-monitor","title":"Process Monitor","text":"<p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p> <p>Process Monitor l\u00e0 m\u1ed9t ti\u1ec7n \u00edch h\u1ed7 tr\u1ee3 gi\u00e1m s\u00e1t ti\u1ebfn tr\u00ecnh thu\u1ed9c b\u1ed9 c\u00f4ng c\u1ee5 SysInternals \u0111\u01b0\u1ee3c Microsoft ph\u00e2n ph\u1ed1i mi\u1ec5n ph\u00ed. Process Monitor \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng nh\u1eb1m gi\u00e1m s\u00e1t c\u00e1c ti\u1ebfn tr\u00ecnh \u0111ang ho\u1ea1t \u0111\u1ed9ng, kho\u00e1 registry v\u00e0 lu\u1ed3ng l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng g\u1eedi/nh\u1eadn t\u1eeb h\u1ec7 th\u1ed1ng. Ngo\u00e0i ra, Process Monitor c\u00f2n cho ph\u00e9p ng\u01b0\u1eddi d\u00f9ng l\u01b0u l\u1ea1i c\u00e1c event d\u01b0\u1edbi d\u1ea1ng PML (Process Monitor Log), t\u1eeb \u0111\u00f3 cho ph\u00e9p \u0111i\u1ec1u tra vi\u00ean l\u01b0u tr\u1eef, b\u1ea3o qu\u1ea3n nh\u1eb1m ph\u1ee5c v\u1ee5 cho c\u00e1c kh\u00e2u ph\u00e2n t\u00edch chuy\u00ean s\u00e2u.</p> <p></p> <p>C\u00e1c t\u00ednh n\u0103ng n\u1ed5i b\u1eadt m\u00e0 Process Monitor cung c\u1ea5p:</p> <ul> <li>Gi\u00e1m s\u00e1t ti\u1ebfn tr\u00ecnh h\u1ec7 th\u1ed1ng theo th\u1eddi gian th\u1ef1c.</li> <li>T\u01b0\u01a1ng th\u00edch v\u1edbi c\u00e1c h\u1ec7 \u0111i\u1ec1u h\u00e0nh ph\u1ed5 bi\u1ebfn nh\u01b0 Windows v\u00e0 Linux.</li> <li>Kh\u1ea3 n\u0103ng ghi nh\u1eadn event m\u1ea1nh m\u1ebd, l\u00ean \u0111\u1ebfn ~10 tri\u1ec7u event m\u1ed7i b\u1ea3n ghi log.</li> <li>H\u1ed7 tr\u1ee3 thu th\u1eadp Boot log.</li> <li>Cung c\u1ea5p \u0111\u1ea7y \u0111\u1ee7 c\u00e1c t\u00ednh n\u0103ng nh\u01b0 xem Process Tree, ki\u1ec3m tra c\u00e1c module \u0111\u01b0\u1ee3c ti\u1ebfn tr\u00ecnh s\u1eed d\u1ee5ng hay ki\u1ec3m tra stack c\u1ee7a c\u00e1c ti\u1ebfn tr\u00ecnh.</li> <li>Cung c\u1ea5p c\u00e1c b\u1ed9 l\u1ecdc theo th\u1eddi gian th\u1ef1c m\u00e0 kh\u00f4ng l\u00e0m m\u1ea5t d\u1eef li\u1ec7u.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Process Monitor <p>Sau khi t\u1ea3i b\u1ea3n n\u00e9n t\u1eeb trang ch\u1ee7 c\u1ee7a SysInternals, ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 ch\u1ecdn file th\u1ef1c thi Process Monitor ph\u00f9 h\u1ee3p v\u1edbi h\u1ec7 th\u1ed1ng c\u1ee7a m\u00ecnh \u0111\u1ec3 kh\u1edfi ch\u1ea1y.</p> <p></p> <p>Ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 tu\u1ef3 ch\u1ecdn c\u00e1c c\u1ed9t d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c hi\u1ec7n th\u1ecb b\u1eb1ng c\u00e1ch b\u1ea5m chu\u1ed9t ph\u1ea3i v\u00e0o c\u1ed9t b\u1ea5t k\u00ec, ch\u1ecdn Select Columns nh\u1eb1m th\u00eam b\u1edbt c\u00e1c th\u00f4ng tin c\u1ea7n thi\u1ebft.</p> <p></p> <p>\u0110\u1ec3 xem c\u00e1c ti\u1ebfn tr\u00ecnh d\u01b0\u1edbi d\u1ea1ng c\u00e2y, ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng t\u1ed5 h\u1ee3p ph\u00edm Ctrl + T. C\u00e1c th\u00f4ng tin nh\u01b0 Command line, th\u1eddi gian b\u1eaft \u0111\u1ea7u/k\u1ebft th\u00fac, \u0111\u01b0\u1eddng d\u1eabn,\u2026 s\u1ebd \u0111\u01b0\u1ee3c hi\u1ec3n th\u1ecb t\u01b0\u01a1ng \u1ee9ng.</p> <p></p> <p>Nh\u1eb1m qu\u1ea3n l\u00fd qu\u00e1 tr\u00ecnh ghi log v\u1ec1 c\u00e1c ti\u1ebfn tr\u00ecnh, ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng t\u1ed5 h\u1ee3p ph\u00edm Ctrl + E nh\u1eb1m b\u1eadt/t\u1eaft qu\u00e1 tr\u00ecnh ghi ch\u00e9p. M\u1eb7c \u0111\u1ecbnh khi kh\u1edfi \u0111\u1ed9ng, Process Monitor s\u1ebd k\u00edch ho\u1ea1t ch\u1ebf \u0111\u1ed9 ghi. Tham s\u1ed1 \u1edf g\u00f3c d\u01b0\u1edbi c\u00f9ng b\u00ean tr\u00e1i s\u1ebd cho bi\u1ebft s\u1ed1 b\u1ea3n ghi \u0111\u00e3 \u0111\u01b0\u1ee3c ghi l\u1ea1i.</p> <p></p> <p>Khi thu th\u1eadp \u0111\u1ee7 th\u00f4ng tin, ng\u01b0\u1eddi d\u00f9ng b\u1ea5m t\u1ed5 h\u1ee3p ph\u00edm Ctrl + S nh\u1eb1m l\u01b0u l\u1ea1i file log tr\u00ean. C\u00e1c \u0111\u1ecbnh d\u1ea1ng ph\u1ed5 bi\u1ebfn cho file log t\u1eeb Process Monitor l\u00e0 .pml, .csv v\u00e0 .xml.</p> <p></p>"},{"location":"tools/hunt/#fastfinder","title":"Fastfinder","text":"<p>FastFinder l\u00e0 c\u00f4ng c\u1ee5 \u0111\u01b0\u1ee3c t\u1ea1o ra \u0111\u1ec3 t\u00ecm ki\u1ebfm m\u1ed1i \u0111e d\u1ecda (threat hunting), forensics tr\u1ef1c ti\u1ebfp tr\u00ean n\u1ec1n t\u1ea3ng Windows v\u00e0 Linux. N\u00f3 t\u1eadp trung v\u00e0o li\u1ec7t k\u00ea endpoint v\u00e0 t\u00ecm t\u1eadp tin \u0111\u00e1ng ng\u1edd d\u1ef1a tr\u00ean c\u00e1c ti\u00eau ch\u00ed kh\u00e1c nhau.</p> <p></p> <p>Nh\u1eefng ch\u1ee9c n\u0103ng ch\u00ednh c\u1ee7a Fastfinder:</p> <ul> <li>file path / name</li> <li>md5 / sha1 / sha256 checksum</li> <li>Chu\u1ed7i \u0111\u01a1n gi\u1ea3n</li> <li>\u0110i\u1ec1u ki\u1ec7n d\u1ef1a tr\u00ean YARA rule</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Fastfinder <p>T\u1ea3i file th\u1ef1c thi c\u1ee7a c\u00f4ng c\u1ee5 t\u1ea1i \u0111\u00e2y, sau \u0111\u00f3 ch\u1ea1y ch\u01b0\u01a1ng tr\u00ecnh qua CLI b\u1eb1ng quy\u1ec1n user ho\u1eb7c admin</p> <pre><code>___       __  ___  ___         __   ___  __\n|__   /\\  /__`  |  |__  | |\\ | |  \\ |__  |__)\n|    /~~\\ .__/  |  |    | | \\| |__/ |___ |  \\\n2021-2022 | Jean-Pierre GARNIER | @codeyourweb\nhttps://github.com/codeyourweb/fastfinder      usage: fastfinder [-h|--help] [-c|--configuration \"&lt;value&gt;\"] [-b|--build\n\"&lt;value&gt;\"] [-o|--output \"&lt;value&gt;\"] [-n|--no-window]\n[-u|--no-userinterface] [-v|--verbosity &lt;integer&gt;]\n[-t|--triage]\nIncident Response - Fast suspicious file finder\nArguments:\n-h  --help              Print help information\n-c  --configuration     Fastfind configuration file. Default:\n-b  --build             Output a standalone package with configuration and\nrules in a single binary\n-o  --output            Save fastfinder logs in the specified file\n-n  --no-window         Hide fastfinder window\n-u  --no-userinterface  Hide advanced user interface\n-v  --verbosity         File log verbosity\n| 4: Only alert\n| 3: Alert and errors\n| 2: Alerts,errors and I/O operations\n| 1: Full verbosity)\n. Default: 3\n-t  --triage            Triage mode (infinite run - scan every new file in\nthe input path directories). Default: false\n</code></pre>"},{"location":"tools/hunt/#fenrir","title":"Fenrir","text":"<p>Fenrir l\u00e0 m\u1ed9t bash script v\u1edbi vai tr\u00f2 l\u00e0 IOC Scanner \u0111\u01a1n gi\u1ea3n. N\u00f3 cho ph\u00e9p qu\u00e9t c\u00e1c h\u1ec7 th\u1ed1ng Linux/Unix/OSX \u0111\u1ec3 t\u00ecm c\u00e1c Indicators of Compromise (IOC).</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a Fenrir:</p> <ul> <li>Bash Script</li> <li>Kh\u00f4ng c\u1ea7n c\u00e0i \u0111\u1eb7t agent ho\u1eb7c ph\u1ea7n m\u1ec1m</li> <li>S\u1eed d\u1ee5ng c\u00f4ng c\u1ee5 ph\u1ed5 bi\u1ebfn \u0111\u1ec3 tr\u00edch xu\u1ea5t c\u00e1c n\u1ed9i dung thu\u1ed9c t\u00ednh (v\u00ed d\u1ee5 md5sum, grep, stat \u1edf nhi\u1ec1u ch\u1ebf \u0111\u1ed9 kh\u00e1c nhau)</li> <li>C\u00f3 th\u1ec3 ch\u1ea1y tr\u00ean m\u1ecdi Linux / Unix / OS X v\u1edbi Bash</li> <li>S\u1eed d\u1ee5ng \u00edt t\u00e0i nguy\u00ean</li> <li>Lo\u1ea1i tr\u1eeb th\u00f4ng minh (k\u00edch c\u1ee1 file, extension, c\u00e1c th\u01b0 m\u1ee5c lo\u1ea1i tr\u1eeb) t\u0103ng t\u1ed1c qu\u00e1 tr\u00ecnh qu\u00e9t</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Fenrir <pre><code>./fenrir.sh \"\u0110\u1ecaA CH\u1ec8 TH\u01af M\u1ee4C\"\n</code></pre> <p>T\u1ea5t c\u1ea3 c\u00e1c c\u00e0i \u0111\u1eb7t c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh \u0111i\u1ec1u ch\u1ec9nh trong header c\u1ee7a script.</p> <p></p>"},{"location":"tools/hunt/#loki","title":"Loki","text":"<p>Fenrir l\u00e0 m\u1ed9t IOC Scanner \u0111\u01a1n gi\u1ea3n d\u1ef1a tr\u00ean 4 nguy\u00ean t\u1eafc: t\u00ean t\u1eadp tin, yara rule, ki\u1ec3m tra hash, ki\u1ec3m tra k\u1ebft n\u1ed1i \u0111\u1ebfn C2 Server.</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng kh\u00e1c c\u1ee7a Loki: * Ki\u1ec3m tra t\u00ednh nguy\u00ean v\u1eb9n c\u1ee7a h\u1ec7 th\u1ed1ng (th\u00f4ng qua --reginfs) * Ki\u1ec3m tra ti\u1ebfn tr\u00ecnh b\u1ea5t th\u01b0\u1eddng (d\u1ef1a tr\u00ean Sysforensics) * Gi\u1ea3i n\u00e9n v\u00e0 qu\u00e9t SWF * Ki\u1ec3m tra SAM dump</p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Loki <ul> <li>T\u1ea3i xu\u1ed1ng phi\u00ean b\u1ea3n m\u1edbi nh\u1ea5t c\u1ee7a LOKI t\u1ea1i releases</li> <li>Gi\u1ea3i n\u00e9n b\u1ed9 c\u00f4ng c\u1ee5</li> <li>Ch\u1ea1y loki-upgrader.exe tr\u00ean h\u1ec7 th\u1ed1ng c\u00f3 k\u1ebft n\u1ed1i internet \u0111\u1ec3 c\u1eadp nh\u1eadt c\u00e1c \u0111\u1eb7c tr\u01b0ng m\u1edbi nh\u1ea5t </li> <li>Di chuy\u1ec3n b\u1ed9 c\u00f4ng c\u1ee5 t\u1edbi h\u1ec7 th\u1ed1ng m\u1ee5c ti\u00eau c\u1ea7n qu\u00e9t: USB, \u1ed5 c\u1ee9ng di \u0111\u1ed9ng, network share, copy th\u01b0 m\u1ee5c t\u1edbi m\u00e1y m\u1ee5c ti\u00eau,...</li> <li>M\u1edf c\u1eeda s\u1ed1 \"cmd.exe\" v\u1edbi quy\u1ec1n Administrator v\u00e0 ch\u1ea1y LOKI t\u1eeb \u0111\u00f3 (Ta c\u00f3 th\u1ec3 ch\u1ea1y LOKI m\u00e0 kh\u00f4ng c\u1ea7n quy\u1ec1n Administrator nh\u01b0ng m\u1ed9t s\u1ed1 ki\u1ec3m tra s\u1ebd b\u1ecb t\u1eaft v\u00e0 m\u1ed9t s\u1ed1 m\u1ee5c ti\u00eau qu\u00e9t s\u1ebd kh\u00f4ng th\u1ec3 truy c\u1eadp \u0111\u01b0\u1ee3c)</li> </ul> <pre><code>usage: loki.py [-h] [-p path] [-s kilobyte] [-l log-file] [-r remote-loghost]\n[-t remote-syslog-port] [-a alert-level] [-w warning-level]\n[-n notice-level] [--allhds] [--alldrives] [--printall]\n[--allreasons] [--noprocscan] [--nofilescan] [--vulnchecks]\n[--nolevcheck] [--scriptanalysis] [--rootkit] [--noindicator]\n[--dontwait] [--intense] [--csv] [--onlyrelevant] [--nolog]\n[--update] [--debug] [--maxworkingset MAXWORKINGSET]\n[--syslogtcp] [--logfolder log-folder] [--nopesieve]\n[--pesieveshellc] [--nolisten]\n[--excludeprocess EXCLUDEPROCESS] [--force]\nLoki - Simple IOC Scanner\noptional arguments:\n-h, --help            show this help message and exit\n-p path               Path to scan\n-s kilobyte           Maximum file size to check in KB (default 5000 KB)\n-l log-file           Log file\n-r remote-loghost     Remote syslog system\n-t remote-syslog-port\nRemote syslog port\n-a alert-level        Alert score\n-w warning-level      Warning score\n-n notice-level       Notice score\n--allhds              Scan all local hard drives (Windows only)\n--alldrives           Scan all drives (including network drives and\nremovable media)\n--printall            Print all files that are scanned\n--allreasons          Print all reasons that caused the score\n--noprocscan          Skip the process scan\n--nofilescan          Skip the file scan\n--vulnchecks          Run the vulnerability checks\n--nolevcheck          Skip the Levenshtein distance check\n--scriptanalysis      Statistical analysis for scripts to detect obfuscated\ncode (beta)\n--rootkit             Skip the rootkit check\n--noindicator         Do not show a progress indicator\n--dontwait            Do not wait on exit\n--intense             Intense scan mode (also scan unknown file types and\nall extensions)\n--csv                 Write CSV log format to STDOUT (machine processing)\n--onlyrelevant        Only print warnings or alerts\n--nolog               Don't write a local log file\n--update              Update the signatures from the \"signature-base\" sub\n                      repository\n--debug               Debug output\n--maxworkingset MAXWORKINGSET\n                      Maximum working set size of processes to scan (in MB,\n                      default 100 MB)\n--syslogtcp           Use TCP instead of UDP for syslog logging\n--logfolder log-folder\n                      Folder to use for logging when log file is not\n                      specified\n--nopesieve           Do not perform pe-sieve scans\n--pesieveshellc       Perform pe-sieve shellcode scan\n--nolisten            Dot not show listening connections\n--excludeprocess EXCLUDEPROCESS\n                      Specify an executable name to exclude from scans, can\n                      be used multiple times\n--force               Force the scan on a certain folder (even if excluded\n                      with hard exclude in LOKI's code\n</code></pre>"},{"location":"tools/hunt/#recon","title":"recon","text":"<p>recon l\u00e0 c\u00f4ng c\u1ee5 index metadata \u0111a ch\u1ee9c n\u0103ng t\u1eadp trung v\u00e0o lo\u1ea1i n\u1ed9i dung.</p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 d\u00f9ng recon nh\u01b0: * <code>find</code> v\u1edbi kh\u1ea3 n\u0103ng s\u1eed d\u1ee5ng c\u00e1c query ph\u1ee9c t\u1ea1p c\u1ee7a SQL * C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra s\u1ed1: T\u00ecm ki\u1ebfm c\u00e1c t\u1eadp tin kh\u1edbp v\u1edbi \u0111i\u1ec1u ki\u1ec7n t\u1eeb \u0111\u01a1n gi\u1ea3n \u0111\u1ebfn ph\u1ee9c t\u1ea1p tr\u00ean m\u00e1y m\u1ee5c ti\u00eau * C\u00f4ng c\u1ee5 ph\u00e1t hi\u1ec7n v\u00e0 thu th\u1eadp nh\u1eefng ph\u1ea7n m\u1ec1m ho\u1eb7c n\u1ed9i dung \u0111\u1ed9c h\u1ea1i</p> <p><code>$ DATABASE_URL=sqlite::memory: recon &lt;..args..&gt;</code></p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng recon <p>T\u1ea1o m\u1ed9t t\u1eadp tin c\u1ea5u h\u00ecnh ch\u1ee9a c\u00e1 th\u00f4ng tin c\u1ea7n t\u00ecm ki\u1ebfm:</p> <pre><code># ...\ncomputed_fields:\nbyte_type: true\nis_binary: true\nfile_magic: true\n# crc32: true\nsha256: true\nsha512: true\nsimhash: true\n</code></pre> <p>Ch\u1ec9 t\u00ecm t\u1eadp tin binary:</p> <pre><code>recon -c config.yaml -q 'select path from files where is_binary = 1'\n</code></pre> <p>T\u1ea1o danh s\u00e1ch ch\u1ee9a c\u00e1c th\u00f4ng tin c\u1ee7a t\u1eadp tin</p> <pre><code>recon -c config.yaml -q 'select path,sha256,sha512 from files'\n</code></pre> <p>Xu\u1ea5t m\u1ecdi th\u1ee9</p> <pre><code>recon -c config.yaml -q 'select * from files' --csv\n</code></pre>"},{"location":"tools/log/","title":"C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra nh\u1eadt k\u00fd s\u1ef1 ki\u1ec7n","text":""},{"location":"tools/log/#hayabusa","title":"Hayabusa","text":"<p>Hayabusa l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 x\u1eed l\u00fd nhanh Windows Event Log, t\u1ea1o timeline v\u00e0 t\u00ecm ki\u1ebfm m\u1ed1i \u0111e d\u1ecda do Yamato Security \u1edf Nh\u1eadt B\u1ea3n ph\u00e1t tri\u1ec3n. N\u00f3 \u0111\u01b0\u1ee3c vi\u1ebft b\u1eb1ng Rust v\u00e0 h\u1ed7 tr\u1ee3 x\u1eed l\u00fd \u0111a lu\u1ed3ng. Hayabusa c\u00f3 th\u1ec3 ch\u1ea1y tr\u00ean c\u00e1c h\u1ec7 th\u1ed1ng \u0111ang ho\u1ea1t \u0111\u1ed9ng \u0111\u1ec3 ph\u00e2n t\u00edch tr\u1ef1c ti\u1ebfp, b\u1eb1ng c\u00e1ch thu th\u1eadp Event Logs t\u1eeb m\u1ed9t ho\u1eb7c nhi\u1ec1u h\u1ec7 th\u1ed1ng \u0111\u1ec3 ph\u00e2n t\u00edch ngo\u1ea1i tuy\u1ebfn ho\u1eb7c b\u1eb1ng c\u00e1ch ch\u1ea1y c\u00f4ng c\u1ee5 Hayabusa v\u1edbi Velociraptor \u0111\u1ec3 t\u00ecm ki\u1ebfm m\u1ed1i \u0111e d\u1ecda v\u00e0 \u1ee9ng ph\u00f3 s\u1ef1 c\u1ed1 tr\u00ean quy m\u00f4 l\u1edbn. B\u00e1o c\u00e1o l\u00e0 m\u1ed9t timeline tr\u00ean CSV \u0111\u1ec3 d\u1ec5 d\u00e0ng ph\u00e2n t\u00edch trong Excel, Timeline Explorer, Elastic Stack, Timesketch, v.v...</p> <p></p> <p>Nh\u1eefng ch\u1ee9c n\u0103ng ch\u00ednh c\u1ee7a Hayabusa:</p> <ul> <li>S\u0103n l\u00f9ng m\u1ed1i \u0111e do\u1ea1 tr\u00ean quy m\u00f4 doanh nghi\u1ec7p tr\u00ean nhi\u1ec1u n\u1ec1n t\u1ea3ng: Windows, Linux, MacOS,...</li> <li>T\u1ea1o timeline d\u1ef1a tr\u00ean Windows Event Logs, h\u1ed7 tr\u1ee3 chuy\u1ec3n \u0111\u1ed5i Sigma rules th\u00e0nh Hayabusa rules.</li> <li>\u0110\u00e1nh gi\u00e1, ph\u00e2n t\u00edch c\u00e1c k\u1ef9 thu\u1eadt t\u1ea5n c\u00f4ng v\u1edbi MITRE ATT&amp;CK Framework.</li> <li>Ph\u00e2n t\u00edch tr\u00ean Timeline Explorer, Elastic Stack, Excel,...</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Hayabusa <p>T\u1ea3i xu\u1ed1ng phi\u00ean b\u1ea3n m\u1edbi nh\u1ea5t c\u1ee7a Hayabusa t\u1ea1i \u0111\u00e2y.</p> <p>M\u1edf c\u1eeda s\u1ed5 CMD/Powershell ho\u1eb7c Windows Terminal, sau \u0111\u00f3 ch\u1ea1y t\u1eadp tin th\u1ef1c thi.</p> <p>C\u00e1c option ch\u00ednh c\u1ee7a Hayabusa:</p> <pre><code>csv-timeline: L\u01b0u timeline \u1edf \u0111\u1ecbnh d\u1ea1ng CSV.\njson-timeline: L\u01b0u timeline \u1edf \u0111\u1ecbnh d\u1ea1ng JSON/JSONL.\nlogon-summary: Xu\u1ea5t ra b\u00e1o c\u00e1o t\u1ed5ng h\u1ee3p v\u1ec1 c\u00e1c l\u1ea7n logon tr\u00ean h\u1ec7 th\u1ed1ng.\nmetrics: Xu\u1ea5t ra c\u00e1c ch\u1ec9 s\u1ed1 v\u00e0 t\u1ec9 l\u1ec7 c\u00e1c s\u1ef1 ki\u1ec7n d\u1ef1a tr\u00ean Event ID.\npivot-keywords-list: Xu\u1ea5t ra c\u00e1c t\u1eeb kho\u00e1 nghi v\u1ea5n c\u1ea7n \u0111i\u1ec1u tra\nupdate-rules: C\u1eadp nh\u1eadt t\u1eadp lu\u1eadt t\u1eeb Github.\nlevel-tuning: Ch\u1ec9nh s\u1eeda m\u1ee9c \u0111\u1ed9 c\u1ea3nh b\u00e1o.\nlist-profiles: Hi\u1ec3n th\u1ecb c\u00e1c output profiles c\u00f3 s\u1eb5n.\nset-default-profile: Ch\u1ec9nh s\u1eeda profile m\u1eb7c \u0111\u1ecbnh.\n</code></pre> <pre><code>Usage:\nhayabusa.exe help &lt;COMMAND&gt;\nhayabusa.exe &lt;COMMAND&gt; [OPTIONS]\nCommands:\ncsv-timeline         Save the timeline in CSV format\njson-timeline        Save the timeline in JSON/JSONL format\nlogon-summary        Print a summary of successful and failed logons\nmetrics              Print event ID metrics\npivot-keywords-list  Create a list of pivot keywords\nupdate-rules         Update to the latest rules in the hayabusa-rules github repository\nlevel-tuning         Tune alert levels (default: ./rules/config/level_tuning.txt)\nset-default-profile  Set default output profile\nlist-contributors    Print the list of contributors\nlist-profiles        List the output profiles\nhelp                 Print this message or the help of the given subcommand(s)\nOptions:\n--no-color  Disable color output\n-q, --quiet     Quiet mode: do not display the launch banner\n</code></pre> <p>Kh\u1edfi \u0111\u1ed9ng ph\u1ea7n m\u1ec1m:</p> <p></p> <p>T\u1ed5ng k\u1ebft sau khi ch\u1ea1y c\u00f4ng c\u1ee5:</p> <p></p> <p>B\u00e1o c\u00e1o HTML \u0111\u01b0\u1ee3c xu\u1ea5t ra:</p> <p></p> <p></p> <p></p> <p>Ph\u00e2n t\u00edch v\u1edbi c\u00e1c c\u00f4ng c\u1ee5:</p> <p></p> <p></p> <p></p>"},{"location":"tools/log/#apt-hunter","title":"APT-Hunter","text":"<p>APT-Hunter l\u00e0 c\u00f4ng c\u1ee5 Threat Hunting d\u1ef1a tr\u00ean Event Log c\u1ee7a windows \u0111\u01b0\u1ee3c t\u1ea1o v\u1edbi mindset c\u1ee7a purple team \u0111\u1ec3 cung c\u1ea5p kh\u1ea3 n\u0103ng ph\u00e1t hi\u1ec7n c\u00e1c t\u1ea5n c\u00f4ng APT \u1ea9n trong r\u1ea5t nhi\u1ec1u windows event logs \u0111\u1ec3 gi\u1ea3m th\u1eddi gian ph\u00e1t hi\u1ec7n ho\u1ea1t \u0111\u1ed9ng \u0111\u00e1ng ng\u1edd.</p> <p>C\u00f4ng c\u1ee5 ho\u1ea1t \u0111\u1ed9ng m\u00e0 kh\u00f4ng c\u1ea7n ph\u1ea3i c\u00f3 gi\u1ea3i ph\u00e1p ph\u1ee9c t\u1ea1p \u0111\u1ec3 ph\u00e2n t\u00edch c\u00fa ph\u00e1p v\u00e0 ph\u00e1t hi\u1ec7n c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng trong nh\u1eadt k\u00fd s\u1ef1 ki\u1ec7n c\u1ee7a windows nh\u01b0 gi\u1ea3i ph\u00e1p SIEM v\u00e0 tr\u00ecnh thu th\u1eadp logs.</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a APT-Hunter:</p> <ul> <li>Ph\u00e1t hi\u1ec7n c\u00e1c ho\u1ea1t \u0111\u1ed9ng \u0111\u00e1ng ng\u1edd n\u00e0o m\u00e0 ta kh\u00f4ng bi\u1ebft tr\u01b0\u1edbc khi n\u00f3 tr\u1edf th\u00e0nh m\u1ed9t s\u1ef1 c\u1ed1 l\u1edbn.</li> <li>Ph\u00e1t hi\u1ec7n t\u1ea5n c\u00f4ng nhanh h\u01a1n, \u0111i\u1ec1u n\u00e0y s\u1ebd l\u00e0m gi\u1ea3m th\u1eddi gian ph\u1ea3n h\u1ed3i \u0111\u1ec3 nhanh ch\u00f3ng ng\u0103n ch\u1eb7n v\u00e0 lo\u1ea1i b\u1ecf c\u00e1c cu\u1ed9c t\u1ea5n c\u00f4ng.</li> <li>B\u00e1o c\u00e1o t\u01b0\u01a1ng th\u00edch v\u1edbi timesketch \u0111\u1ec3 th\u1ef1c hi\u1ec7n ph\u00e2n t\u00edch d\u00f2ng th\u1eddi gian.</li> <li>\u0110i\u1ec1u tra nhi\u1ec1u m\u00e1y ch\u1ee7 nhanh h\u01a1n trong kho\u1ea3ng th\u1eddi gian ng\u1eafn.</li> <li>Gi\u00fap \u00edch cho \u0111i\u1ec1u tra vi\u00ean trong nh\u1eefng tr\u01b0\u1eddng h\u1ee3p kh\u00f4ng c\u00f3 nhi\u1ec1u th\u1eddi gian \u0111\u1ec3 ph\u00e2n t\u00edch chuy\u00ean s\u00e2u.</li> <li>Bi\u1ebfn h\u00e0ng tri\u1ec7u s\u1ef1 ki\u1ec7n th\u00e0nh h\u00e0ng tr\u0103m s\u1ef1 ki\u1ec7n v\u1edbi m\u1ee9c \u0111\u1ed9 nghi\u00eam tr\u1ecdng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng l\u00e0m b\u1ed9 l\u1ecdc.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng APT-Hunter <p>\u0110i\u1ec1u \u0111\u1ea7u ti\u00ean c\u1ea7n l\u00e0m tr\u01b0\u1edbc khi s\u1eed d\u1ee5ng c\u00f4ng c\u1ee5 l\u00e0 thu th\u1eadp Event Logs:</p> <pre><code># \u0110\u1ec3 thu th\u1eadp v\u1edbi \u0111\u1ecbnh d\u1ea1ng EVTX, s\u1eed d\u1ee5ng script sau:\nwindows-log-collector-full-v3-EVTX.ps1 \n# \u0110\u1ec3 thu th\u1eadp v\u1edbi \u0111\u1ecbnh d\u1ea1ng CSV, s\u1eed d\u1ee5ng script sau: \nwindows-log-collector-full-v3-CSV.ps1\n</code></pre> <p>C\u00e0i \u0111\u1eb7t c\u00e1c th\u01b0 vi\u1ec7n python c\u1ea7n thi\u1ebft: <pre><code>python3 -m pip install -r Requirements.txt\n</code></pre></p> <p><pre><code>python3 APT-Hunter.py -h\nusage: APT-Hunter.py [-h] [-p PATH] [-o OUT] [-t {csv,evtx}]\n[--security SECURITY] [--system SYSTEM]\n[--scheduledtask SCHEDULEDTASK] [--defender DEFENDER]\n[--powershell POWERSHELL] [--powershellop POWERSHELLOP]\n[--terminal TERMINAL] [--winrm WINRM] [--sysmon SYSMON]\noptional arguments:\n-h, --help            show this help message and exit\n-p PATH, --path PATH  path to folder containing windows event logs generated by the APT-Hunter-Log-Collector.ps1\n-o OUT, --out OUT     output file name\n-t {csv,evtx}, --type {csv,evtx}\ncsv ( logs from get-eventlog or windows event log GUI\nor logs from Get-WinEvent ) , evtx ( EVTX extension\nwindows event log )\n--security SECURITY   Path to Security Logs\n--system SYSTEM       Path to System Logs\n--scheduledtask SCHEDULEDTASK\nPath to Scheduled Tasks Logs\n--defender DEFENDER   Path to Defender Logs\n--powershell POWERSHELL\nPath to Powershell Logs\n--powershellop POWERSHELLOP\nPath to Powershell Operational Logs\n--terminal TERMINAL   Path to TerminalServices LocalSessionManager Logs\n--winrm WINRM         Path to Winrm Logs\n--sysmon SYSMON       Path to Sysmon Logs\n</code></pre> <code>-p</code>: \u0111\u1ecba ch\u1ec9 tr\u1ecf \u0111\u1ebfn th\u01b0 m\u1ee5c ch\u1ee9a c\u00e1c Event Logs</p> <p><code>-o</code>: T\u00ean c\u1ee7a d\u1ef1 \u00e1n</p> <p><code>-t</code>: Lo\u1ea1i c\u1ee7a log (v\u00ed d\u1ee5 CSV ho\u1eb7c EVTX)</p> <p>V\u00ed d\u1ee5:</p> <pre><code>python3 APT-Hunter.py  -t evtx  -p /opt/wineventlogs/  -o Project1\npython3 APT-Hunter.py  -t csv  -p /opt/wineventlogs/  -o Project1\npython3 APT-Hunter.py  -t evtx  --security evtx/security.evtx -o Project2\n</code></pre>"},{"location":"tools/log/#logontracer","title":"LogonTracer","text":"<p>LogonTracer l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 \u0111\u1ec3 \u0111i\u1ec1u tra c\u00e1c l\u1ea7n \u0111\u0103ng nh\u1eadp b\u1eb1ng c\u00e1ch tr\u1ef1c quan h\u00f3a v\u00e0 ph\u00e2n t\u00edch nh\u1eadt k\u00fd s\u1ef1 ki\u1ec7n Windows Active Directory. C\u00f4ng c\u1ee5 n\u00e0y li\u00ean k\u1ebft t\u00ean m\u00e1y ch\u1ee7 (ho\u1eb7c \u0111\u1ecba ch\u1ec9 IP) v\u00e0 t\u00ean t\u00e0i kho\u1ea3n \u0111\u01b0\u1ee3c t\u00ecm th\u1ea5y trong c\u00e1c s\u1ef1 ki\u1ec7n li\u00ean quan \u0111\u1ebfn \u0111\u0103ng nh\u1eadp v\u00e0 hi\u1ec3n th\u1ecb d\u01b0\u1edbi d\u1ea1ng bi\u1ec3u \u0111\u1ed3. B\u1eb1ng c\u00e1ch n\u00e0y, c\u00f3 th\u1ec3 bi\u1ebft n\u1ed7 l\u1ef1c \u0111\u0103ng nh\u1eadp t\u00e0i kho\u1ea3n n\u00e0o x\u1ea3y ra v\u00e0 m\u00e1y ch\u1ee7 n\u00e0o \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng.</p> <p>Nh\u1eefng s\u1ef1 ki\u1ec7n m\u00e0 LogonTracer h\u1ed7 tr\u1ee3:</p> <ul> <li>4624: \u0110\u0103ng nh\u1eadp th\u00e0nh c\u00f4ng</li> <li>4625: \u0110\u0103ng nh\u1eadp th\u1ea5t b\u1ea1i</li> <li>4768: Kerberos Authentication (TGT Request)</li> <li>4769: Kerberos Service Ticket (ST Request)</li> <li>4776: X\u00e1c th\u1ef1c NTLM</li> <li>4672: \u0110\u0103ng nh\u1eadp v\u1edbi quy\u1ec1n \u0111\u1eb7c bi\u1ec7t</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng LogonTracer <p>S\u1eed d\u1ee5ng c\u00e2u l\u1ec7nh sau \u0111\u1ec3 kh\u1edfi \u0111\u1ed9ng LogonTracer:</p> <pre><code>$ python3 logontracer.py -r -o [PORT] -u [USERNAME] -p [PASSWORD] -s [IP Address]\n</code></pre> <pre><code>-r: Kh\u1edfi ch\u1ea1y m\u00e1y ch\u1ee7 web\n-o: C\u1ed5ng d\u1ecbch v\u1ee5 m\u00e1y ch\u1ee7 web ho\u1ea1t \u0111\u1ed9ng (v\u00ed d\u1ee5: 8080)\n-u: T\u00ean ng\u01b0\u1eddi d\u00f9ng (M\u1eb7c \u0111\u1ecbnh l\u00e0 \u201cneo4j\u201d)\n-p: M\u1eadt kh\u1ea9u\n-s: \u0110\u1ecba ch\u1ec9 IP c\u1ee7a m\u00e1y ch\u1ee7 web (v\u00ed d\u1ee5: localhost)\n</code></pre> <p>Truy c\u1eadp http://[[\u0110\u1ecba ch\u1ec9 c\u1ee7a LogonTracer]]:8080, s\u1eed d\u1ee5ng t\u00e0i kho\u1ea3n t\u1eeb c\u00e2u l\u1ec7nh ph\u00eda tr\u00ean:</p> <p></p> <p>Upload evtx:</p> <p></p> <p>S\u1eed d\u1ee5ng thanh \u0111i\u1ec1u h\u01b0\u1edbng \u0111\u1ec3 t\u00ecm t\u00ean t\u00e0i kho\u1ea3n, \u0111\u1ecba ch\u1ec9 IP, event ID,...</p> <p></p> <p>L\u1ecdc th\u1eddi gian:</p> <p></p>"},{"location":"tools/log/#zircolite","title":"Zircolite","text":"<p>Zircolite l\u00e0 c\u00f4ng c\u1ee5 vi\u1ebft b\u1eb1ng Python3, cho ph\u00e9p s\u1eed d\u1ee5ng SIGMA rules tr\u00ean Windows Event Logs (\u0111\u1ecbnh d\u1ea1ng EVTX v\u00e0 JSONL), Auditd v\u00e0 Sysmon v\u1edbi Linux.</p> <p>Nh\u1eefng ch\u1ee9c n\u0103ng ch\u00ednh c\u1ee7a Zircolite:</p> <ul> <li>Zircolite c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng tr\u1ef1c ti\u1ebfp tr\u00ean endpoint \u0111\u01b0\u1ee3c \u0111i\u1ec1u tra ho\u1eb7c trong m\u00f4i tr\u01b0\u1eddng ph\u00e2n t\u00edch chuy\u00ean s\u00e2u / m\u00f4i tr\u01b0\u1eddng gi\u1ea3 l\u1eadp.</li> <li>Nhanh v\u00e0 x\u1eed l\u00fd \u0111\u01b0\u1ee3c l\u01b0\u1ee3ng l\u1edbn d\u1eef li\u1ec7u c\u00f9ng l\u00fac</li> <li>S\u1eed d\u1ee5ng Sigma backend (SQLite)</li> <li>Xu\u1ea5t k\u1ebft qu\u1ea3 sang nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng kh\u00e1c nhau d\u1ef1a tr\u00ean c\u00e1c templates: JSON, CSV, JSONL, Splunk, Elastic, Zinc, Timesketch...</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Zircolite <p>T\u1ea3i xu\u1ed1ng c\u00f4ng c\u1ee5 t\u1ea1i \u0111\u00e2y, sau \u0111\u00f3 c\u00e0i \u0111\u1eb7t c\u00e1c library v\u1edbi c\u00e2u l\u1ec7nh: <code>pip3 install -r requirements.txt</code></p> <p>Ph\u00e2n t\u00edch EVTX v\u1edbi b\u1ed9 rule Windows Sysmon:</p> <pre><code># python3 zircolite.py --evtx &lt;EVTX FOLDER or EVTX FILE&gt; --ruleset &lt;SIGMA RULESET&gt; [--ruleset &lt;OTHER RULESET&gt;]\npython3 zircolite.py --evtx sysmon.evtx --ruleset rules/rules_windows_sysmon.json\n</code></pre> <p>Ph\u00e2n t\u00edch Auditd / Sysmon cho Linux / JSONL ho\u1eb7c NDJSON logs :</p> <pre><code>python3 zircolite.py --events auditd.log --ruleset rules/rules_linux.json --auditd\npython3 zircolite.py --events sysmon.log --ruleset rules/rules_linux.json --sysmon4linux\npython3 zircolite.py --events &lt;JSON_FOLDER or JSON_FILE&gt; --ruleset rules/rules_windows_sysmon.json --jsononly\n</code></pre> <p>S\u1eed d\u1ee5ng miniGUI v\u1edbi option <code>--package</code>:</p> <p></p> <p>Timeline c\u00e1c s\u1ef1 ki\u1ec7n \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t hi\u1ec7n:</p> <p></p> <p>Ma tr\u1eadn MITRE ATT&amp;CK:</p> <p></p>"},{"location":"tools/log/#appcompatcacheparser","title":"AppCompatCacheParser","text":"<p>AppCompatCacheParser l\u00e0 c\u00f4ng c\u1ee5 ph\u00e2n t\u00edch AppCompatCache (ShimCache). H\u1ed7 tr\u1ee3 x\u1eed l\u00fd c\u00e1c t\u1eadp tin b\u1ecb kh\u00f3a.</p> <p></p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng AppCompatCacheParser <p>T\u1ea3i xu\u1ed1ng c\u00f4ng c\u1ee5 t\u1ea1i \u0111\u00e2y.</p> <p>M\u1edf c\u1eeda s\u1ed5 CMD v\u1edbi quy\u1ec1n Administrator.</p> <p>Ch\u1ea1y AppCompatCacheParser v\u1edbi c\u1eeda s\u1ed5 d\u00f2ng l\u1ec7nh CMD v\u1eeba m\u1edf:</p> <pre><code>AppCompatCache Parser version 1.4.4.0\nAuthor: Eric Zimmerman (saericzimmerman@gmail.com)\nhttps://github.com/EricZimmerman/AppCompatCacheParser\nc               The ControlSet to parse. Default is to extract all control sets.\nf               Full path to SYSTEM hive to process. If this option is not specified, the live Registry will be used\nt               Sorts last modified timestamps in descending order\ncsv             Directory to save CSV formatted results to. Required\ncsvf            File name to save CSV formatted results to. When present, overrides default name\ndebug           Debug mode\ndt              The custom date/time format to use when displaying timestamps. See https://goo.gl/CNVq0k for options. Default is: yyyy-MM-dd HH:mm:ss\nnl              When true, ignore transaction log files for dirty hives. Default is FALSE\nExamples: AppCompatCacheParser.exe --csv c:\\temp -t -c 2\nAppCompatCacheParser.exe --csv c:\\temp --csvf results.csv\nShort options (single letter) are prefixed with a single dash. Long commands are prefixed with two dashes\n</code></pre> <p></p> <p>\u0110\u1ec3 b\u1eaft \u0111\u1ea7u ph\u00e2n t\u00edch, ta s\u1ebd ch\u1ea1y c\u00e2u l\u1ec7nh sau:</p> <pre><code>AppCompatCacheParser.exe -f C:\\temp\\muldwych\\Content\\C\\Windows\\System32\\config\\SYSTEM \u2013csv c:\\temp \u2013dt yyyy-MM-ddTHH:mm:ss\n</code></pre> <ul> <li>Ch\u1ea1y AppCompatCacheParser.exe</li> <li>-f y\u00eau c\u1ea7u ch\u01b0\u01a1ng tr\u00ecnh s\u1eed d\u1ee5ng t\u1eadp tin t\u1ea1i \u0111\u01b0\u1eddng d\u1eabn sau n\u00f3, \u1edf v\u00ed d\u1ee5 l\u00e0 <code>C:\\temp\\muldwych\\Content\\C\\Windows\\System32\\config\\SYSTEM</code></li> <li>\u2013csv y\u00eau c\u1ea7u c\u00f4ng c\u1ee5 xu\u1ea5t d\u01b0\u1edbi \u0111u\u00f4i csv v\u00e0 t\u1ea1i th\u01b0 m\u1ee5c \u0111\u00e3 n\u00eau, t\u1ee9c l\u00e0 <code>c:\\temp</code></li> <li>\u2013dt y\u00eau c\u1ea7u c\u00f4ng c\u1ee5 s\u1eed d\u1ee5ng \u0111\u1ecbnh d\u1ea1ng ng\u00e0y/gi\u1edd t\u00f9y ch\u1ec9nh khi x\u1eed l\u00fd th\u1eddi gian, trong v\u00ed d\u1ee5 l\u00e0 <code>yyyy-MM-ddTHH:mm:ss</code></li> </ul> <p></p> <p>Sau \u0111\u00f3 ch\u00fang ta \u0111\u00e3 c\u00f3 t\u1eadp tin csv \u0111\u1ec3 ti\u1ebfn h\u00e0nh \u0111i\u1ec1u tra chuy\u00ean s\u00e2u h\u01a1n:</p> <p></p> <p>Ch\u00fang ta c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng Timeline Explorer ho\u1eb7c Excel \u0111\u1ec3 m\u1edf t\u1eadp tin tr\u00ean.</p> <p></p>"},{"location":"tools/log/#cyberchef","title":"CyberChef","text":"<p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p> <p>CyberChef l\u00e0 m\u1ed9t \u1ee9ng d\u1ee5ng web ngu\u1ed3n m\u1edf, mi\u1ec5n ph\u00ed \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1ec3 th\u1ef1c hi\u1ec7n c\u00e1c k\u1ef9 thu\u1eadt thao t\u00e1c d\u1eef li\u1ec7u ph\u1ed5 bi\u1ebfn theo c\u00e1ch c\u00f3 c\u1ea5u tr\u00fac, c\u00f3 h\u1ec7 th\u1ed1ng v\u00e0 c\u00f3 th\u1ec3 l\u1eb7p l\u1ea1i. \u0110i\u1ec1u n\u00e0y bao g\u1ed3m c\u00e1c ho\u1ea1t \u0111\u1ed9ng nh\u01b0 gi\u1ea3i m\u00e3 \u0111\u01a1n gi\u1ea3n, t\u00ednh to\u00e1n h\u00e0m b\u0103m, tr\u00edch xu\u1ea5t n\u1ed9i dung, ph\u00e2n t\u00edch c\u00fa ph\u00e1p \u0111\u1ecbnh d\u1ea1ng,\u2026CyberChef c\u00f3 th\u1ec3 tri\u1ec3n khai tr\u00ean local ho\u1eb7c tr\u1ef1c tuy\u1ebfn.</p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng CyberChef <ul> <li>C\u00e0i \u0111\u1eb7t Git</li> <li>C\u00e0i \u0111\u1eb7t Node.js phi\u00ean b\u1ea3n 18 v\u00e0 npm phi\u00ean b\u1ea3n 8</li> <li>git clone https://github.com/gchq/CyberChef.git</li> <li>cd CyberChef</li> <li>npm install</li> </ul> <p>Ho\u1eb7c ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 s\u1eed d\u1ee5ng tr\u1ef1c tuy\u1ebfn b\u1eb1ng c\u00e1ch truy c\u1eadp: https://gchq.github.io/CyberChef/</p> <p></p>"},{"location":"tools/log/#chainsaw","title":"Chainsaw","text":"<p>Chainsaw l\u00e0 c\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch v\u00e0 ph\u00e1t hi\u1ec7n d\u1ea5u hi\u1ec7u t\u1ea5n c\u00f4ng h\u1ec7 th\u1ed1ng th\u00f4ng qua c\u00e1c \u0111\u1eb7c tr\u01b0ng t\u1eeb Windows, v\u00ed udj nh\u01b0 Event Logs v\u00e0 MFT.  Chainsaw cung c\u1ea5p m\u1ed9t ph\u01b0\u01a1ng ph\u00e1p t\u00ecm ki\u1ebfm nhanh ch\u00f3ng th\u00f4ng qua t\u1eeb kh\u00f3a v\u00e0 x\u00e1c \u0111\u1ecbnh m\u1ed1i \u0111e do\u1ea1 d\u1ef1a tr\u00ean Sigma rules.</p> <p></p> <p>Nh\u1eefng ch\u1ee9c n\u0103ng ch\u00ednh c\u1ee7a Chainsaw:</p> <ul> <li>S\u0103n t\u00ecm m\u1ed1i \u0111e do\u1ea1 d\u1ef1a tr\u00ean Sigma rules v\u00e0 c\u00e1c rule tu\u1ef3 ch\u1ec9nh t\u1eeb Chaisaw</li> <li>T\u00ecm ki\u1ebfm v\u00e0 tr\u00edch xu\u1ea5t c\u00e1c d\u1ea5u v\u1ebft b\u1eb1ng kh\u1edbp chu\u1ed7i v\u00e0 bi\u1ec3u th\u1ee9c ch\u00ednh quy (regex).</li> <li>\u0110\u01b0\u1ee3c vi\u1ebft b\u1eb1ng Rust, d\u1ef1a tr\u00ean th\u01b0 vi\u1ec7n EVTX parser</li> <li>Xu\u1ea5t k\u1ebft qu\u1ea3 v\u1edbi nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng kh\u00e1c nhau: ASCII table, \u0111\u1ecbnh d\u1ea1ng CSV v\u00e0 \u0111\u1ecbnh d\u1ea1ng JSON</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Chainsaw <p>T\u1ea3i xu\u1ed1ng Chainsaw t\u1eeb m\u1ee5c releases</p> <pre><code>USAGE:\nchainsaw search [FLAGS] [OPTIONS] &lt;pattern&gt; [--] [path]...\nFLAGS:\n-h, --help            Prints help information\n-i, --ignore-case     Ignore the case when searching patterns\n--json            Print the output in json format\n--load-unknown    Allow chainsaw to try and load files it cannot identify\n--local           Output the timestamp using the local machine's timestamp\n    -q                    Supress informational output\n        --skip-errors     Continue to search when an error is encountered\n    -V, --version         Prints version information\nOPTIONS:\n        --extension &lt;extension&gt;...    Only search through files with the provided extension\n        --from &lt;from&gt;                 The timestamp to search from. Drops any documents older than the value provided\n    -o, --output &lt;output&gt;             The path to output results to\n    -e, --regex &lt;pattern&gt;...          A string or regular expression pattern to search for\n    -t, --tau &lt;tau&gt;...                Tau expressions to search with. e.g. 'Event.System.EventID: =4104'\n--timestamp &lt;timestamp&gt;       The field that contains the timestamp\n--timezone &lt;timezone&gt;         Output the timestamp using the timezone provided\n--to &lt;to&gt;                     The timestamp to search up to. Drops any documents newer than the value provided\nARGS:\n&lt;pattern&gt;    A string or regular expression pattern to search for. Not used when -e or -t is specified\n&lt;path&gt;...    The paths containing event logs to load and hunt through\n</code></pre> <p>T\u00ecm ki\u1ebfm t\u1ea5t c\u1ea3 chu\u1ed7i \"mimikatz\" kh\u00f4ng ph\u00e2n bi\u1ec7t hoa th\u01b0\u1eddng:</p> <pre><code>./chainsaw search mimikatz -i evtx_attack_samples/\n</code></pre> <p>T\u00ecm ki\u1ebfm t\u1ea5t c\u1ea3 s\u1ef1 ki\u1ec7n \u0111\u0103ng nh\u1eadp v\u1edbi regex, xu\u1ea5t d\u01b0\u1edbi d\u1ea1ng JSON:</p> <pre><code>./chainsaw search -e \"DC[0-9].insecurebank.local\" evtx_attack_samples --json\n</code></pre> <p>T\u00ecm ki\u1ebfm t\u1ea5t c\u1ea3 c\u00e1c t\u1eadp tin evtx b\u1eb1ng Sigma rules \u0111\u1ec3 ph\u00e1t hi\u1ec7n t\u1ea5n c\u00f4ng:</p> <pre><code>$ ./chainsaw hunt -r rules/ evtx_attack_samples -s sigma/rules --mapping mappings/sigma-event-logs-all.yml --level critical\n\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2557  \u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2557\u2588\u2588\u2588\u2557   \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2557    \u2588\u2588\u2557\n\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2551    \u2588\u2588\u2551\n\u2588\u2588\u2551     \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2554\u2588\u2588\u2557 \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2551 \u2588\u2557 \u2588\u2588\u2551\n\u2588\u2588\u2551     \u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2551\u255a\u2588\u2588\u2557\u2588\u2588\u2551\u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2588\u2557\u2588\u2588\u2551\n\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2551 \u255a\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u255a\u2588\u2588\u2588\u2554\u2588\u2588\u2588\u2554\u255d\n\u255a\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u255d\u255a\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u2550\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u255d \u255a\u2550\u2550\u255d\u255a\u2550\u2550\u255d\nBy Countercept (@FranticTyping, @AlexKornitzer)\n[+] Loading detection rules from: ../../rules/, /tmp/sigma/rules\n[+] Loaded 129 detection rules (198 not loaded)\n[+] Loading event logs from: ../../evtx_attack_samples (extensions: .evtx)\n[+] Loaded 268 EVTX files (37.5 MB)\n[+] Hunting: [========================================] 268/268\n[+] Group: Antivirus\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      timestamp      \u2502     detections     \u2502 Event ID \u2502 Record ID \u2502  Computer   \u2502          Threat Name           \u2502           Threat Path            \u2502        User        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-07-18 20:40:00 \u2502 \u2023 Windows Defender \u2502 1116     \u2502 37        \u2502 MSEDGEWIN10 \u2502 Trojan:PowerShell/Powersploit. \u2502 file:_C:\\AtomicRedTeam\\atomic-   \u2502 MSEDGEWIN10\\IEUser \u2502\n\u2502                     \u2502                    \u2502          \u2502           \u2502             \u2502 M                              \u2502 red-team-master\\atomics\\T1056\\   \u2502                    \u2502\n\u2502                     \u2502                    \u2502          \u2502           \u2502             \u2502                                \u2502 Get-Keystrokes.ps1               \u2502                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-07-18 20:53:31 \u2502 \u2023 Windows Defender \u2502 1117     \u2502 106       \u2502 MSEDGEWIN10 \u2502 Trojan:XML/Exeselrun.gen!A     \u2502 file:_C:\\AtomicRedTeam\\atomic-   \u2502 MSEDGEWIN10\\IEUser \u2502\n\u2502                     \u2502                    \u2502          \u2502           \u2502             \u2502                                \u2502 red-team-master\\atomics\\T1086\\   \u2502                    \u2502\n\u2502                     \u2502                    \u2502          \u2502           \u2502             \u2502                                \u2502 payloads\\test.xsl                \u2502                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n[+] Group: Log Tampering\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      timestamp      \u2502          detections           \u2502 Event ID \u2502 Record ID \u2502            Computer            \u2502     User      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-01-20 07:00:50 \u2502 \u2023 Security Audit Logs Cleared \u2502 1102     \u2502 32853     \u2502 WIN-77LTAPHIQ1R.example.corp   \u2502 Administrator \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n[+] Group: Sigma\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      timestamp      \u2502           detections           \u2502 count \u2502     Event.System.Provider      \u2502 Event ID \u2502 Record ID \u2502         Computer         \u2502            Event Data            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-04-29 20:59:14 \u2502 \u2023 Malicious Named Pipe         \u2502 1     \u2502 Microsoft-Windows-Sysmon       \u2502 18       \u2502 8046      \u2502 IEWIN7                   \u2502 ---                              \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Image: System                    \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 PipeName: \"\\\\46a676ab7f179e511   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 e30dd2dc41bd388\"                 \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ProcessGuid: 365ABB72-D9C4-5CC   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 7-0000-0010EA030000              \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ProcessId: 4                     \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 RuleName: \"\"                     \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 UtcTime: \"2019-04-29 20:59:14.   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 430\"                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-04-30 20:26:51 \u2502 \u2023 CobaltStrike Service         \u2502 1     \u2502 Microsoft-Windows-Sysmon       \u2502 13       \u2502 9806      \u2502 IEWIN7                   \u2502 ---                              \u2502\n\u2502                     \u2502 Installations in Registry      \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Details: \"%%COMSPEC%% /b /c st   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 art /b /min powershell.exe -no   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 p -w hidden -noni -c \\\"if([Int   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Ptr]::Size -eq 4){$b='powershe   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ll.exe'}else{$b=$env:windir+'\\   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 \\syswow64\\\\WindowsPowerShell\\\\   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 v1.0\\\\powershell.exe'};$s=New-   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Object System.Diagnostics.Proc   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 essStartInfo;$s.FileName=$b;$s   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 .Arguments='-noni -nop -w hidd   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 en -c &amp;([scriptblock]::create(   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 (New-Object IO.StreamReader(Ne   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 w-Object IO.Compression.GzipSt   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ream((New-Object IO.MemoryStre   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 am(,[Convert]::FromBase64Strin   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 g(''H4sIAIuvyFwCA7VW+2/aSBD+OZ   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 H6P1...                          \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 (use --full to show all content) \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 EventType: SetValue              \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Image: \"C:\\\\Windows\\\\system32\\   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 \\services.exe\"                   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ProcessGuid: 365ABB72-2586-5CC   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 9-0000-0010DC530000              \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ProcessId: 460                   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 RuleName: \"\"                     \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 TargetObject: \"HKLM\\\\System\\\\C   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 urrentControlSet\\\\services\\\\he   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 llo\\\\ImagePath\"                  \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 UtcTime: \"2019-04-30 20:26:51.   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 934\"                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-05-12 12:52:43 \u2502 \u2023 Meterpreter or Cobalt        \u2502 1     \u2502 Service Control Manager        \u2502 7045     \u2502 10446     \u2502 IEWIN7                   \u2502 ---                              \u2502\n\u2502                     \u2502 Strike Getsystem Service       \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 AccountName: LocalSystem         \u2502\n\u2502                     \u2502 Installation                   \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ImagePath: \"%COMSPEC% /c ping    \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 -n 1 127.0.0.1 &gt;nul &amp;&amp; echo 'W   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 inPwnage' &gt; \\\\\\\\.\\\\pipe\\\\WinPw   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 nagePipe\"                        \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ServiceName: WinPwnage           \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ServiceType: user mode service   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 StartType: demand start          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 2019-06-21 07:35:37 \u2502 \u2023 Dumpert Process Dumper       \u2502 1     \u2502 Microsoft-Windows-Sysmon       \u2502 11       \u2502 238375    \u2502 alice.insecurebank.local \u2502 ---                              \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 CreationUtcTime: \"2019-06-21 0   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 6:53:03.227\"                     \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Image: \"C:\\\\Users\\\\administrat   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 or\\\\Desktop\\\\x64\\\\Outflank-Dum   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 pert.exe\"                        \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ProcessGuid: ECAD0485-88C9-5D0   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 C-0000-0010348C1D00              \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 ProcessId: 3572                  \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 RuleName: \"\"                     \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 TargetFilename: \"C:\\\\Windows\\\\   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 Temp\\\\dumpert.dmp\"               \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 UtcTime: \"2019-06-21 07:35:37.   \u2502\n\u2502                     \u2502                                \u2502       \u2502                                \u2502          \u2502           \u2502                          \u2502 324\"                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"tools/log/#event-log-observer","title":"Event Log Observer","text":"<p>Event Log Observer l\u00e0 c\u00f4ng c\u1ee5 gi\u00fap nhanh ch\u00f3ng t\u00ecm v\u00e0 ph\u00e2n t\u00edch c\u00e1c c\u1ea3nh b\u00e1o b\u1ea3o m\u1eadt, s\u1ef1 c\u1ed1 v\u00e0 c\u00e1c s\u1ef1 ki\u1ec7n kh\u00e1c trong h\u1ec7 \u0111i\u1ec1u h\u00e0nh Microsoft Windows. V\u1edbi Event Log Observer, ta c\u00f3 th\u1ec3 tr\u00edch xu\u1ea5t d\u1eef li\u1ec7u c\u1ea7n thi\u1ebft b\u1eb1ng c\u00fa ph\u00e1p truy v\u1ea5n SQLite v\u00e0 n\u00e2ng cao hi\u1ec7u qu\u1ea3 ph\u00e2n t\u00edch Event Logs.</p> <p>Nh\u1eefng ch\u1ee9c n\u0103ng ch\u00ednh c\u1ee7a Event Log Observer:</p> <ul> <li>\u0110i\u1ec1u h\u01b0\u1edbng d\u1ec5 d\u00e0ng v\u00e0 tr\u1ef1c quan h\u00f3a d\u1eef li\u1ec7u</li> <li>S\u1eed d\u1ee5ng SQL \u0111\u1ec3 \u0111\u1ecdc event logs</li> <li>S\u1eed d\u1ee5ng cho nhi\u1ec1u lo\u1ea1i log kh\u00e1c nhau</li> <li>H\u1ed7 tr\u1ee3 t\u00ecm ki\u1ebfm th\u00f4ng tin nhanh ch\u00f3ng</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Event Log Observer <p>T\u1ea3i xu\u00f3ng c\u00f4ng c\u1ee5: Event Log Observer</p> <p>Giao di\u1ec7n Dashboard c\u1ee7a Event Log Observer:</p> <p></p> <p>T\u00ecm ki\u1ebfm th\u00f4ng tin t\u1eeb Event Log:</p> <p></p>"},{"location":"tools/log/#log-parser-lizard","title":"Log Parser Lizard","text":"<p>C\u00f4ng c\u1ee5 truy v\u1ea5n d\u1eef li\u1ec7u v\u00e0 ph\u00e2n t\u00edch Event log cho ph\u00e9p d\u1ec5 d\u00e0ng tr\u00edch xu\u1ea5t th\u00f4ng tin c\u00f3 gi\u00e1 tr\u1ecb b\u1eb1ng s\u1ee9c m\u1ea1nh c\u1ee7a c\u00e1c l\u1ec7nh truy v\u1ea5n SQL. V\u1edbi Log Parser Lizard, ta c\u00f3 th\u1ec3 d\u1ec5 d\u00e0ng ph\u00e2n t\u00edch c\u00e1c system ho\u1eb7c application logs kh\u00e1c nhau, sau \u0111\u00f3 th\u1ef1c hi\u1ec7n c\u00e1c truy v\u1ea5n SQL \u0111\u1ed1i v\u1edbi ch\u00fang.</p> <p>Nh\u1eefng ch\u1ee9c n\u0103ng ch\u00ednh c\u1ee7a  Log Parser Lizard:</p> <ul> <li>S\u1eed d\u1ee5ng truy v\u1ea5n SQL \u0111\u1ec3 \u0111\u1ecdc log</li> <li>Web API Server</li> <li>L\u1ecdc d\u1eef li\u1ec7u v\u00e0 x\u1eed l\u00fd kh\u1ed1i l\u01b0\u1ee3ng log l\u1edbn</li> <li>Xu\u1ea5t ra nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng: XLS, XLSX, PDF, RTF, TXT, MHT, CSV, HTML,...</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng  Log Parser Lizard <p>S\u1eed d\u1ee5ng c\u00e2u l\u1ec7nh SQL \u0111\u1ec3 x\u1eed l\u00fd d\u1eef li\u1ec7u m\u00e0 kh\u00f4ng c\u1ea7n l\u01b0u v\u00e0o database:</p> <p></p> <pre><code>SELECT DISTINCT src-ip FROM firewall.log WHERE action='DROP'\nSELECT TOP 100 * FROM c:\\webserver.log WHERE sc-status &lt;&gt; 200\nSELECT cs-uri-stem FROM c:\\InetPub\\Logs\\ex*.log\nGROUP BY cs-uri-stem HAVING COUNT(*) &gt; 50\nSELECT to_lowercase(extract_extension(cs-uri-stem)) AS PageType, SUM(sc-bytes)\nFROM ex131118.log, ex131119.log GROUP BY PageType </code></pre>"},{"location":"tools/log/#system-monitor","title":"System Monitor","text":"<p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p> <p>System Monitor l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 gi\u00e1m s\u00e1t m\u1ee9c host thu\u1ed9c b\u1ed9 SysInternals \u0111\u01b0\u1ee3c Microsoft cung c\u1ea5p cho c\u00e1c qu\u1ea3n tr\u1ecb vi\u00ean v\u00e0 nh\u00e0 ph\u00e1t tri\u1ec3n. Sau khi c\u00e0i \u0111\u1eb7t, System Monitor s\u1ebd m\u1eb7c \u0111\u1ecbnh kh\u1edfi ch\u1ea1y m\u1ed7i khi h\u1ec7 th\u1ed1ng kh\u1edfi \u0111\u1ed9ng nh\u1eb1m \u0111\u1ea3m b\u1ea3o ghi nh\u1eadn \u0111\u1ea7y \u0111\u1ee7 c\u00e1c s\u1ef1 ki\u1ec7n.  Nh\u1eefng th\u00f4ng tin \u0111\u01b0\u1ee3c System Monitor thu th\u1eadp bao g\u1ed3m vi\u1ec7c ti\u1ebfn tr\u00ecnh \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o/ng\u1eebng ho\u1ea1t \u0111\u1ed9ng, truy c\u1eadp \u0111\u1ebfn c\u00e1c v\u00f9ng nh\u1edb, h\u00e0nh vi k\u1ebft n\u1ed1i m\u1ea1ng,\u2026 C\u00e1c log \u0111\u01b0\u1ee3c System Monitor ghi l\u1ea1i c\u00f3 th\u1ec3 truy c\u1eadp th\u00f4ng qua Event Viewer t\u1ea1i m\u1ee5c Applications and Services Logs/Microsoft/Windows/Sysmon/Operational.</p> <p></p> <p>C\u00e1c t\u00ednh n\u0103ng n\u1ed5i b\u1eadt m\u00e0 System Monitor cung c\u1ea5p:</p> <ul> <li>Ghi l\u1ea1i th\u00f4ng tin c\u00e1c ti\u1ebfn tr\u00ecnh bao g\u1ed3m Command line c\u1ee7a ti\u1ebfn tr\u00ecnh hi\u1ec7n t\u1ea1i v\u00e0 ti\u1ebfn tr\u00ecnh cha.</li> <li>T\u00ednh to\u00e1n gi\u00e1 tr\u1ecb hash (MD5, SHA1, SHA256) c\u1ee7a ti\u1ebfn tr\u00ecnh v\u00e0 c\u00e1c driver/DLL k\u00e8m theo.</li> <li>Ghi nh\u1eadn c\u00e1c h\u00e0nh vi truy c\u1eadp v\u00e0o c\u00e1c \u1ed5 \u0111\u0129a v\u00e0 v\u00f9ng nh\u1edb.</li> <li>Thu th\u1eadp c\u00e1c th\u00f4ng tin v\u1ec1 k\u1ebft n\u1ed1i m\u1ea1ng bao g\u1ed3m IP, ti\u1ebfn tr\u00ecnh s\u1eed d\u1ee5ng m\u1ea1ng, port number, hostname,\u2026</li> <li>Ph\u00e1t hi\u1ec7n c\u00e1c thay \u0111\u1ed5i \u1edf ph\u1ea7n timestamp c\u1ee7a c\u00e1c file, cho bi\u1ebft th\u1eddi gian th\u1ef1c s\u1ef1 c\u1ee7a file \u0111\u01b0\u1ee3c kh\u1edfi t\u1ea1o.</li> <li>Cho ph\u00e9p tu\u1ef3 ch\u1ec9nh ho\u1ea1t \u0111\u1ed9ng theo c\u00e1c file config c\u1ee7a ng\u01b0\u1eddi d\u00f9ng.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng System Monitor <p>C\u00e0i \u0111\u1eb7t:</p> <p>Sau khi t\u1ea3i b\u1ea3n n\u00e9n t\u1eeb trang ch\u1ee7 c\u1ee7a SysInternals (https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon) v\u00e0 gi\u1ea3i n\u00e9n, ta c\u1ea7n s\u1eed d\u1ee5ng Command line v\u1edbi quy\u1ec1n Administrator nh\u1eb1m th\u1ef1c hi\u1ec7n c\u00e0i \u0111\u1eb7t. </p> <p></p> <p>Sau khi c\u00e0i \u0111\u1eb7t, System Monitor s\u1ebd kh\u1edfi ch\u1ea1y m\u00e0 kh\u00f4ng c\u1ea7n reboot h\u1ec7 th\u1ed1ng. C\u00e1c event \u0111\u01b0\u1ee3c System Monitor ghi nh\u1eadn s\u1ebd t\u00edch h\u1ee3p v\u00e0o Windows Event Viewer t\u1ea1i m\u1ee5c Applications and Services Logs/Microsoft/Windows/Sysmon/Operational. </p> <p></p> <p>Ph\u1ea1m vi gi\u00e1m s\u00e1t m\u1eb7c \u0111\u1ecbnh c\u1ee7a System Monitor s\u1ebd kh\u00f4ng \u0111\u00e1p \u1ee9ng y\u00eau c\u1ea7u trong m\u1ed9t s\u1ed1 tr\u01b0\u1eddng h\u1ee3p. Khi \u0111\u00f3, ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 \u00e1p d\u1ee5ng c\u00e1c config kh\u00e1c l\u00ean System Monitor nh\u1eb1m m\u1edf r\u1ed9ng ph\u1ea1m vi gi\u00e1m s\u00e1t l\u00ean h\u1ec7 th\u1ed1ng.</p> <p></p> <p>Ng\u01b0\u1eddi d\u00f9ng c\u00f3 th\u1ec3 quay l\u1ea1i m\u1ee5c Sysmon log nh\u1eb1m ki\u1ec3m tra l\u01b0\u1ee3ng event \u0111\u00e3 \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt nh\u01b0 y\u00eau c\u1ea7u hay ch\u01b0a.</p> <p></p>"},{"location":"tools/log/#goaccess","title":"GoAccess","text":"<p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p> <p>GoAccess l\u00e0 tr\u00ecnh ph\u00e2n t\u00edch nh\u1eadt k\u00fd web, c\u00f3 th\u1ec3 quan s\u00e1t theo th\u1eddi gian th\u1ef1c v\u00e0 tr\u00ecnh xem t\u01b0\u01a1ng t\u00e1c m\u00e3 ngu\u1ed3n m\u1edf ch\u1ea1y trong terminal trong c\u00e1c h\u1ec7 th\u1ed1ng.. Cung c\u1ea5p s\u1ed1 li\u1ec7u th\u1ed1ng k\u00ea HTTP nhanh ch\u00f3ng v\u00e0 c\u00f3 gi\u00e1 tr\u1ecb cho c\u00e1c qu\u1ea3n tr\u1ecb vi\u00ean h\u1ec7 th\u1ed1ng y\u00eau c\u1ea7u b\u00e1o c\u00e1o m\u00e1y ch\u1ee7 tr\u1ef1c quan m\u1ed9t c\u00e1ch nhanh ch\u00f3ng.</p> <p></p> <p></p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng GoAccess <p>C\u00e0i \u0111\u1eb7t:</p> <pre><code>$ wget https://tar.goaccess.io/goaccess-1.7.2.tar.gz\n$ tar -xzvf goaccess-1.7.2.tar.gz\n$ cd goaccess-1.7.2/\n$ ./configure --enable-utf8 --enable-geoip=mmdb\n$ make\n# make install\n</code></pre> <p>\u0110\u1ec3 xu\u1ea5t ra thi\u1ebft b\u1ecb \u0111\u1ea7u cu\u1ed1i v\u00e0 t\u1ea1o b\u00e1o c\u00e1o t\u01b0\u01a1ng t\u00e1c:</p> <p><code>goaccess access.log</code></p> <p>\u0110\u1ec3 t\u1ea1o b\u00e1o c\u00e1o HTML:</p> <p><code># goaccess access.log -a &gt; report.html</code></p> <p>\u0110\u1ec3 t\u1ea1o b\u00e1o c\u00e1o JSON:</p> <p><code># goaccess access.log -a -d -o json &gt; report.json</code></p> <p>\u0110\u1ec3 t\u1ea1o t\u1ec7p CSV:</p> <p><code># goaccess access.log --no-csv-summary -o csv &gt; report.csv</code></p> <p>Try v\u1ea5n l\u1ecdc d\u1eef li\u1ec7u d\u1ef1a tr\u00ean th\u1eddi gian:</p> <pre><code># sed -n '/05\\/Dec\\/2010/,$ p' access.log | goaccess -a -\n# sed -n '/'$(date '+%d\\/%b\\/%Y' -d '1 week ago')'/,$ p' access.log | goaccess -a -\n# sed -n '/5\\/Nov\\/2010/,/5\\/Dec\\/2010/ p' access.log | goaccess -a -\n# goaccess access.log --keep-last=5\n</code></pre> <p>\u0110\u1ec3 ph\u00e2n t\u00edch c\u00e1c trang c\u1ee5 th\u1ec3, v\u00ed d\u1ee5: l\u01b0\u1ee3t xem trang, html, htm, phpv.v. trong m\u1ed9t y\u00eau c\u1ea7u:</p> <p><code># awk '$7~/\\.html|\\.htm|\\.php/' access.log | goaccess -</code></p> <p>Ph\u00e2n t\u00edch m\u00e3 tr\u1ea1ng th\u00e1i c\u1ee5 th\u1ec3, v\u00ed d\u1ee5: 500 (L\u1ed7i M\u00e1y ch\u1ee7 N\u1ed9i b\u1ed9):</p> <p><code># awk '$9~/500/' access.log | goaccess -</code></p> <p>Ho\u1eb7c nhi\u1ec1u m\u00e3 tr\u1ea1ng th\u00e1i, v\u00ed d\u1ee5: t\u1ea5t c\u1ea3 3xx v\u00e0 5xx:</p> <p><code># tail -f -n +0 access.log | awk '$9~/3[0-9]{2}|5[0-9]{2}/' | goaccess -o out.html -</code></p> <p>V\u00e0 \u0111\u1ec3 c\u00f3 c\u00e1i nh\u00ecn t\u1ed5ng quan \u01b0\u1edbc t\u00ednh v\u1ec1 s\u1ed1 l\u01b0\u1ee3ng bot (tr\u00ecnh thu th\u1eadp th\u00f4ng tin) \u0111ang t\u1ea5n c\u00f4ng m\u00e1y ch\u1ee7:</p> <p><code># tail -F -n +0 access.log | grep -i --line-buffered 'bot' | goaccess -</code></p> <p>Khi s\u1eed d\u1ee5ng, l\u01b0u \u00fd c\u1ea7n c\u1ea5u h\u00ecnh \u0111\u00fang c\u00e1c \u0111\u1ecbnh d\u1ea1ng format theo logs c\u1ea7n \u0111\u1ecdc.</p>"},{"location":"tools/memory/","title":"C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra d\u1eef li\u1ec7u b\u1ed9 nh\u1edb","text":""},{"location":"tools/memory/#volatility","title":"Volatility","text":"<p>Volatility l\u00e0 m\u1ed9t framework v\u1edbi r\u1ea5t nhi\u1ec1u plugins \u0111\u01b0\u1ee3c d\u00f9ng \u0111\u1ec3 ph\u00e2n t\u00edch v\u00e0 t\u00ecm ki\u1ebfm th\u00f4ng tin t\u1eeb ch\u1ee9ng c\u1ee9 thu \u0111\u01b0\u1ee3c. C\u00e1c plugins \u0111\u01b0\u1ee3c vi\u1ebft \u0111\u1ec3 ph\u00e2n t\u00edch \u0111i\u1ec1u tra b\u1ed9 nh\u1edb theo ki\u1ebfn tr\u00fac c\u1ee7a h\u1ec7 \u0111i\u1ec1u h\u00e0nh windows.</p> <p></p> <p>M\u1ed9t s\u1ed1 c\u00e2u l\u1ec7nh \u0111\u00e1ng ch\u00fa \u00fd c\u1ee7a Volatility :</p> <ul> <li>malfind: c\u00e2u l\u1ec7nh n\u00e0y t\u00ecm code \u0111\u01b0\u1ee3c ti\u00eam v\u00e0o trong 1 process (n\u1ebfu \u0111\u01b0\u1ee3c cung c\u1ea5p processID c\u1ee5 th\u1ec3) ho\u1eb7c c\u1ea3 h\u1ec7 th\u1ed1ng (n\u1ebfu kh\u00f4ng c\u00f3 processID)</li> <li>vaddump : c\u00e2u l\u1ec7nh n\u00e0y s\u1ebd \u0111\u1ed5 t\u1ea5t c\u1ea3 v\u00f9ng nh\u1edb v\u00e0o 1 file ri\u00eang bi\u1ec7t</li> <li>dlldump: \u0111\u1ec3 \u0111\u1ed5 1 file dll t\u1eeb v\u00f9ng nh\u1edb c\u1ee7a process l\u00ean \u1ed5 \u0111\u0129a.</li> <li>dlllist: li\u1ec7t k\u00ea t\u1ea5t c\u1ea3 m\u00f4-\u0111un t\u1eeb PEB(Process enviroment block)</li> <li>ldrmodules: li\u1ec7t k\u00ea nh\u1eefng m\u00f4-\u0111un trong EPROCESS.</li> <li>HollowFind: l\u00e0 1 plugin c\u1ee7a Volatility framework d\u00f9ng \u0111\u1ec3 ph\u00e1t hi\u1ec7n c\u00e1c v\u00f9ng nh\u1edb \u0111\u00e1ng ng\u1edd</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Volatility <p>\u0110\u1ec3 x\u1eed l\u00fd m\u1ed9t t\u1eadp tin RAM dump, ta ph\u1ea3i ph\u00e2n t\u00edch xem n\u00f3 l\u00e0 c\u1ee7a OS n\u00e0o b\u1eb1ng c\u00e2u l\u1ec7nh: <code>volatility -f &lt;t\u1eadp_tin_ram_dump.raw&gt; imageinfo</code></p> <p></p> <p>Sau khi \u0111\u00e3 bi\u1ebft \u0111\u01b0\u1ee3c profile c\u1ee7a t\u1eadp tin dump RAM n\u00e0y, ta s\u1ebd li\u1ec7t k\u00ea chi ti\u1ebft v\u1ec1 m\u1ed9t ti\u1ebfn tr\u00ecnh \u2013 m\u00e0 c\u1ee5 th\u1ec3 \u1edf \u0111\u00e2y l\u00e0 notepad \u2013 k\u00e8m v\u1edbi k\u1ebft h\u1ee3p c\u00e2u l\u1ec7nh grep \u0111\u1ec3 l\u1ecdc ra process mu\u1ed1n t\u00ecm.</p> <p></p> <p>Sau khi t\u00ecm \u0111\u01b0\u1ee3c k\u1ebft qu\u1ea3 nh\u01b0 \u00fd mu\u1ed1n, ta ghi nh\u1edb l\u1ea1i s\u1ed1 PID c\u1ee7a ti\u1ebfn tr\u00ecnh notepad trong t\u1eadp tin dump RAM n\u00e0y. Sau \u0111\u00f3, ta s\u1ebd dump ri\u00eang process n\u00e0y ra \u0111\u1ec3 xem n\u1ed9i dung.</p> <p></p>"},{"location":"tools/memory/#volutility","title":"VolUtility","text":"<p>VolUtility l\u00e0 Web interface c\u1ee7a Volatility Memory Forensics Framework</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a VolUtility:</p> <ul> <li>Ch\u1ea1y c\u00e1c plugin v\u00e0 l\u01b0u tr\u1eef k\u1ebft qu\u1ea3 trong c\u01a1 s\u1edf d\u1eef li\u1ec7u mongo. </li> <li>Tr\u00edch xu\u1ea5t c\u00e1c t\u1ec7p t\u1eeb plugin (h\u1ed7 tr\u1ee3 dump-dir) v\u00e0 l\u01b0u tr\u1eef trong c\u01a1 s\u1edf d\u1eef li\u1ec7u.</li> <li>T\u00ecm ki\u1ebfm tr\u00ean t\u1ea5t c\u1ea3 c\u00e1c plugin v\u00e0 n\u1ed9i dung t\u1ec7p b\u1eb1ng t\u00ecm ki\u1ebfm strings v\u00e0 yara rules. </li> <li>Cho ph\u00e9p l\u00e0m vi\u1ec7c tr\u00ean nhi\u1ec1u memory dump trong m\u1ed9t c\u01a1 s\u1edf d\u1eef li\u1ec7u.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng VolUtility <p>cd t\u1edbi VolUtility folder, sau \u0111\u00f3 ch\u1ea1y c\u00e2u l\u1ec7nh sau:</p> <p><pre><code>./manage.py runserver 0.0.0.0:8000\n</code></pre> Theo m\u1eb7c \u0111\u1ecbnh, 0.0.0.0 cho ph\u00e9p website c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c truy c\u1eadp t\u1eeb b\u1ea5t k\u1ef3 thi\u1ebft b\u1ecb/giao di\u1ec7n m\u1ea1ng n\u00e0o. Ta c\u00f3 th\u1ec3 thay \u0111\u1ed5i \u0111i\u1ec1u n\u00e0y b\u1eb1ng c\u00e1ch \u0111\u1eb7t 0.0.0.0 th\u00e0nh m\u1ed9t \u0111\u1ecba ch\u1ec9 c\u1ee5 th\u1ec3 ho\u1eb7c th\u00e0nh 127.0.0.1 ch\u1ec9 \u0111\u1ec3 truy c\u1eadp local. C\u1ed5ng 8000 c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c thay \u0111\u1ed5i \u0111\u1ec3 ph\u00f9 h\u1ee3p v\u1edbi nhu c\u1ea7u c\u1ee7a ng\u01b0\u1eddi d\u00f9ng.  Sau khi b\u1eaft \u0111\u1ea7u, h\u00e3y truy c\u1eadp tr\u00ecnh duy\u1ec7t t\u1edbi \u0111\u1ecba ch\u1ec9 <code>IP:Port</code>.</p> <p></p>"},{"location":"tools/memory/#invteronet","title":"Invtero.net","text":"<p>T\u00ecm/Tr\u00edch xu\u1ea5t ti\u1ebfn tr\u00ecnh, hypervisors (bao g\u1ed3m c\u1ea3 nested hypervisors) trong memory dumps s\u1eed d\u1ee5ng k\u1ef9 thu\u1eadt vi ki\u1ebfn tr\u00fac Virtual Machine Introspection (WMI) \u0111\u1ed9c l\u1eadp. C\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 \u0111a n\u1ec1n t\u1ea3ng, \u0111a ki\u1ebfn tr\u00fac v\u1edbi kh\u1ea3 n\u0103ng x\u1eed l\u00fd b\u1ed9 nh\u1edb t\u1ed1c \u0111\u1ed9 cao.</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a Invtero.net:</p> <ul> <li>VMWARE</li> <li>XEN</li> <li>Crash dump (PAGEDUMP64 / Blue Screen dump)</li> <li>Symbolic type extraction / binding</li> <li>DLR Scripting (Python)</li> <li>Linux c\u01a1 b\u1ea3n (Ch\u1ee7 y\u1ebfu tr\u00ean: BSD), HyperV, Windows,...</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Invtero.net <p>T\u1ea3i xu\u1ed1ng c\u00f4ng c\u1ee5 t\u1ea1i \u0111\u00e2y</p> <p>\u0110\u0103ng k\u00fd msdia140.dll b\u1eb1ng c\u00e2u l\u1ec7nh  <pre><code>cmd /c regsvr32 msdia140.dll\n</code></pre> Sau \u0111\u00f3 ch\u1ea1y tr\u1ef1c ti\u1ebfp ch\u01b0\u01a1ng tr\u00ecnh t\u1eeb CLI, kh\u00f4ng c\u1ea7n c\u00e0i \u0111\u1eb7t / c\u1ea5u h\u00ecnh.</p>"},{"location":"tools/memory/#keefarce","title":"KeeFarce","text":"<p>KeeFarce cho ph\u00e9p tr\u00edch xu\u1ea5t th\u00f4ng tin c\u01a1 s\u1edf d\u1eef li\u1ec7u m\u1eadt kh\u1ea9u KeePass 2.x t\u1eeb b\u1ed9 nh\u1edb. KeeFarce s\u1eed d\u1ee5ng k\u1ef9 thu\u1eadt DLL injection \u0111\u1ec3 th\u1ef1c thi m\u00e3 \u0111\u1ed9c trong khi ti\u1ebfn tr\u00ecnh KeePass \u0111ang ch\u1ea1y.</p> <p></p> <p>KeeFarce c\u00f3 th\u1ec3 thu th\u1eadp th\u00f4ng tin d\u1ea1ng r\u00f5(cleartext) v\u00e0 l\u01b0u d\u01b0\u1edbi d\u1ea1ng CSV \u1edf %AppData%: </p> <ul> <li>Usernames</li> <li>Passwords</li> <li>Notes </li> <li>Url</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng KeeFarce <p>C\u1ea7n l\u1ef1a ch\u1ecdn b\u1ea3n build KeeFarce th\u00edch h\u1ee3p t\u00f9y thu\u1ed9c v\u00e0o ki\u1ebfn \u200b\u200btr\u00fac c\u1ee7a m\u1ee5c ti\u00eau (32 bit ho\u1eb7c 64 bit). \u0110\u1ec3 ch\u1ea1y c\u00f4ng c\u1ee5, c\u00e1c t\u1ec7p sau c\u1ea7n n\u1eb1m trong c\u00f9ng m\u1ed9t th\u01b0 m\u1ee5c:</p> <ul> <li>BootstrapDLL.dll</li> <li>KeeFarce.exe</li> <li>KeeFarceDLL.dll</li> <li>Microsoft.Diagnostic.Runtime.dll</li> </ul> <p>Sao ch\u00e9p c\u00e1c t\u1ec7p n\u00e0y v\u00e0o m\u00e1y m\u1ee5c ti\u00eau v\u00e0 th\u1ef1c thi KeeFarce.exe</p>"},{"location":"tools/memory/#memprocfs","title":"MemProcFS","text":"<p>MemProcFS l\u00e0 c\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch b\u1ed9 nh\u1edb v\u1eadt l\u00fd d\u01b0\u1edbi d\u1ea1ng t\u1eadp tin ho\u1eb7c \u1ed5 \u0111\u0129a \u1ea3o.</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a MemProcFS:</p> <ul> <li>Gi\u00e1m s\u00e1t m\u1ecdi g\u00f3i tin trao \u0111\u1ed5i ra/v\u00e0o m\u00e1y ch\u1ee7, trong \u0111\u00f3 cho ph\u00e9p ph\u00e1t hi\u1ec7n \u1ea3nh, c\u00e1c file d\u1eef li\u1ec7u v\u00e0 t\u00e0i kho\u1ea3n \u0111\u0103ng nh\u1eadp.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng MemProcFS <ul> <li>Mount memory dump d\u01b0\u1edbi d\u1ea1ng \u1ed5 \u0111\u0129a \u1ea3o M: <code>memprocfs.exe -device c:\\temp\\win10x64-dump.raw</code></li> <li>Mount memory dump d\u01b0\u1edbi d\u1ea1ng \u1ed5 \u0111\u0129a \u1ea3o M: \u1edf ch\u1ebf \u0111\u1ed9 verbose : <code>memprocfs.exe -device c:\\temp\\win10x64-dump.raw -v</code></li> <li>Mount memory dump d\u01b0\u1edbi d\u1ea1ng \u1ed5 \u0111\u0129a \u1ea3o M: v\u00e0 b\u1eaft \u0111\u1ea7u forensics mode: <code>memprocfs.exe -device c:\\temp\\win10x64-dump.raw -forensic 1</code></li> <li>Mount the memory dump file v\u00e0o /home/pi/mnt/ tr\u00ean Linux: <code>./memprocfs -mount /home/pi/linux -device /dumps/win10x64-dump.raw</code></li> <li>Mount memory dump d\u01b0\u1edbi d\u1ea1ng \u1ed5 \u0111\u0129a \u1ea3o S: <code>memprocfs.exe -mount s -device c:\\temp\\win10x64-dump.raw</code></li> <li>Mount b\u1ed9 nh\u1edb tr\u1ef1c ti\u1ebfp \u1edf ch\u1ebf \u0111\u1ed9 ch\u1ec9 \u0111\u1ecdc - verbose, v\u1edbi DumpIt \u1edf ch\u1ebf \u0111\u1ed9 /LIVEKD: <code>DumpIt.exe /LIVEKD /A memprocfs.exe /C \"-v\"</code></li> <li>Mount b\u1ed9 nh\u1edb tr\u1ef1c ti\u1ebfp \u1edf ch\u1ebf \u0111\u1ed9 ch\u1ec9 \u0111\u1ecdc, v\u1edbi WinPMEM driver: <code>memprocfs.exe -device pmem</code></li> <li>Mount b\u1ed9 nh\u1edb tr\u1ef1c ti\u1ebfp \u1edf ch\u1ebf \u0111\u1ed9 \u0111\u1ecdc/ghi, v\u1edbi thi\u1ebft b\u1ecb thu th\u1eadp b\u1ed9 nh\u1edb PCILeech FPGA: <code>memprocfs.exe -device fpga -memmap auto</code></li> <li>Mount memory dump v\u1edbi t\u1eadp tin page files t\u01b0\u01a1ng \u1ee9ng: <code>memprocfs.exe -device unknown-x64-dump.raw -pagefile0 pagefile.sys -pagefile1 swapfile.sys</code></li> </ul>"},{"location":"tools/memory/#rekall","title":"Rekall","text":"<p>Rekall l\u00e0 m\u1ed9t framework m\u00e3 ngu\u1ed3n m\u1edf v\u00e0 mi\u1ec5n ph\u00ed gi\u00fap tri\u1ec3n khai c\u00e1c k\u1ef9 thu\u1eadt ph\u00e2n t\u00edch ti\u00ean ti\u1ebfn v\u1edbi memory forensics v\u00e0 \u1ee9ng c\u1ee9u s\u1ef1 c\u1ed1. Rekall l\u00e0 m\u1ed9t branch trong Volatility project \u0111\u01b0\u1ee3c t\u1ea1o ra module ho\u00e1 code base, c\u1ea3i thi\u1ec7n hi\u1ec7u su\u1ea5t v\u00e0 t\u0103ng kh\u1ea3 n\u0103ng s\u1eed d\u1ee5ng.  T\u00ednh m\u00f4 \u0111un cho ph\u00e9p ch\u1ee9c n\u0103ng ph\u00e2n t\u00edch b\u1ed9 nh\u1edb v\u1eadt l\u00fd \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong GRR \u0111\u1ec3 ph\u00e2n t\u00edch tr\u1ef1c ti\u1ebfp trong b\u1ed9 nh\u1edb t\u1eeb xa.</p> <p></p> <p>Rekall h\u1ed7 tr\u1ee3 \u0111i\u1ec1u tra c\u00e1c b\u1ed9 nh\u1edb 32 bit v\u00e0 64 bit sau:</p> <ul> <li>Microsoft Windows XP Service Pack 2 v\u00e0 3</li> <li>Microsoft Windows 7 Service Pack 0 v\u00e0 1</li> <li>Microsoft Windows 8 v\u00e0 8.1</li> <li>Microsoft Windows 10</li> <li>Linux Kernels 2.6.24 t\u1edbi hi\u1ec7n t\u1ea1i.</li> <li>OSX 10.7-10.12.x.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Rekall <p>Rekall c\u00f3 s\u1eb5n d\u01b0\u1edbi d\u1ea1ng python package c\u00f3 th\u1ec3 c\u00e0i \u0111\u1eb7t th\u00f4ng qua pip package manager. \u0110\u1ec3 c\u00e0i \u0111\u1eb7t c\u00f4ng c\u1ee5, tr\u01b0\u1edbc ti\u00ean h\u00e3y t\u1ea1o m\u1ed9t virtal env, chuy\u1ec3n sang n\u00f3 v\u00e0 sau \u0111\u00f3 c\u00e0i \u0111\u1eb7t rekall: <pre><code>$ virtualenv  /tmp/MyEnv\nNew python executable in /tmp/MyEnv/bin/python\nInstalling setuptools, pip...done.\n$ source /tmp/MyEnv/bin/activate\n$ pip install --upgrade setuptools pip wheel\n$ pip install rekall-agent rekall\n</code></pre></p>"},{"location":"tools/mobile/","title":"C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra thi\u1ebft b\u1ecb di \u0111\u1ed9ng","text":""},{"location":"tools/mobile/#mobsf","title":"MobSF","text":"<p>Mobile Security Framework (MobSF) l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 ph\u00e2n t\u00edch ph\u1ea7n m\u1ec1m \u0111\u1ed9c h\u1ea1i tr\u00ean c\u00e1c h\u1ec7 \u0111i\u1ec1u h\u00e0nh di \u0111\u1ed9ng (IOS, Android, Windows) c\u00f3 kh\u1ea3 n\u0103ng th\u1ef1c hi\u1ec7n ph\u00e2n t\u00edch t\u0129nh v\u00e0 \u0111\u1ed9ng.</p> <p></p> <p>C\u00e1c t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a MobSF:</p> <ul> <li>Ph\u00e2n t\u00edch t\u0129nh - Android</li> <li>Ph\u00e2n t\u00edch t\u0129nh - Android d\u01b0\u1edbi d\u1ea1ng Source Tree</li> <li>Ph\u00e2n t\u00edch t\u0129nh - iOS</li> <li>Ph\u00e2n t\u00edch \u0111\u1ed9ng - Android APK</li> <li>Ki\u1ec3m tra Web API</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng MobSF <p>\u0110\u1ec3 c\u00e0i \u0111\u1eb7t c\u00f4ng c\u1ee5: <pre><code>git clone https://github.com/MobSF/Mobile-Security-Framework-MobSF.git\ncd Mobile-Security-Framework-MobSF\nsetup.bat\n</code></pre></p> <p>\u0110\u1ec3 ch\u1ea1y c\u00f4ng c\u1ee5: <pre><code>run.bat 127.0.0.1:8000\n</code></pre></p> <p>Ph\u00e2n t\u00edch t\u0129nh - Android</p> <p></p> <p>Ph\u00e2n t\u00edch t\u0129nh - Android d\u01b0\u1edbi d\u1ea1ng Source Tree</p> <p></p> <p>Ph\u00e2n t\u00edch t\u0129nh - iOS</p> <p></p> <p>Ph\u00e2n t\u00edch \u0111\u1ed9ng - Android APK</p> <p></p> <p>Ki\u1ec3m tra Web API</p> <p></p>"},{"location":"tools/mobile/#andriller","title":"Andriller","text":"<p>Andriller l\u00e0 m\u1ed9t b\u1ed9 c\u00f4ng c\u1ee5 \u0111i\u1ec1u tra d\u00e0nh cho \u0111i\u1ec7n tho\u1ea1i. C\u00f4ng c\u1ee5 n\u00e0y c\u00f3 th\u1ec3 th\u1ef1c hi\u1ec7n l\u1ea5y d\u1eef li\u1ec7u tr\u00ean h\u1ec7 \u0111i\u1ec1u h\u00e0nh Android m\u00e0 kh\u00f4ng \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn thi\u1ebft b\u1ecb. N\u00f3 c\u00f3 th\u1ec3 xu\u1ea5t b\u00e1o c\u00e1o d\u01b0\u1edbi \u0111\u1ecbnh d\u1ea1ng HTML v\u00e0 Excel.</p> <p>C\u00e1c t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a Andriller:</p> <ul> <li>Khai th\u00e1c v\u00e0 gi\u1ea3i m\u00e3 d\u1eef li\u1ec7u.</li> <li>Tr\u00edch xu\u1ea5t d\u1eef li\u1ec7u c\u1ee7a thi\u1ebft b\u1ecb ch\u01b0a root b\u1eb1ng Android Backup (Phi\u00ean b\u1ea3n Android 4.x).</li> <li>Tr\u00edch xu\u1ea5t d\u1eef li\u1ec7u v\u1edbi quy\u1ec1n root: root adb deamon, ch\u1ebf \u0111\u1ed9 kh\u00f4i ph\u1ee5c CWM ho\u1eb7c SU (Superuser/SuperSU).</li> <li>Ph\u00e2n t\u00edch c\u00fa ph\u00e1p v\u00e0 gi\u1ea3i m\u00e3 d\u1eef li\u1ec7u cho: Th\u01b0 m\u1ee5c, t\u1eadp tin Tarball (t\u1eeb b\u1ea3n sao l\u01b0u nanddroid) v\u00e0 Sao l\u01b0u Android (t\u1ec7p backup.ab).</li> <li>Gi\u1ea3i m\u00e3 c\u01a1 s\u1edf d\u1eef li\u1ec7u c\u1ee7a \u1ee9ng d\u1ee5ng Android. </li> <li>Gi\u1ea3i m\u00e3 c\u01a1 s\u1edf d\u1eef li\u1ec7u WhatsApp \u0111\u01b0\u1ee3c m\u00e3 h\u00f3a (.crypt th\u00e0nh .crypt12, ph\u1ea3i c\u00f3 key ph\u00f9 h\u1ee3p).</li> <li>B\u1ebb kh\u00f3a m\u00e0n h\u00ecnh cho Pattern, m\u00e3 PIN, M\u1eadt kh\u1ea9u.</li> <li>Gi\u1ea3i n\u00e9n c\u00e1c t\u1eadp tin sao l\u01b0u Android.</li> <li>Ch\u1ee5p m\u00e0n h\u00ecnh hi\u1ec3n th\u1ecb c\u1ee7a thi\u1ebft b\u1ecb.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Andriller <p>Y\u00eau c\u1ea7u c\u1ee7a c\u00f4ng c\u1ee5:</p> <pre><code>Python 3.6-3.10 (64-bit)\nadb\npython3-tk\n</code></pre> <p>[Ubuntu/Debian] C\u00e0i \u0111\u1eb7t t\u1eeb terminal: <code>sudo apt-get install android-tools-adb python3-tk</code></p> <p>[Mac] C\u00e0i \u0111\u1eb7t t\u1eeb Homebrew: <code>brew install android-platform-tools</code></p> <p>[Windows]: \u0110\u00e3 bao g\u1ed3m trong b\u1ed9 c\u00f4ng c\u1ee5.</p> <p>C\u00e0i \u0111\u1eb7t:</p> <p>T\u1ea1o m\u1ed9t m\u00f4i tr\u01b0\u1eddng \u1ea3o b\u1eb1ng python3:</p> <pre><code>python3 -m venv env\n</code></pre> <p>K\u00edch ho\u1ea1t m\u00f4i tr\u01b0\u1eddng \u1ea3o:</p> <p>Linux: <code>source env/bin/activate</code> Windows: <code>.\\env\\Scripts\\activate</code></p> <p>C\u00e0i \u0111\u1eb7t/C\u1eadp nh\u1eadt Andriller v\u1edbi PIP:</p> <pre><code>pip install andriller -U\n</code></pre> <p>Kh\u1edfi \u0111\u1ed9ng c\u00f4ng c\u1ee5:</p> <pre><code>python -m andriller\n</code></pre>"},{"location":"tools/mobile/#aleapp","title":"ALEAPP","text":"<p>ALEAPP l\u00e0 c\u00f4ng c\u1ee5 h\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch Android Logs Events v\u00e0 Protobuf. C\u00f4ng c\u1ee5 c\u00f3 th\u1ec3 ph\u00e2n t\u00edch \u1ed5 c\u1ee9ng logic, tr\u00edch xu\u1ea5t tar v\u00e0 zip c\u0169ng nh\u01b0 xu\u1ea5t b\u00e1o c\u00e1o \u1edf \u0111\u1ecbnh d\u1ea1ng html v\u00e0 csv.</p> <p></p> <p>C\u00e1c t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a ALEAPP:</p> <ul> <li>H\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch c\u00e1c s\u1ef1 ki\u1ec7n v\u00e0 t\u00e0i kho\u1ea3n trong Wellbeing Android database</li> <li>H\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch s\u1ef1 ki\u1ec7n UsageStats d\u01b0\u1edbi d\u1ea1ng XML v\u00e0 protobuf.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng ALEAPP <p>Y\u00eau c\u1ea7u h\u1ec7 th\u1ed1ng:</p> <pre><code>Python 3.7.4 ho\u1eb7c cao h\u01a1n\npip install six\npip install PySimpleGUI\n</code></pre> <p>Th\u00f4ng tin t\u00e0i kho\u1ea3n \u0111\u01b0\u1ee3c tr\u00edch xu\u1ea5t t\u1eeb protobuf:</p> <p></p> <p>B\u00e1o c\u00e1o s\u1ef1 ki\u1ec7n Wellbeing Android:</p> <p></p> <p>B\u00e1o c\u00e1o CSV:</p> <p></p>"},{"location":"tools/mobile/#ileapp","title":"iLEAPP","text":"<p>iLEAPP l\u00e0 c\u00f4ng c\u1ee5 ph\u00e2n t\u00edch Logs, Events v\u00e0 Plists. H\u1ed7 tr\u1ee3 iOS/iPadOS 11, 12, 13 v\u00e0 14. c\u00f4ng c\u1ee5 c\u00f3 th\u1ec3 ph\u00e2n t\u00edch tr\u1ef1c ti\u1ebfp t\u1eeb t\u1ec7p .tar/.zip \u0111\u00e3 n\u00e9n ho\u1eb7c th\u01b0 m\u1ee5c \u0111\u00e3 gi\u1ea3i n\u00e9n ho\u1eb7c th\u01b0 m\u1ee5c sao l\u01b0u iTunes/Finder.</p> <p>C\u00e1c t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a iLEAPP:</p> <ul> <li>Logs c\u00e0i \u0111\u1eb7t c\u1ee7a thi\u1ebft b\u1ecb.</li> <li>Th\u00f4ng b\u00e1o c\u1ee7a iOS 12 v\u00e0 13.</li> <li>Th\u00f4ng tin build (phi\u00ean b\u1ea3n iOS,...).</li> <li>Th\u00f4ng tin d\u1ecbch v\u1ee5 di \u0111\u1ed9ng (IMEI, s\u1ed1 \u0111i\u1ec7n tho\u1ea1i,...).</li> <li>Danh s\u00e1ch bi\u1ec3u t\u01b0\u1ee3ng.</li> <li>T\u00ean ng\u01b0\u1eddi d\u00f9ng v\u00e0 m\u00e1y t\u00ednh m\u00e0 thi\u1ebft b\u1ecb iOS \u0111\u00e3 k\u1ebft n\u1ed1i.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng iLEAPP <p>C\u00e0i \u0111\u1eb7t m\u00f4i tr\u01b0\u1eddng: <code>py -m pip install -r requirements.txt</code></p> <p>V\u1edbi linux, ta c\u1ea7n c\u00e0i \u0111\u1eb7t <code>tkinter</code>: <code>sudo apt-get install python3-tk</code></p> <p>Ch\u1ea1y c\u00f4ng c\u1ee5 v\u1edbi Command line interface (CLI):</p> <pre><code>$ python ileapp.py -t &lt;zip | tar | fs | gz&gt; -i &lt;path_to_extraction&gt; -o &lt;path_for_report_output&gt;\n</code></pre> <p>Ch\u1ea1y c\u00f4ng c\u1ee5 v\u1edbi Graphical User Interface (GUI):</p> <pre><code>$ python ileappGUI.py </code></pre> <p>M\u1edf h\u01b0\u1edbng d\u1eabn:</p> <pre><code>$ python ileapp.py --help\n</code></pre>"},{"location":"tools/network/","title":"C\u00f4ng c\u1ee5 \u0111i\u1ec1u tra m\u1ea1ng","text":""},{"location":"tools/network/#wireshark","title":"Wireshark","text":"<p>Wireshark l\u00e0 m\u1ed9t \u1ee9ng d\u1ee5ng d\u00f9ng \u0111\u1ec3 b\u1eaft (capture), ph\u00e2n t\u00edch v\u00e0 x\u00e1c \u0111\u1ecbnh c\u00e1c v\u1ea5n \u0111\u1ec1 li\u00ean quan \u0111\u1ebfn network nh\u01b0: r\u1edbt g\u00f3i tin, k\u1ebft n\u1ed1i ch\u1eadm, ho\u1eb7c c\u00e1c truy c\u1eadp b\u1ea5t th\u01b0\u1eddng. Ph\u1ea7n m\u1ec1m n\u00e0y cho ph\u00e9p qu\u1ea3n tr\u1ecb vi\u00ean hi\u1ec3u s\u00e2u h\u01a1n c\u00e1c Network Packets \u0111ang ch\u1ea1y tr\u00ean h\u1ec7 th\u1ed1ng, qua \u0111\u00f3 d\u1ec5 d\u00e0ng x\u00e1c \u0111\u1ecbnh c\u00e1c nguy\u00ean nh\u00e2n ch\u00ednh x\u00e1c g\u00e2y ra l\u1ed7i.</p> <p>S\u1eed d\u1ee5ng WireShark c\u00f3 th\u1ec3 capture c\u00e1c packet trong th\u1eddi gian th\u1ef1c (realtime), l\u01b0u tr\u1eef ch\u00fang l\u1ea1i v\u00e0 ph\u00e2n t\u00edch ch\u00fang offline. Ngo\u00e0i ra, n\u00f3 c\u0169ng bao g\u1ed3m c\u00e1c filter, color coding v\u00e0 nhi\u1ec1u t\u00ednh n\u0103ng kh\u00e1c, cho ph\u00e9p ng\u01b0\u1eddi d\u00f9ng t\u00ecm hi\u1ec3u s\u00e2u h\u01a1n v\u1ec1 l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng c\u0169ng nh\u01b0 inspect (ki\u1ec3m tra) c\u00e1c packets.</p> <p>\u1ee8ng d\u1ee5ng \u0111\u01b0\u1ee3c vi\u1ebft b\u1eb1ng ng\u00f4n ng\u1eef C v\u00e0 h\u1ec7 \u0111i\u1ec1u h\u00e0nh Cross-platform, ngo\u00e0i ra hi\u1ec7n n\u00e0y g\u1ed3m c\u00f3 c\u00e1c b\u1ea3n ph\u00e2n ph\u1ed1i Linux, Windows, OS X, FreeBSD, NetBSD v\u00e0 OpenBSD. \u0110\u00e2y l\u00e0 m\u1ed9t ph\u1ea7n m\u1ec1m m\u00e3 ngu\u1ed3n m\u1edf, \u0111\u01b0\u1ee3c c\u1ea5p ph\u00e9p GPL, v\u00e0 do \u0111\u00f3 mi\u1ec5n ph\u00ed s\u1eed d\u1ee5ng, t\u1ef1 do chia s\u1ebb v\u00e0 s\u1eeda \u0111\u1ed5i.</p> <p></p> <p>C\u00e1c t\u00ednh n\u0103ng n\u1ed5i b\u1eadt c\u1ee7a ph\u1ea7n m\u1ec1m b\u1eaft g\u00f3i tin Wireshark:</p> <ul> <li>H\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch s\u00e2u h\u00e0ng tr\u0103m giao th\u1ee9c v\u00e0 li\u00ean t\u1ee5c \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt.</li> <li>Live capture v\u00e0 ph\u00e2n t\u00edch offline.</li> <li>Ho\u1ea1t \u0111\u1ed9ng \u0111a n\u1ec1n t\u1ea3ng: Windows, Linux, MacOS, Solaris, FreeBSD, OpenBSD\u2026</li> <li>C\u00e1c g\u00f3i tin \u0111\u00e3 capture c\u00f3 th\u1ec3 xem b\u1eb1ng giao di\u1ec7n ho\u1eb7c s\u1eed d\u1ee5ng command line (tshark).</li> <li>Display filter m\u1ea1nh m\u1ebd.</li> <li>H\u1ed7 tr\u1ee3 ph\u00e2n t\u00edch VoIP chuy\u00ean s\u00e2u.</li> <li>H\u1ed7 tr\u1ee3 read/write nhi\u1ec1u \u0111\u1ecbnh d\u1ea1ng: tcpdump (libpcap), Pcap NG, Catapult DCT2000, Cisco Secure IDS iplog, Microsoft Network Monitor, Network General Sniffer\u00ae (compressed and uncompressed), Sniffer\u00ae Pro, and NetXray\u00ae, Network Instruments Observer, NetScreen snoop, Novell LANalyzer, RADCOM WAN/LAN Analyzer, Shomiti/Finisar Surveyor, Tektronix K12xx, Visual Networks Visual UpTime, WildPackets EtherPeek/TokenPeek/AiroPeek \u2026</li> <li>File capture \u0111\u01b0\u1ee3c n\u00e9n b\u1eb1ng gzip c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i n\u00e9n \u201con the fly\u201d.</li> <li>Capture d\u1eef li\u1ec7u t\u1eeb Ethernet, IEEE 802.11, PPP/HDLC, ATM, Bluetooth, USB, Token Ring, Frame Relay, FDDI \u2026</li> <li>H\u1ed7 tr\u1ee3 decryption c\u1ee7a nhi\u1ec1u giao th\u1ee9c nh\u01b0: IPsec, ISAKMP, Kerberos, SNMPv3, SSL/TLS, WEP, and WPA/WPA2.</li> <li>Coloring rules cho ph\u00e9p thi\u1ebft l\u1eadp m\u00e0u s\u1eafc cho c\u00e1c packet gi\u00fap ph\u00e2n t\u00edch nhanh v\u00e0 hi\u1ec7u qu\u1ea3 h\u01a1n.</li> <li>Output c\u00f3 th\u1ec3 export sang XML, PostScript\u00ae, CSV, ho\u1eb7c plain text.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Wireshark <p>Sau khi download v\u00e0 c\u00e0i \u0111\u1eb7t, ta c\u00f3 th\u1ec3 kh\u1edfi \u0111\u1ed9ng n\u00f3 b\u1eb1ng c\u00e1ch double-click v\u00e0o t\u00ean c\u1ee7a Network interface trong danh s\u00e1ch ph\u00eda d\u01b0\u1edbi \u201cCapture\u201d \u0111\u1ec3 b\u1eaft \u0111\u1ea7u b\u1eaft g\u00f3i tin tr\u00ean card m\u1ea1ng \u0111\u00f3. \u0110\u01b0\u1eddng bi\u1ec3u di\u1ec5n ph\u00eda sau t\u00ean Interface th\u1ec3 hi\u1ec7n l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng \u0111ang s\u1eed d\u1ee5ng.</p> <p>V\u00ed d\u1ee5: N\u1ebfu mu\u1ed1n b\u1eaft g\u00f3i tin trong m\u1ea1ng wifi, h\u00e3y double click v\u00e0o \u201cWi-Fi\u201d (ho\u1eb7c \u201cWireless Interface\u201d). Ngo\u00e0i ra, ch\u00fang ta c\u0169ng c\u00f3 th\u1ec3 thi\u1ebft l\u1eadp c\u00e1c bi\u1ec3u th\u1ee9 \u1edf ph\u1ea7n \u201c\u2026using this filter\u201d \u0111\u1ec3 l\u1ecdc v\u00e0 capture nh\u1eefng packet ch\u1ec9 \u0111\u1ecbnh khi th\u1ecfa m\u00e3n y\u00eau c\u1ea7u.</p> <p></p> <p>Sau \u0111\u00f3, c\u00e1c packet s\u1ebd b\u1eaft \u0111\u1ea7u hi\u1ec3n th\u1ecb theo th\u1eddi gian th\u1ef1c. Wireshark s\u1ebd capture t\u1eebng packet \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn ho\u1eb7c \u0111i t\u1eeb h\u1ec7 th\u1ed1ng c\u1ee7a ta.</p> <p>Click v\u00e0o n\u00fat \u201cStop\u201d m\u00e0u \u0111\u1ecf (\u1edf g\u00f3c tr\u00ean b\u00ean tr\u00e1i c\u1ee7a c\u1eeda s\u1ed5 \u2013 ho\u1eb7c ch\u1ecdn \u201cCapture &gt; Stop\u201d) n\u1ebfu mu\u1ed1n d\u1eebng vi\u1ec7c capture l\u1ea1i.</p> <p></p> <p>Ngo\u00e0i c\u00e1ch b\u1eaft g\u00f3i tin v\u00e0 s\u1eed d\u1ee5ng giao di\u1ec7n nh\u01b0 tr\u00ean, b\u1ea1n c\u0169ng c\u00f3 th\u1ec3 d\u00f9ng c\u00e1ch b\u1eaft g\u00f3i tin b\u1eb1ng c\u00e1ch s\u1eed d\u1ee5ng command line \u0111\u01b0\u1ee3c \u0111\u1ec1 c\u1eadp \u1edf ph\u1ea7n n\u00e2ng cao ph\u00eda d\u01b0\u1edbi b\u00e0i vi\u1ebft.</p> <p>\u0110\u1ec3 m\u1edf g\u00f3i tin b\u1eb1ng Wireshark, ch\u1ecdn \u201cFile &gt; Open\u201d v\u00e0 t\u00ecm \u0111\u1ebfn \u0111\u01b0\u1eddng d\u1eabn c\u1ee7a file c\u1ea7n m\u1edf.</p> <p></p> <p>\u0110\u1ec3 l\u01b0u g\u00f3i tin \u0111\u00e3 capture, click v\u00e0o \u201cFile &gt; Save\u201d, sau \u0111\u00f3 ch\u1ecdn d\u01b0\u1eddng d\u1eabn \u0111\u1ec3 l\u01b0u tr\u1eef, \u0111\u1eb7t t\u00ean cho file capture v\u00e0 \u0111\u1ecbnh d\u1ea1ng s\u1ebd l\u01b0u.</p>"},{"location":"tools/network/#brim","title":"Brim","text":"<p>\u0110\u01b0\u1ee3c \u0111\u00f3ng g\u00f3p b\u1edfi: C\u00f4ng ty C\u1ed5 ph\u1ea7n BKAV</p> <p>Brim hay c\u00f2n \u0111\u01b0\u1ee3c bi\u1ebft \u0111\u1ebfn v\u1edbi t\u00ean ZUI l\u00e0 \u1ee9ng d\u1ee5ng m\u00e3 ngu\u1ed3n m\u1edf c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1ee7 d\u1ee5ng \u0111\u1ec3 ph\u00e2n t\u00edch l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng c\u00f3 c\u1ea5u tr\u00fac.</p> <p></p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Brim <ul> <li>C\u00e0i \u0111\u1eb7t Brim Security tr\u00ean Ubuntu/Debian Desktop</li> </ul> <pre><code>wget https://github.com/brimdata/zui/releases/download/v1.0.1/zui_1.0.1_amd64.deb\napt install ./zui_1.0.1_amd64.deb -y\n</code></pre> <ul> <li>C\u00e0i \u0111\u1eb7t Brim tr\u00ean tr\u00ean CentOS/Rocky Linux/RHEL: T\u01b0\u01a1ng t\u1ef1, t\u1ea3i xu\u1ed1ng c\u00e1c t\u1ec7p nh\u1ecb ph\u00e2n RPM t\u1eeb trang t\u1ea3i xu\u1ed1ng;</li> </ul> <pre><code>yum local install https://github.com/brimdata/zui/releases/download/v1.0.1/zui-1.0.1.x86_64.rpm\n</code></pre> <p>C\u00e0i \u0111\u1eb7t Brim tr\u00ean  Windows: T\u1ea3i file c\u00e0i \u0111\u1eb7t t\u1eeb link v\u00e0 th\u1ef1c hi\u1ec7n c\u00e0i \u0111\u1eb7t:</p> <pre><code>https://github.com/brimdata/zui/releases/download/v1.0.1/Zui-Setup-1.0.1.exe\n</code></pre> <p>Giao di\u1ec7n kh\u1edfi ch\u1ea1y c\u1ee7a Brim:</p> <p></p> <p>Ph\u00e2n t\u00edch l\u01b0u l\u01b0\u1ee3ng m\u1ea1ng v\u1edbi BRIM/ZUI</p> <p>Nh\u1eadp t\u1ec7p PCAP v\u00e0o Brim \u0111\u1ec3 ph\u00e2n t\u00edch b\u1eb1ng c\u00e1ch k\u00e9o t\u1ec7p v\u00e0o Brim ho\u1eb7c ch\u1ec9 c\u1ea7n nh\u1eadp b\u1eb1ng c\u00e1ch t\u1ea3i t\u1ec7p l\u00ean trong khung \u201cIMPORT FILES\u201d</p> <p></p> <p>Sau khi t\u1ea3i l\u00ean, Brim ngay l\u1eadp t\u1ee9c b\u1eaft \u0111\u1ea7u x\u1eed l\u00fd t\u1ec7p l\u01b0u l\u01b0\u1ee3ng truy c\u1eadp m\u1ea1ng b\u1eb1ng c\u00e1c c\u00f4ng c\u1ee5 ZEEK inbuild;</p> <p></p> <p>K\u1ebft qu\u1ea3 sau x\u1eed l\u00ed </p> <p></p> <p>Sau x\u1eed l\u00ed Brim \u0111\u01b0a ra c\u00e1c tr\u01b0\u1eddng th\u00f4ng tin nh\u01b0 dns , stats , conn , freak , capture_loss v.v. V\u00e0 alert l\u00e0 nh\u1eefng nh\u1eadt k\u00fd \u0111\u01b0\u1ee3c t\u1ea1o b\u1eb1ng quy t\u1eafc c\u00f4ng c\u1ee5 Suricata c\u1ee7a Brim. Brim c\u0169ng cho ph\u00e9p h\u1ed7 tr\u1ee3 truy v\u1ea5n log d\u1ef1a tr\u00ean c\u00e1c query:</p> <p></p>"},{"location":"tools/network/#kismet","title":"Kismet","text":"<p>Kismet l\u00e0 c\u00f4ng c\u1ee5 d\u00f2 t\u00ecm, nghe l\u00e9n v\u00e0 ph\u00e1t hi\u1ec7n ng\u01b0\u1eddi d\u00f9ng b\u1ea5t h\u1ee3p ph\u00e1p x\u00e2m nh\u1eadp v\u00e0o h\u1ec7 th\u1ed1ng m\u1ea1ng kh\u00f4ng d\u00e2y. </p> <p>Kismet ch\u1ee7 y\u1ebfu t\u1eadp trung v\u00e0o vi\u1ec7c thu th\u1eadp, \u0111\u1ed1i chi\u1ebfu v\u00e0 ph\u00e2n lo\u1ea1i d\u1eef li\u1ec7u kh\u00f4ng d\u00e2y. Logs do Kismet t\u1ea1o c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c \u0111\u01b0a v\u00e0o c\u00e1c c\u00f4ng c\u1ee5 kh\u00e1c (pcap, handshakes v\u00e0 c\u00e1c d\u1eef li\u1ec7u kh\u00e1c) nh\u01b0 hashcat, aircrack, v.v.</p> <p>Kismet c\u00f3 th\u1ec3 ho\u1ea1t \u0111\u1ed9ng c\u1ea3 headless nh\u01b0 m\u1ed9t h\u1ec7 th\u1ed1ng gi\u00e1m s\u00e1t v\u00e0 Wireless IDS (WIDS) \u0111\u1ed9c l\u1eadp ho\u1eb7c v\u1edbi giao di\u1ec7n tr\u00ean web UI.</p> <p>Kismet c\u00f3 th\u1ec3 ch\u1ea1y tr\u00ean nhi\u1ec1u lo\u1ea1i ph\u1ea7n c\u1ee9ng, t\u1eeb thi\u1ebft b\u1ecb r\u1ea5t nh\u1ecf \u0111\u1ebfn m\u00e1y ch\u1ee7 l\u1edbn, t\u00f9y thu\u1ed9c v\u00e0o l\u01b0\u1ee3ng l\u01b0u l\u01b0\u1ee3ng truy c\u1eadp d\u1ef1 \u0111\u1ecbnh gi\u00e1m s\u00e1t.</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a Kismet:</p> <ul> <li>Nghe l\u00e9n g\u00f3i tin, WIDS, wardriver v\u00e0 gi\u00e1m s\u00e1t g\u00f3i tin cho m\u1ea1ng Wi-Fi</li> <li>Gi\u00e1m s\u00e1t Bluetooth, BTLE</li> <li>Nhi\u1ec7t k\u1ebf kh\u00f4ng d\u00e2y, \u0111\u1ed3ng h\u1ed3 \u0111o \u0111i\u1ec7n, Zigbee, v.v.</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng Kismet <p></p> <p>C\u00e1ch \u0111\u01a1n gi\u1ea3n nh\u1ea5t \u0111\u1ec3 kh\u1edfi \u0111\u1ed9ng Kismet l\u00e0 m\u1edf terminal v\u00e0 ch\u1ec9 c\u1ea7n ch\u1ea1y c\u00e2u l\u1ec7nh:</p> <p><code>kismet</code></p> <p>C\u00e2u l\u1ec7nh n\u00e0y s\u1ebd ch\u1ea1y Kismet v\u1edbi c\u1ea5u h\u00ecnh m\u1eb7c \u0111\u1ecbnh. Kismet s\u1ebd hi\u1ec3n th\u1ecb th\u00f4ng tin v\u1ec1 qu\u00e1 tr\u00ecnh kh\u1edfi \u0111\u1ed9ng v\u00e0 c\u00e1c l\u1ed7i n\u1ebfu c\u00f3.</p> <pre><code>dragorn@boron ~ % kismet -n --no-ncurses\nINFO: Including sub-config file: /usr/local/etc/kismet_httpd.conf\nINFO: Including sub-config file: /usr/local/etc/kismet_memory.conf\nINFO: Including sub-config file: /usr/local/etc/kismet_alerts.conf\nINFO: Including sub-config file: /usr/local/etc/kismet_80211.conf\nINFO: Including sub-config file: /usr/local/etc/kismet_logging.conf\nINFO: Including sub-config file: /usr/local/etc/kismet_filter.conf\nINFO: Including sub-config file: /usr/local/etc/kismet_uav.conf\nINFO: Loading config override file '/usr/local/etc/kismet_package.conf'\nINFO: Optional sub-config file not present: /usr/local/etc/kismet_package.conf\nINFO: Loading config override file '/usr/local/etc/kismet_site.conf'\nINFO: Optional sub-config file not present: /usr/local/etc/kismet_site.conf\nINFO: Setting server UUID DBC402AE-9B3E-11EC-88C2-4B49534D4554\nINFO: Starting Beast webserver on 0.0.0.0:2501\nINFO: Opened OUI file '/usr/local/share/kismet/kismet_manuf.txt.gz\nINFO: Indexing manufacturer db\nINFO: Completed indexing manufacturer db, 31466 lines 630 indexes\nINFO: Saving devices to the Kismet database log every 30 seconds.\nINFO: Using default rates of 10/min, 1/sec for alert 'DEVICEFOUND'\nINFO: Using default rates of 10/min, 1/sec for alert 'DEVICELOST'\nINFO: Registering support for DLT_PPI packet header decoding\nINFO: Registering support for DLT_RADIOTAP packet header decoding\nINFO: Registering support for DLT_BTLE_RADIO packet header decoding\nINFO: Using default rates of 10/min, 1/sec for alert 'BADFIXLENIE'\nINFO: PHY80211 will only process AP signal levels from beacons\nINFO: Allowing Kismet clients to view WEP keys\nINFO: Keeping EAPOL packets in memory for easy download and WIDS functionality; this can use more RAM.\nINFO: Registered PHY handler 'IEEE802.11' as ID 0\nINFO: Registered PHY handler 'RTL433' as ID 1\nINFO: Registered PHY handler 'Z-Wave' as ID 2\nINFO: Registered PHY handler 'Bluetooth' as ID 3\nINFO: Registered PHY handler 'UAV' as ID 4\nINFO: Registered PHY handler 'NrfMousejack' as ID 5\nINFO: Using default rates of 10/min, 1/sec for alert 'BLEEDINGTOOTH'\nINFO: Registered PHY handler 'BTLE' as ID 6\nINFO: Registered PHY handler 'METER' as ID 7\nINFO: Indexing ADSB ICAO db\nINFO: Completed indexing ADSB ICAO db, 322278 lines 6446 indexes\nINFO: Registered PHY handler 'ADSB' as ID 8\nINFO: Registered PHY handler '802.15.4' as ID 9\nINFO: Registered PHY handler 'RADIATION' as ID 10\nINFO: Serving static file content from /usr/local/share/kismet/httpd/\nINFO: Enabling channel hopping by default on sources which support channel control.\nINFO: Setting default channel hop rate to 5/sec\nINFO: Enabling channel list splitting on sources which share the same list of channels\nINFO: Enabling channel list shuffling to optimize overlaps\nINFO: Sources will be re-opened if they encounter an error\nINFO: Saving datasources to the Kismet database log every 30 seconds.\nINFO: Launching remote capture server on 127.0.0.1 3501\nINFO: No data sources defined; Kismet will not capture anything until a source is added.\nALERT: LOGDISABLED Logging has been disabled via the Kismet config files or the command line.  Pcap, database, and related logs will not be saved.\nINFO: Logging disabled, not enabling any log drivers.\nINFO: GPS track will be logged to the Kismet logfile\nINFO: Starting Kismet web server...\nINFO: HTTP server listening on 0.0.0.0:2501\nINFO: Could not open system plugin directory (/usr/local/lib/kismet/), skipping: No such file or directory\nINFO: Did not find a user plugin directory (/home/user/plugins/), skipping: No such file or directory\n</code></pre>"},{"location":"tools/network/#networkminer","title":"NetworkMiner","text":"<p>NetworkMiner l\u00e0 c\u00f4ng c\u1ee5 gi\u00e1m s\u00e1t m\u1ea1ng, m\u00e3 ngu\u1ed3n m\u1edf d\u00e0nh cho h\u1ec7 \u0111i\u1ec1u h\u00e0nh Window. C\u00f4ng c\u1ee5 n\u00e0y c\u0169ng \u0111\u01b0\u1ee3c h\u1ed7 tr\u1ee3 \u0111\u1ec3 c\u00e0i \u0111\u1eb7t tr\u00ean Linux, Mac OS X v\u00e0 FreeBSD. </p> <p>C\u00f3 hai phi\u00ean b\u1ea3n mi\u1ec5n ph\u00ed v\u00e0 tr\u1ea3 ph\u00ed, trong \u0111\u00f3, phi\u00ean b\u1ea3n tr\u1ea3 ph\u00ed c\u00f3 t\u00ednh n\u0103ng cho ph\u00e9p t\u00ecm ki\u1ebfm tr\u1ef1c tuy\u1ebfn th\u00f4ng tin v\u1ec1 \u0111\u1ecba ch\u1ec9 IP m\u00e0 m\u00e1y ch\u1ee7 (c\u00e0i networkminer) \u0111ang c\u00f3 k\u1ebft n\u1ed1i t\u1edbi.</p> <p>\u0110\u1ed1i v\u1edbi h\u1ec7 th\u1ed1ng ICS/SCADA, n\u1ebfu s\u1eed d\u1ee5ng c\u00e1c c\u00f4ng c\u1ee5 d\u00f2 qu\u00e9t m\u1ea1ng \u0111\u1ec3 discover c\u00e1c th\u00f4ng tin v\u1ec1 th\u00ec r\u1ea5t d\u1ec5 t\u1ea1o ra m\u1ed9t cu\u1ed9c t\u1ea5n c\u00f4ng DoS, l\u00e0m ng\u01b0ng tr\u1ec7 ho\u1ea1t \u0111\u1ed9ng c\u1ee7a h\u1ec7 th\u1ed1ng \u0111\u00f3. </p> <p>NetworkMiner thu th\u1eadp th\u00f4ng tin m\u00e0 kh\u00f4ng c\u1ea7n t\u1ea1o ra l\u01b0u l\u01b0\u1ee3ng d\u00f2 qu\u00e9t m\u00e0 th\u1ef1c hi\u1ec7n k\u1ef9 thu\u1eadt \u201cpassive network sniffing\u201d v\u00e0 \u201cpacket capturing\u201d. Sau \u0111\u00f3 d\u1ef1a tr\u00ean c\u00e1c th\u00f4ng tin thu th\u1eadp \u0111\u01b0\u1ee3c, NetworkMiner s\u1ebd ph\u00e2n t\u00edch \u0111\u1ec3 c\u00f3 \u0111\u01b0\u1ee3c c\u00e1c th\u00f4ng tin v\u1ec1 h\u1ec7 th\u1ed1ng ICS/SCADA.</p> <p></p> <p>Nh\u1eefng t\u00ednh n\u0103ng ch\u00ednh c\u1ee7a NetworkMiner:</p> <ul> <li>Gi\u00e1m s\u00e1t m\u1ecdi g\u00f3i tin trao \u0111\u1ed5i ra/v\u00e0o m\u00e1y ch\u1ee7, trong \u0111\u00f3 cho ph\u00e9p ph\u00e1t hi\u1ec7n \u1ea3nh, c\u00e1c file d\u1eef li\u1ec7u v\u00e0 t\u00e0i kho\u1ea3n \u0111\u0103ng nh\u1eadp.</li> <li>D\u1eef li\u1ec7u hi\u1ec3n th\u1ecb tr\u1ef1c quan</li> <li>Dung l\u01b0\u1ee3ng nh\u1eb9</li> </ul> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng NetworkMiner <p></p> <p>T\u1ea1i tab Credentials c\u1ee7a NetworkMiner c\u00f3 th\u1ec3 thu th\u1eadp th\u00f4ng tin ng\u01b0\u1eddi d\u00f9ng g\u1ed3m t\u00e0i kho\u1ea3n \u0111\u0103ng nh\u1eadp v\u00e0 m\u1eadt kh\u1ea9u, k\u1ec3 c\u1ea3 th\u00f4ng tin ng\u01b0\u1eddi d\u00f9ng s\u1eed d\u1ee5ng cho c\u00e1c d\u1ecbch v\u1ee5 tr\u1ef1c tuy\u1ebfn ph\u1ed5 bi\u1ebfn nh\u01b0 Gmail hay Facebook. </p> <p>Tab Keyword cho ph\u00e9p t\u00ecm ki\u1ebfm b\u1eb1ng c\u00e1c t\u1eeb kh\u00f3a. C\u00e1c b\u00e1o c\u00e1o c\u0169ng c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c chuy\u1ec3n sang c\u00e1c t\u1eadp tin HTML, TXT, Javascript,...</p> <p>Tab Anomalies gi\u00fap ph\u00e1t hi\u1ec7n c\u00e1c hi\u1ec7n t\u01b0\u1ee3ng kh\u1ea3 nghi v\u00e0 c\u00e1c s\u1ef1 c\u1ed1 c\u00f3 th\u1ec3 x\u1ea3y ra \u0111\u1ed1i v\u1edbi h\u1ec7 th\u1ed1ng m\u1ea1ng, gi\u00fap admin ph\u00f2ng tr\u00e1nh v\u00e0 x\u1eed l\u00fd k\u1ecbp th\u1eddi.</p>"},{"location":"tools/vncert/","title":"C\u00f4ng c\u1ee5 do VNCERT ph\u00e1t tri\u1ec3n","text":""},{"location":"tools/vncert/#0dayex-checker","title":"0dayex-checker","text":"<p>0dayex-checker l\u00e0 c\u00f4ng c\u1ee5 ki\u1ec3m tra l\u1ed7 h\u1ed5ng zeroday c\u1ee7a Microsoft Exchange Server (CVE-2022-41040 v\u00e0 CVE-2022-41082).</p> H\u01b0\u1edbng d\u1eabn s\u1eed d\u1ee5ng 0dayex-checker <p>T\u1ea3i xu\u1ed1ng c\u00f4ng c\u1ee5 t\u1ea1i Github:</p> <p></p> <p>Ch\u1ea1y c\u00f4ng c\u1ee5, nh\u1eadp \u0111\u1ecba ch\u1ec9 mail server v\u00e0o \u00f4 \u0111\u01b0\u1eddng d\u1eabn v\u00e0 nh\u1ea5n ki\u1ec3m tra:</p> <p></p>"}]}